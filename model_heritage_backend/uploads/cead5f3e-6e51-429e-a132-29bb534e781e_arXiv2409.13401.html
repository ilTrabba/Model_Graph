<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images</title>
<!--Generated on Fri Sep 20 11:04:21 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
Segment anything model,  weakly-supervised learning,  remote sensing images,  self-training.
" lang="en" name="keywords"/>
<base href="/html/2409.13401v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S1" title="In PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S2" title="In PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Related Work</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S2.SS1" title="In II Related Work ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-A</span> </span><span class="ltx_text ltx_font_italic">Segment Anything Model</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S2.SS2" title="In II Related Work ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-B</span> </span><span class="ltx_text ltx_font_italic">Point-based supervision</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S2.SS3" title="In II Related Work ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span> </span><span class="ltx_text ltx_font_italic">Self-Training</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S2.SS4" title="In II Related Work ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-D</span> </span><span class="ltx_text ltx_font_italic">Recognition in Remote Sensing Images</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3" title="In PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Methodology</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS1" title="In III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Preliminary</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS1.SSS1" title="In III-A Preliminary ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span>1 </span>Segment Anything Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS1.SSS2" title="In III-A Preliminary ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span>2 </span>Low-Rank Adaptation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS2" title="In III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Pointly-supervised Segment Anything Model</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS3" title="In III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">Prototype-based Regularization</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS3.SSS1" title="In III-C Prototype-based Regularization ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span>1 </span>Offline Prototype Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS3.SSS2" title="In III-C Prototype-based Regularization ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span>2 </span>Memory Bank Updating</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS3.SSS3" title="In III-C Prototype-based Regularization ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span>3 </span>Hungarian Matching</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS4" title="In III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-D</span> </span><span class="ltx_text ltx_font_italic">Negative Prompt Calibration</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS5" title="In III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-E</span> </span><span class="ltx_text ltx_font_italic">Total Loss</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4" title="In PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">Experiments</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS1" title="In IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span> </span><span class="ltx_text ltx_font_italic">Datasets</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS2" title="In IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span> </span><span class="ltx_text ltx_font_italic">Experiment Details</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS3" title="In IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span> </span><span class="ltx_text ltx_font_italic">Quantitative Evaluations</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS3.SSS1" title="In IV-C Quantitative Evaluations ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span>1 </span>NWPU VHR-10</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS3.SSS2" title="In IV-C Quantitative Evaluations ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span>2 </span>WHU</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS3.SSS3" title="In IV-C Quantitative Evaluations ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span>3 </span>HRSID-inshore</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS4" title="In IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span> </span><span class="ltx_text ltx_font_italic">Ablation study</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS4.SSS1" title="In IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span>1 </span>Impact of different components</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS4.SSS2" title="In IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span>2 </span>Alternative Distance Metric in Hungarian Match</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS4.SSS3" title="In IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span>3 </span>Alternative IoU threshold</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS4.SSS4" title="In IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span>4 </span>Comparison with other feature alignment methods.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS4.SSS5" title="In IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span>5 </span>How about more points?</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS5" title="In IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-E</span> </span><span class="ltx_text ltx_font_italic">Qualitative Evaluations</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS5.SSS1" title="In IV-E Qualitative Evaluations ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-E</span>1 </span>Visualization of the NPC Process</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS5.SSS2" title="In IV-E Qualitative Evaluations ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-E</span>2 </span>Visualization of results from different methods</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.SS6" title="In IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-F</span> </span><span class="ltx_text ltx_font_italic">PointSAM as a Detection Box Generator</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S5" title="In PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">Conclusion</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nanqing Liu, Xun Xu, Yongyi Su, Haojie Zhang, Heng-Chao Li
</span><span class="ltx_author_notes">
Nanqing Liu (lansing163@163.com) is with School of Information Science and Technology, Southwest Jiaotong University, Chengdu, China, and also with I2R, A*STAR, Singapore 138632. Xun Xu (xux@i2r.astar.edu.sg) is with I2R, A*STAR, Singapore 138632.
Yongyi Su (eesuyongyi@mail.scut.edu.cn) is with South China University of Technology, and also with I2R, A*STAR, Singapore 138632. Haojie Zhang is with South China University of Technology.
Heng-Chao Li (lihengchao_78@163.com) is with School of Information Science and Technology, Southwest Jiaotong University, Chengdu, China.
Manuscript revised September 20, 2024.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Segment Anything Model (SAM) is an advanced foundational model for image segmentation, widely applied to remote sensing images (RSIs). Due to the domain gap between RSIs and natural images, traditional methods typically use SAM as a source pre-trained model and fine-tune it with fully supervised masks. Unlike these methods, our work focuses on fine-tuning SAM using more convenient and challenging point annotations. Leveraging SAM’s zero-shot capabilities, we adopt a self-training framework that iteratively generates pseudo-labels for training. However, if the pseudo-labels contain noisy labels, there is a risk of error accumulation. To address this issue, we extract target prototypes from the target dataset and use the Hungarian algorithm to match them with prediction prototypes, preventing the model from learning in the wrong direction. Additionally, due to the complex backgrounds and dense distribution of objects in RSI, using point prompts may result in multiple objects being recognized as one. To solve this problem, we propose a negative prompt calibration method based on the non-overlapping nature of instance masks. In brief, we use the prompts of overlapping masks as corresponding negative signals, resulting in refined masks. Combining the above methods, we propose a novel Pointly-supervised Segment Anything Model named PointSAM. We conduct experiments on RSI datasets, including WHU, HRSID, and NWPU VHR-10, and the results show that our method significantly outperforms direct testing with SAM, SAM2, and other comparison methods. Furthermore, we introduce PointSAM as a point-to-box converter and achieve encouraging results, suggesting that this method can be extended to other point-supervised tasks. The code is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Lans1ng/PointSAM" title="">https://github.com/Lans1ng/PointSAM</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Segment anything model, weakly-supervised learning, remote sensing images, self-training.

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Foundation models are versatile, large-scale models designed for a wide range of tasks and applications. They have demonstrated exceptional performance in areas such as natural language processing (e.g., BERT<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib1" title=""><span class="ltx_text" style="font-size:90%;">1</span></a>]</cite> and GPT-3<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib2" title=""><span class="ltx_text" style="font-size:90%;">2</span></a>]</cite>) and multimodal tasks (e.g., CLIP<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite> and ALIGN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib4" title=""><span class="ltx_text" style="font-size:90%;">4</span></a>]</cite>). Recently, the Segment Anything Model (SAM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite> was introduced as a foundation model specifically for image segmentation. Trained on a billion-scale dataset of masks and prompts, SAM can be applied to various downstream tasks requiring promptable segmentation, including healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib7" title=""><span class="ltx_text" style="font-size:90%;">7</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib8" title=""><span class="ltx_text" style="font-size:90%;">8</span></a>]</cite>, autonomous driving <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib9" title=""><span class="ltx_text" style="font-size:90%;">9</span></a>]</cite>, and remote sensing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib10" title=""><span class="ltx_text" style="font-size:90%;">10</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib11" title=""><span class="ltx_text" style="font-size:90%;">11</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib12" title=""><span class="ltx_text" style="font-size:90%;">12</span></a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite SAM’s strong zero-shot capabilities, challenges persist in handling out-of-distribution (OOD) data and domain shifts in remote sensing images (RSIs). Many categories in RSIs are not represented in SAM’s training data, and RSIs, typically captured from aerial or satellite perspectives, differ significantly from natural images. Consequently, recent studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib10" title=""><span class="ltx_text" style="font-size:90%;">10</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">14</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib15" title=""><span class="ltx_text" style="font-size:90%;">15</span></a>]</cite> have focused on fine-tuning SAM for specific tasks. For example, RS-Prompter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib10" title=""><span class="ltx_text" style="font-size:90%;">10</span></a>]</cite> uses queries or anchors as prompts to guide SAM’s mask decoder for instance segmentation. Similarly, SAM-CD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite> employs FastSAM’s encoder and introduces adapters for fine-tuning in change detection tasks.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S1.F1.1" style="width:411.9pt;height:700.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(79.6pt,-135.5pt) scale(1.63048390258774,1.63048390258774) ;"><svg class="ltx_picture" height="594.72" id="S1.F1.1.pic1" overflow="visible" version="1.1" width="335.75"><g fill="#000000" stroke="#000000" stroke-width="0.75pt" transform="translate(0,594.72) matrix(1 0 0 -1 0 0) translate(-81.95,0) translate(0,472.49)"><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 318.67 -295.66 h 50.85 v 50.85 h -50.85 Z" style="stroke:none"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1"><path d="M 320.75 -246.89 L 367.45 -246.89 L 367.45 -293.59 L 320.75 -293.59 Z" style="fill:none"></path></g><path d="M 344.1 -270.24" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 320.6 -293.74)"><foreignobject height="47" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="47"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="47" id="S1.F1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/intro_point.png" width="47"/></foreignobject></g><g color="#FA004F" fill="#FA004F" fill-opacity="1" stroke="#FA004F" stroke-opacity="1"><path d="M 342.94 -269.38 C 342.94 -268.55 343.62 -267.87 344.45 -267.87 C 345.28 -267.87 345.94 -268.55 345.94 -269.38 C 345.94 -270.2 345.28 -270.87 344.45 -270.87 C 343.62 -270.87 342.94 -270.2 342.94 -269.38 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 86.43 -232.87 h 50.85 v 50.85 h -50.85 Z" style="stroke:none"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1"><path d="M 88.5 -184.09 L 135.2 -184.09 L 135.2 -230.79 L 88.5 -230.79 Z" style="fill:none"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 85.39 -79.79 h 50.85 v 50.85 h -50.85 Z" style="stroke:none"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1"><path d="M 87.46 -31.02 L 134.16 -31.02 L 134.16 -77.72 L 87.46 -77.72 Z" style="fill:none"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 363.98 -79.32 h 50.85 v 50.85 h -50.85 Z" style="stroke:none"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1"><path d="M 366.05 -30.54 L 412.75 -30.54 L 412.75 -77.24 L 366.05 -77.24 Z" style="fill:none"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 360.69 -143.62 h 50.85 v 50.85 h -50.85 Z" style="stroke:none"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1"><path d="M 362.76 -94.84 L 409.46 -94.84 L 409.46 -141.54 L 362.76 -141.54 Z" style="fill:none"></path></g><path d="M 386.11 -118.19" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 362.61 -141.69)"><foreignobject height="47" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="47"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="47" id="S1.F1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/intro_input.png" width="47"/></foreignobject></g><g color="#FA004F" fill="#FA004F" stroke="#FA004F" stroke-opacity="1"><path d="M 391.39 -111.42 L 381.01 -111.42 L 381.01 -122.68 L 391.39 -122.68 Z" style="fill:none"></path></g><path d="M 110.81 -54.37" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 87.31 -77.87)"><foreignobject height="47" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="47"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="47" id="S1.F1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/intro_input.png" width="47"/></foreignobject></g><g color="#4A4A4A" fill="#FBE5E0" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 153.74 -29.23 L 203.9 -39.89 L 203.9 -70.45 L 153.74 -81.12 Z"></path></g><g color="#4A4A4A" fill="#DCE7FB" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 278.62 -29.99 L 228.46 -40.66 L 228.46 -71.22 L 278.62 -81.88 Z"></path></g><g color="#4A4A4A" fill="#E2EFD8" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 226.46 -107.53 C 226.46 -103.93 229.39 -101.01 232.99 -101.01 L 279.44 -101.01 C 283.04 -101.01 285.97 -103.93 285.97 -107.53 L 285.97 -127.12 C 285.97 -130.72 283.04 -133.64 279.44 -133.64 L 232.99 -133.64 C 229.39 -133.64 226.46 -130.72 226.46 -127.12 Z"></path></g><g color="#808080" fill="#808080" stroke="#808080" stroke-opacity="1" stroke-width="1.5pt"><path d="M 136.47 -55.18 L 147.88 -55.18" style="fill:none"></path></g><g fill="#808080" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 144.8 -58.66 L 152.03 -55.18 L 144.8 -51.7 Z"></path></g><g color="#808080" fill="#808080" stroke="#808080" stroke-opacity="1" stroke-width="1.5pt"><path d="M 290.97 -118.65 L 304.4 -118.65" style="fill:none"></path></g><g fill="#808080" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 294.05 -115.17 L 286.82 -118.65 L 294.05 -122.13 Z"></path></g><g color="#808080" fill="#808080" stroke="#808080" stroke-opacity="1" stroke-width="1.5pt"><path d="M 207.64 -55.18 L 221.07 -55.18" style="fill:none"></path></g><g fill="#808080" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 217.98 -58.66 L 225.22 -55.18 L 217.98 -51.7 Z"></path></g><g color="#808080" fill="#808080" stroke="#808080" stroke-opacity="1" stroke-width="1.5pt"><path d="M 281.11 -55.18 L 294.54 -55.18" style="fill:none"></path></g><g fill="#808080" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 291.46 -58.66 L 298.69 -55.18 L 291.46 -51.7 Z"></path></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1" stroke-width="1.5pt"><path d="M 342.96 -54.76 L 361.56 -54.76" style="fill:none"></path></g><g fill="#F5A623" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 346.05 -51.29 L 338.81 -54.76 L 346.05 -58.24 Z"></path></g><g color="#808080" fill="#808080" stroke="#808080" stroke-opacity="1" stroke-width="1.5pt"><path d="M 255.79 -96.17 L 255.79 -84.61" style="fill:none"></path></g><g fill="#808080" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 259.27 -87.69 L 255.79 -80.46 L 252.31 -87.69 Z"></path></g><g color="#4A4A4A" fill="#FBE5E0" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 156.5 -180.92 L 206.66 -191.58 L 206.66 -222.15 L 156.5 -232.8 Z"></path></g><g color="#4A4A4A" fill="#DBE7FD" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 282.42 -182.2 L 232.25 -192.87 L 232.25 -223.42 L 282.42 -234.09 Z"></path></g><g color="#4A4A4A" fill="#E2EFD8" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 230.27 -259.74 C 230.27 -256.14 233.19 -253.22 236.8 -253.22 L 283.24 -253.22 C 286.85 -253.22 289.77 -256.14 289.77 -259.74 L 289.77 -279.33 C 289.77 -282.93 286.85 -285.84 283.24 -285.84 L 236.8 -285.84 C 233.19 -285.84 230.27 -282.93 230.27 -279.33 Z"></path></g><g color="#4258A1" fill="#4258A1" stroke="#4258A1" stroke-opacity="1" stroke-width="1.5pt"><path d="M 135.77 -207.99 L 151.04 -193.31" style="fill:none"></path></g><g fill="#4258A1" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 151.22 -197.95 L 154.03 -190.43 L 146.4 -192.94 Z"></path></g><g color="#808080" fill="#808080" stroke="#808080" stroke-opacity="1" stroke-width="1.5pt"><path d="M 296.85 -270.16 L 315.28 -270.16" style="fill:none"></path></g><g fill="#808080" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 299.93 -266.69 L 292.69 -270.16 L 299.93 -273.64 Z"></path></g><g color="#4258A1" fill="#4258A1" stroke="#4258A1" stroke-opacity="1" stroke-width="1.5pt"><path d="M 210.61 -195.65 L 224.05 -195.65" style="fill:none"></path></g><g fill="#4258A1" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 220.96 -199.13 L 228.2 -195.65 L 220.96 -192.18 Z"></path></g><g color="#4258A1" fill="#4258A1" stroke="#4258A1" stroke-opacity="1" stroke-width="1.5pt"><path d="M 287.34 -194.1 L 300.77 -194.1" style="fill:none"></path></g><g fill="#4258A1" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 297.69 -197.57 L 304.92 -194.1 L 297.69 -190.62 Z"></path></g><g color="#808080" fill="#808080" stroke="#808080" stroke-opacity="1" stroke-width="1.5pt"><path d="M 259.59 -248.37 L 259.59 -236.82" style="fill:none"></path></g><g fill="#808080" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 263.07 -239.9 L 259.59 -232.67 L 256.11 -239.9 Z"></path></g><g color="#DC594F" fill="#DC594F" stroke="#DC594F" stroke-opacity="1" stroke-width="1.5pt"><path d="M 135.77 -207.99 L 151.92 -222.82" style="fill:none"></path></g><g fill="#DC594F" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 147.29 -223.3 L 154.97 -225.63 L 152 -218.18 Z"></path></g><g color="#DC594F" fill="#DC594F" stroke="#DC594F" stroke-opacity="1" stroke-width="1.5pt"><path d="M 287.13 -224.34 L 300.56 -224.34" style="fill:none"></path></g><g fill="#DC594F" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 297.48 -227.81 L 304.71 -224.34 L 297.48 -220.86 Z"></path></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1" stroke-width="1.5pt"><path d="M 359.31 -192.42 C 377.75 -197.76 378.74 -218.05 361.82 -226.43" style="fill:none"></path></g><g fill="#F5A623" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 363.76 -222.38 L 358.03 -228 L 366 -228.96 Z"></path></g><g color="#DC594F" fill="#DC594F" stroke="#DC594F" stroke-opacity="1" stroke-width="1.5pt"><path d="M 210.4 -217.76 L 223.84 -217.76" style="fill:none"></path></g><g fill="#DC594F" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 220.76 -221.23 L 227.99 -217.76 L 220.76 -214.28 Z"></path></g><path d="M 389.4 -53.89" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 365.9 -77.39)"><foreignobject height="47" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="47"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="47" id="S1.F1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/intro_mask.png" width="47"/></foreignobject></g><path d="M 111.85 -207.44" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 88.35 -230.94)"><foreignobject height="47" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="47"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="47" id="S1.F1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/intro_input.png" width="47"/></foreignobject></g><g color="#4258A1" fill="#4258A1" stroke="#4258A1" stroke-opacity="1" stroke-width="1.5pt"><path d="M 94.79 -257.3 L 110.63 -257.3" style="fill:none"></path></g><g fill="#4258A1" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 107.54 -260.77 L 114.78 -257.3 L 107.54 -253.82 Z"></path></g><g color="#DC594F" fill="#DC594F" stroke="#DC594F" stroke-opacity="1" stroke-width="1.5pt"><path d="M 94.79 -277.53 L 110.7 -277.53" style="fill:none"></path></g><g fill="#DC594F" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 107.62 -281.01 L 114.85 -277.53 L 107.62 -274.06 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-dasharray="4.5pt,4.5pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 304.62 -97.45 C 304.62 -93.17 308.09 -89.69 312.37 -89.69 L 406.32 -89.69 C 410.61 -89.69 414.07 -93.17 414.07 -97.45 L 414.07 -140.07 C 414.07 -144.34 410.61 -147.81 406.32 -147.81 L 312.37 -147.81 C 308.09 -147.81 304.62 -144.34 304.62 -140.07 Z" style="fill:none"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-dasharray="4.5pt,4.5pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 88.42 -250.62 C 88.42 -247.76 90.74 -245.43 93.61 -245.43 L 186.8 -245.43 C 189.66 -245.43 191.99 -247.76 191.99 -250.62 L 191.99 -283.83 C 191.99 -286.7 189.66 -289.02 186.8 -289.02 L 93.61 -289.02 C 90.74 -289.02 88.42 -286.7 88.42 -283.83 Z" style="fill:none"></path></g><g stroke-dasharray="4.5pt,4.5pt" stroke-dashoffset="0.0pt"><path d="M 87.87 -169.68 L 417.19 -169.68" style="fill:none"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 307.6 -143.56 h 50.85 v 50.85 h -50.85 Z" style="stroke:none"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1"><path d="M 309.67 -94.78 L 356.37 -94.78 L 356.37 -141.48 L 309.67 -141.48 Z" style="fill:none"></path></g><path d="M 333.02 -118.13" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 309.52 -141.63)"><foreignobject height="47" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="47"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="47" id="S1.F1.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/intro_point.png" width="47"/></foreignobject></g><g color="#FA004F" fill="#FA004F" fill-opacity="1" stroke="#FA004F" stroke-opacity="1"><path d="M 331.88 -117.27 C 331.88 -116.44 332.54 -115.77 333.37 -115.77 C 334.21 -115.77 334.88 -116.44 334.88 -117.27 C 334.88 -118.1 334.21 -118.76 333.37 -118.76 C 332.54 -118.76 331.88 -118.1 331.88 -117.27 Z"></path></g><path d="M 181.58 -206.86" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 154.29 -358.08)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 289.13)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 293.97)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="26.64" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="54.59">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S1.F1.1.pic1.10.10.10.1.1.1.1.1" style="width:39.4pt;">
<span class="ltx_p ltx_align_center" id="S1.F1.1.pic1.10.10.10.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S1.F1.1.pic1.10.10.10.1.1.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">Image 
<br class="ltx_break"/><span class="ltx_text" id="S1.F1.1.pic1.10.10.10.1.1.1.1.1.1.1.1">Encoder</span></span></span>
</span></foreignobject></g></g></g></g><path d="M 260.02 -269.53" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 232.73 -462.54)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 372.69)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 377.53)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="26.64" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="54.59">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S1.F1.1.pic1.11.11.11.1.1.1.1.1" style="width:39.4pt;">
<span class="ltx_p ltx_align_center" id="S1.F1.1.pic1.11.11.11.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S1.F1.1.pic1.11.11.11.1.1.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">Prompt
<br class="ltx_break"/><span class="ltx_text" id="S1.F1.1.pic1.11.11.11.1.1.1.1.1.1.1.1">Encoder</span></span></span>
</span></foreignobject></g></g></g></g><path d="M 257.34 -208.15" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 230.04 -360.23)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 290.84)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 295.69)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="26.64" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="54.6">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S1.F1.1.pic1.12.12.12.1.1.1.1.1" style="width:39.5pt;">
<span class="ltx_p ltx_align_center" id="S1.F1.1.pic1.12.12.12.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S1.F1.1.pic1.12.12.12.1.1.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">Mask 
<br class="ltx_break"/><span class="ltx_text" id="S1.F1.1.pic1.12.12.12.1.1.1.1.1.1.1.1">Decoder</span></span></span>
</span></foreignobject></g></g></g></g><path d="M 308.56 -183.89" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 310.12 -194.91)"><foreignobject height="13.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="27.93"><math alttext="\mathcal{{\color[rgb]{0.26,0.35,0.63}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.26,0.35,0.63}M}}{\color[rgb]{0.26,0.35,0.63}{}_{pred}}" class="ltx_math_unparsed" display="inline" id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1" mathcolor="#4259A1">ℳ</mi><msub id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.2"><mi id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.2a"></mi><mrow id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.2.1"><mi id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.2.1.2" mathcolor="#4259A1">p</mi><mo id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.2.1.1">⁢</mo><mi id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.2.1.3" mathcolor="#4259A1">r</mi><mo id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.2.1.1a">⁢</mo><mi id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.2.1.4" mathcolor="#4259A1">e</mi><mo id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.2.1.1b">⁢</mo><mi id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.2.1.5" mathcolor="#4259A1">d</mi></mrow></msub></mrow><annotation encoding="application/x-tex" id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1c">\mathcal{{\color[rgb]{0.26,0.35,0.63}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.26,0.35,0.63}M}}{\color[rgb]{0.26,0.35,0.63}{}_{pred}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1d">caligraphic_M start_FLOATSUBSCRIPT italic_p italic_r italic_e italic_d end_FLOATSUBSCRIPT</annotation></semantics></math></foreignobject></g><path d="M 308.91 -214.33" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 310.47 -227.73)"><foreignobject height="16.04" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="30.07"><math alttext="\mathcal{{\color[rgb]{0.86,0.35,0.31}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.86,0.35,0.31}M}}{\color[rgb]{0.86,0.35,0.31}{}^{\prime}}{\color[rgb]{%
0.86,0.35,0.31}{}_{pred}}" class="ltx_math_unparsed" display="inline" id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.1" mathcolor="#DB594F">ℳ</mi><mmultiscripts id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2"><msub id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.2"><mi id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.2a"></mi><mrow id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.2.1"><mi id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.2" mathcolor="#DB594F">p</mi><mo id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.1">⁢</mo><mi id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.3" mathcolor="#DB594F">r</mi><mo id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.1a">⁢</mo><mi id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.4" mathcolor="#DB594F">e</mi><mo id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.1b">⁢</mo><mi id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.5" mathcolor="#DB594F">d</mi></mrow></msub><mprescripts id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2a"></mprescripts><mrow id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2b"></mrow><mo id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.2.3" mathcolor="#DB594F">′</mo></mmultiscripts></mrow><annotation encoding="application/x-tex" id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1c">\mathcal{{\color[rgb]{0.86,0.35,0.31}\definecolor[named]{pgfstrokecolor}{rgb}{%
0.86,0.35,0.31}M}}{\color[rgb]{0.86,0.35,0.31}{}^{\prime}}{\color[rgb]{%
0.86,0.35,0.31}{}_{pred}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1d">caligraphic_M start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT start_FLOATSUBSCRIPT italic_p italic_r italic_e italic_d end_FLOATSUBSCRIPT</annotation></semantics></math></foreignobject></g><path d="M 178.82 -54.66" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 154 -104.42)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 86.2)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 91.04)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="26.64" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="49.63">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S1.F1.1.pic1.13.13.13.1.1.1.1.1" style="width:35.9pt;">
<span class="ltx_p ltx_align_center" id="S1.F1.1.pic1.13.13.13.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S1.F1.1.pic1.13.13.13.1.1.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">Image 
<br class="ltx_break"/><span class="ltx_text" id="S1.F1.1.pic1.13.13.13.1.1.1.1.1.1.1.1">Encoder</span></span></span>
</span></foreignobject></g></g></g></g><path d="M 253.54 -55.94" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 226.24 -106.54)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 87.9)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 92.74)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="26.64" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="54.6">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S1.F1.1.pic1.14.14.14.1.1.1.1.1" style="width:39.5pt;">
<span class="ltx_p ltx_align_center" id="S1.F1.1.pic1.14.14.14.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S1.F1.1.pic1.14.14.14.1.1.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">Mask 
<br class="ltx_break"/><span class="ltx_text" id="S1.F1.1.pic1.14.14.14.1.1.1.1.1.1.1.1">Decoder</span></span></span>
</span></foreignobject></g></g></g></g><path d="M 298.54 -44.95" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 300.09 -55.96)"><foreignobject height="13.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="27.93"><math alttext="\mathcal{M}_{pred}" class="ltx_Math" display="inline" id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">ℳ</mi><mrow id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.2" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml">p</mi><mo id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.1" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.3" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml">r</mi><mo id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.1a" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.4" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.4.cmml">e</mi><mo id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.1b" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.5" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2">ℳ</ci><apply id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3"><times id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.1"></times><ci id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.2">𝑝</ci><ci id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.3">𝑟</ci><ci id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.4.cmml" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.4">𝑒</ci><ci id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.5.cmml" xref="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1c">\mathcal{M}_{pred}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math></foreignobject></g><path d="M 83.09 -162.2" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 84.65 -160.65)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 223.19)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 226.65)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="101.09"><span class="ltx_text ltx_font_bold" id="S1.F1.1.pic1.15.15.15.1.1.1.1.1">(a) Vanilla SAM</span></foreignobject></g></g></g></g><path d="M 82.47 -317.38" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 84.03 -315.83)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 430.09)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 433.56)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="287.5"><span class="ltx_text ltx_font_bold" id="S1.F1.1.pic1.16.16.16.1.1.1.1.1">(b) Self Training-based Pointly-Supevised SAM</span></foreignobject></g></g></g></g><path d="M 391.77 -208.49" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 381.01 -352.34)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 282.84)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 285.55)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.72" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.52"><span class="ltx_text ltx_font_italic" id="S1.F1.1.pic1.17.17.17.1.1.1.1.1" style="font-size:80%;color:#F5A624;">Sup.</span></foreignobject></g></g></g></g><path d="M 411.89 -36.25" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 369.86 -63.78)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 51.695)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 55.06)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="6.73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="40.48"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.F1.1.pic1.18.18.18.1.1.1.1.1" style="font-size:70%;color:#FFFFFF;">GT Mask</span></foreignobject></g></g></g></g><path d="M 256.22 -117.33" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 228.92 -208.87)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 169.76)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 174.6)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="26.64" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="54.59">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S1.F1.1.pic1.19.19.19.1.1.1.1.1" style="width:39.4pt;">
<span class="ltx_p ltx_align_center" id="S1.F1.1.pic1.19.19.19.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S1.F1.1.pic1.19.19.19.1.1.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">Prompt
<br class="ltx_break"/><span class="ltx_text" id="S1.F1.1.pic1.19.19.19.1.1.1.1.1.1.1.1">Encoder</span></span></span>
</span></foreignobject></g></g></g></g><path d="M 150.76 -256.71" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 124.12 -432.78)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 347.21)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 349.98)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="53.5"><span class="ltx_text ltx_font_bold" id="S1.F1.1.pic1.20.20.20.1.1.1.1.1" style="font-size:80%;">Weak Aug.</span></foreignobject></g></g></g></g><path d="M 153.29 -277.81" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 123.91 -467.88)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 375.27)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 377.98)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.72" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="58.76"><span class="ltx_text ltx_font_bold" id="S1.F1.1.pic1.21.21.21.1.1.1.1.1" style="font-size:80%;">Strong Aug.</span></foreignobject></g></g></g></g><path d="M 350.19 -53.21" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 339.42 -51.65)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 75.8)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 78.5)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.72" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.52"><span class="ltx_text ltx_font_italic" id="S1.F1.1.pic1.22.22.22.1.1.1.1.1" style="font-size:80%;color:#F5A624;">Sup.</span></foreignobject></g></g></g></g><path d="M 354.82 -99.45" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 330.52 -169.06)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 135.91)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 139.22)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="6.62" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="22.74"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.F1.1.pic1.23.23.23.1.1.1.1.1" style="font-size:70%;color:#FFFFFF;">Point</span></foreignobject></g></g></g></g><path d="M 408.43 -99.51" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 390.32 -169.16)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 135.99)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 139.3)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="6.62" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.55"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.F1.1.pic1.24.24.24.1.1.1.1.1" style="font-size:70%;color:#FFFFFF;">Box</span></foreignobject></g></g></g></g><path d="M 365.89 -251.56" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 341.6 -422.57)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 338.72)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 342.03)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="6.62" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="22.74"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.F1.1.pic1.25.25.25.1.1.1.1.1" style="font-size:70%;color:#FFFFFF;">Point</span></foreignobject></g></g></g></g></g></svg>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>(a) Training pipeline of vanilla SAM. (b) Training pipeline of self-training based pointly-supervised SAM. <span class="ltx_text ltx_font_italic" id="S1.F1.3.1">Sup.</span> means supervise.
</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">While these methods have shown promising results, they also require full mask annotations, which are difficult and time-consuming to obtain. As a result, some approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite> have begun exploring label-efficient strategies for SAM. WeSAM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite> and SlotSAM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite> leverage self-training techniques <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">19</span></a>]</cite> with weak labels, such as points, boxes, and polygons, to generate pseudo-labels, allowing the network to predict complete masks. Cat-SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite> adopts a few-shot learning approach to fine-tune SAM using box prompts to predict masks. While using boxes or coarse masks as prompts have yielded excellent results, point annotations remain less effective than fully supervised methods. Moreover, point annotations are much cheaper than masks and boxes <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://cloud.google.com/ai-platform/data-labeling/pricing</span></span></span>, particularly for RSIs with numerous dense objects. Therefore, this paper aims to fine-tune SAM for RSIs using the most challenging yet cost-effective <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">point</span> annotations.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.6">As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S1.F1" title="Figure 1 ‣ I Introduction ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">1</span></a> (a), we first present the fine-tuning process of vanilla SAM using full mask annotations. It takes point or box prompts as input to generate the predicted mask <math alttext="\mathcal{M}_{pred}" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><msub id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">ℳ</mi><mrow id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml"><mi id="S1.p4.1.m1.1.1.3.2" xref="S1.p4.1.m1.1.1.3.2.cmml">p</mi><mo id="S1.p4.1.m1.1.1.3.1" xref="S1.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.1.m1.1.1.3.3" xref="S1.p4.1.m1.1.1.3.3.cmml">r</mi><mo id="S1.p4.1.m1.1.1.3.1a" xref="S1.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.1.m1.1.1.3.4" xref="S1.p4.1.m1.1.1.3.4.cmml">e</mi><mo id="S1.p4.1.m1.1.1.3.1b" xref="S1.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.1.m1.1.1.3.5" xref="S1.p4.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1">subscript</csymbol><ci id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2">ℳ</ci><apply id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3"><times id="S1.p4.1.m1.1.1.3.1.cmml" xref="S1.p4.1.m1.1.1.3.1"></times><ci id="S1.p4.1.m1.1.1.3.2.cmml" xref="S1.p4.1.m1.1.1.3.2">𝑝</ci><ci id="S1.p4.1.m1.1.1.3.3.cmml" xref="S1.p4.1.m1.1.1.3.3">𝑟</ci><ci id="S1.p4.1.m1.1.1.3.4.cmml" xref="S1.p4.1.m1.1.1.3.4">𝑒</ci><ci id="S1.p4.1.m1.1.1.3.5.cmml" xref="S1.p4.1.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\mathcal{M}_{pred}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, which is supervised by the ground truth (GT) mask <math alttext="\mathcal{M}_{gt}" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><msub id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.2.m2.1.1.2" xref="S1.p4.2.m2.1.1.2.cmml">ℳ</mi><mrow id="S1.p4.2.m2.1.1.3" xref="S1.p4.2.m2.1.1.3.cmml"><mi id="S1.p4.2.m2.1.1.3.2" xref="S1.p4.2.m2.1.1.3.2.cmml">g</mi><mo id="S1.p4.2.m2.1.1.3.1" xref="S1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.2.m2.1.1.3.3" xref="S1.p4.2.m2.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><apply id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p4.2.m2.1.1.1.cmml" xref="S1.p4.2.m2.1.1">subscript</csymbol><ci id="S1.p4.2.m2.1.1.2.cmml" xref="S1.p4.2.m2.1.1.2">ℳ</ci><apply id="S1.p4.2.m2.1.1.3.cmml" xref="S1.p4.2.m2.1.1.3"><times id="S1.p4.2.m2.1.1.3.1.cmml" xref="S1.p4.2.m2.1.1.3.1"></times><ci id="S1.p4.2.m2.1.1.3.2.cmml" xref="S1.p4.2.m2.1.1.3.2">𝑔</ci><ci id="S1.p4.2.m2.1.1.3.3.cmml" xref="S1.p4.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\mathcal{M}_{gt}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">caligraphic_M start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. In contrast, the self-training-based method<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite> (depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S1.F1" title="Figure 1 ‣ I Introduction ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">1</span></a> (b)) only requires pseudo-labels generated by the model itself. Specifically, the input undergoes both weak and strong augmentations separately and is fed into the network, resulting in <math alttext="\mathcal{M}_{pred}" class="ltx_Math" display="inline" id="S1.p4.3.m3.1"><semantics id="S1.p4.3.m3.1a"><msub id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.3.m3.1.1.2" xref="S1.p4.3.m3.1.1.2.cmml">ℳ</mi><mrow id="S1.p4.3.m3.1.1.3" xref="S1.p4.3.m3.1.1.3.cmml"><mi id="S1.p4.3.m3.1.1.3.2" xref="S1.p4.3.m3.1.1.3.2.cmml">p</mi><mo id="S1.p4.3.m3.1.1.3.1" xref="S1.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.3.m3.1.1.3.3" xref="S1.p4.3.m3.1.1.3.3.cmml">r</mi><mo id="S1.p4.3.m3.1.1.3.1a" xref="S1.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.3.m3.1.1.3.4" xref="S1.p4.3.m3.1.1.3.4.cmml">e</mi><mo id="S1.p4.3.m3.1.1.3.1b" xref="S1.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.3.m3.1.1.3.5" xref="S1.p4.3.m3.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><apply id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p4.3.m3.1.1.1.cmml" xref="S1.p4.3.m3.1.1">subscript</csymbol><ci id="S1.p4.3.m3.1.1.2.cmml" xref="S1.p4.3.m3.1.1.2">ℳ</ci><apply id="S1.p4.3.m3.1.1.3.cmml" xref="S1.p4.3.m3.1.1.3"><times id="S1.p4.3.m3.1.1.3.1.cmml" xref="S1.p4.3.m3.1.1.3.1"></times><ci id="S1.p4.3.m3.1.1.3.2.cmml" xref="S1.p4.3.m3.1.1.3.2">𝑝</ci><ci id="S1.p4.3.m3.1.1.3.3.cmml" xref="S1.p4.3.m3.1.1.3.3">𝑟</ci><ci id="S1.p4.3.m3.1.1.3.4.cmml" xref="S1.p4.3.m3.1.1.3.4">𝑒</ci><ci id="S1.p4.3.m3.1.1.3.5.cmml" xref="S1.p4.3.m3.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">\mathcal{M}_{pred}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.m3.1d">caligraphic_M start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{M}^{\prime}_{pred}" class="ltx_Math" display="inline" id="S1.p4.4.m4.1"><semantics id="S1.p4.4.m4.1a"><msubsup id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.4.m4.1.1.2.2" xref="S1.p4.4.m4.1.1.2.2.cmml">ℳ</mi><mrow id="S1.p4.4.m4.1.1.3" xref="S1.p4.4.m4.1.1.3.cmml"><mi id="S1.p4.4.m4.1.1.3.2" xref="S1.p4.4.m4.1.1.3.2.cmml">p</mi><mo id="S1.p4.4.m4.1.1.3.1" xref="S1.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.4.m4.1.1.3.3" xref="S1.p4.4.m4.1.1.3.3.cmml">r</mi><mo id="S1.p4.4.m4.1.1.3.1a" xref="S1.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.4.m4.1.1.3.4" xref="S1.p4.4.m4.1.1.3.4.cmml">e</mi><mo id="S1.p4.4.m4.1.1.3.1b" xref="S1.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.4.m4.1.1.3.5" xref="S1.p4.4.m4.1.1.3.5.cmml">d</mi></mrow><mo id="S1.p4.4.m4.1.1.2.3" xref="S1.p4.4.m4.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.1b"><apply id="S1.p4.4.m4.1.1.cmml" xref="S1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p4.4.m4.1.1.1.cmml" xref="S1.p4.4.m4.1.1">subscript</csymbol><apply id="S1.p4.4.m4.1.1.2.cmml" xref="S1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p4.4.m4.1.1.2.1.cmml" xref="S1.p4.4.m4.1.1">superscript</csymbol><ci id="S1.p4.4.m4.1.1.2.2.cmml" xref="S1.p4.4.m4.1.1.2.2">ℳ</ci><ci id="S1.p4.4.m4.1.1.2.3.cmml" xref="S1.p4.4.m4.1.1.2.3">′</ci></apply><apply id="S1.p4.4.m4.1.1.3.cmml" xref="S1.p4.4.m4.1.1.3"><times id="S1.p4.4.m4.1.1.3.1.cmml" xref="S1.p4.4.m4.1.1.3.1"></times><ci id="S1.p4.4.m4.1.1.3.2.cmml" xref="S1.p4.4.m4.1.1.3.2">𝑝</ci><ci id="S1.p4.4.m4.1.1.3.3.cmml" xref="S1.p4.4.m4.1.1.3.3">𝑟</ci><ci id="S1.p4.4.m4.1.1.3.4.cmml" xref="S1.p4.4.m4.1.1.3.4">𝑒</ci><ci id="S1.p4.4.m4.1.1.3.5.cmml" xref="S1.p4.4.m4.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.1c">\mathcal{M}^{\prime}_{pred}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.4.m4.1d">caligraphic_M start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, respectively. <math alttext="\mathcal{M}_{pred}" class="ltx_Math" display="inline" id="S1.p4.5.m5.1"><semantics id="S1.p4.5.m5.1a"><msub id="S1.p4.5.m5.1.1" xref="S1.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.5.m5.1.1.2" xref="S1.p4.5.m5.1.1.2.cmml">ℳ</mi><mrow id="S1.p4.5.m5.1.1.3" xref="S1.p4.5.m5.1.1.3.cmml"><mi id="S1.p4.5.m5.1.1.3.2" xref="S1.p4.5.m5.1.1.3.2.cmml">p</mi><mo id="S1.p4.5.m5.1.1.3.1" xref="S1.p4.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.5.m5.1.1.3.3" xref="S1.p4.5.m5.1.1.3.3.cmml">r</mi><mo id="S1.p4.5.m5.1.1.3.1a" xref="S1.p4.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.5.m5.1.1.3.4" xref="S1.p4.5.m5.1.1.3.4.cmml">e</mi><mo id="S1.p4.5.m5.1.1.3.1b" xref="S1.p4.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.5.m5.1.1.3.5" xref="S1.p4.5.m5.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p4.5.m5.1b"><apply id="S1.p4.5.m5.1.1.cmml" xref="S1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S1.p4.5.m5.1.1.1.cmml" xref="S1.p4.5.m5.1.1">subscript</csymbol><ci id="S1.p4.5.m5.1.1.2.cmml" xref="S1.p4.5.m5.1.1.2">ℳ</ci><apply id="S1.p4.5.m5.1.1.3.cmml" xref="S1.p4.5.m5.1.1.3"><times id="S1.p4.5.m5.1.1.3.1.cmml" xref="S1.p4.5.m5.1.1.3.1"></times><ci id="S1.p4.5.m5.1.1.3.2.cmml" xref="S1.p4.5.m5.1.1.3.2">𝑝</ci><ci id="S1.p4.5.m5.1.1.3.3.cmml" xref="S1.p4.5.m5.1.1.3.3">𝑟</ci><ci id="S1.p4.5.m5.1.1.3.4.cmml" xref="S1.p4.5.m5.1.1.3.4">𝑒</ci><ci id="S1.p4.5.m5.1.1.3.5.cmml" xref="S1.p4.5.m5.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.5.m5.1c">\mathcal{M}_{pred}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.5.m5.1d">caligraphic_M start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math> serves as a pseudo-label to constrain <math alttext="\mathcal{M}^{\prime}_{pred}" class="ltx_Math" display="inline" id="S1.p4.6.m6.1"><semantics id="S1.p4.6.m6.1a"><msubsup id="S1.p4.6.m6.1.1" xref="S1.p4.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p4.6.m6.1.1.2.2" xref="S1.p4.6.m6.1.1.2.2.cmml">ℳ</mi><mrow id="S1.p4.6.m6.1.1.3" xref="S1.p4.6.m6.1.1.3.cmml"><mi id="S1.p4.6.m6.1.1.3.2" xref="S1.p4.6.m6.1.1.3.2.cmml">p</mi><mo id="S1.p4.6.m6.1.1.3.1" xref="S1.p4.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.6.m6.1.1.3.3" xref="S1.p4.6.m6.1.1.3.3.cmml">r</mi><mo id="S1.p4.6.m6.1.1.3.1a" xref="S1.p4.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.6.m6.1.1.3.4" xref="S1.p4.6.m6.1.1.3.4.cmml">e</mi><mo id="S1.p4.6.m6.1.1.3.1b" xref="S1.p4.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S1.p4.6.m6.1.1.3.5" xref="S1.p4.6.m6.1.1.3.5.cmml">d</mi></mrow><mo id="S1.p4.6.m6.1.1.2.3" xref="S1.p4.6.m6.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S1.p4.6.m6.1b"><apply id="S1.p4.6.m6.1.1.cmml" xref="S1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S1.p4.6.m6.1.1.1.cmml" xref="S1.p4.6.m6.1.1">subscript</csymbol><apply id="S1.p4.6.m6.1.1.2.cmml" xref="S1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S1.p4.6.m6.1.1.2.1.cmml" xref="S1.p4.6.m6.1.1">superscript</csymbol><ci id="S1.p4.6.m6.1.1.2.2.cmml" xref="S1.p4.6.m6.1.1.2.2">ℳ</ci><ci id="S1.p4.6.m6.1.1.2.3.cmml" xref="S1.p4.6.m6.1.1.2.3">′</ci></apply><apply id="S1.p4.6.m6.1.1.3.cmml" xref="S1.p4.6.m6.1.1.3"><times id="S1.p4.6.m6.1.1.3.1.cmml" xref="S1.p4.6.m6.1.1.3.1"></times><ci id="S1.p4.6.m6.1.1.3.2.cmml" xref="S1.p4.6.m6.1.1.3.2">𝑝</ci><ci id="S1.p4.6.m6.1.1.3.3.cmml" xref="S1.p4.6.m6.1.1.3.3">𝑟</ci><ci id="S1.p4.6.m6.1.1.3.4.cmml" xref="S1.p4.6.m6.1.1.3.4">𝑒</ci><ci id="S1.p4.6.m6.1.1.3.5.cmml" xref="S1.p4.6.m6.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.6.m6.1c">\mathcal{M}^{\prime}_{pred}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.6.m6.1d">caligraphic_M start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, enabling iterative training. This method is feasible primarily due to the principles of source-free domain adaptation (SFDA)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">20</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib21" title=""><span class="ltx_text" style="font-size:90%;">21</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib22" title=""><span class="ltx_text" style="font-size:90%;">22</span></a>]</cite>. The core idea of SFDA is to improve model performance using unlabeled data from the target domain without requiring access to source domain data.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">However, self-training often depends on the quality of pseudo-labels. If there is noise in the pseudo-labels, the model may overfit incorrect patterns. To address this, two common approaches are feature alignment <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">23</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib25" title=""><span class="ltx_text" style="font-size:90%;">25</span></a>]</cite> and logit regularization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite>. However, the former requires access to the distribution of source data, which is impractical for SAM. The latter can also affect results if the prediction of anchor logits is inaccurate. In contrast to these methods, our approach aligns the features of the source and target models at the image encoder. Rather than performing simple image-level alignment, we map the corresponding prompt locations to the encoder features for instance-level alignment. Since object point labels are already annotated, we do not rely on inaccurate predicted logits for constraints or use source data information. Specifically, before beginning self-training, we first extract features for each instance from the target data using the source model. We then cluster these instances using the parameter-free clustering algorithm FINCH <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite> and compute <span class="ltx_text ltx_font_italic" id="S1.p5.1.1">target prototypes</span> for all clusters. During self-training, we maintain a First-in-First-Out (FIFO) memory bank, which stores instance-level predicted features and computes the <span class="ltx_text ltx_font_italic" id="S1.p5.1.2">predicted prototypes</span> similarly. Since discrepancies between the number of target and predicted prototypes may exist, direct correspondence cannot be established. To resolve this, we employ the Hungarian algorithm, which automatically matches these two types of prototypes and aligns them using a matching loss. We call this method <span class="ltx_text ltx_font_bold" id="S1.p5.1.3">Prototype-based Regularization</span> (PBR).</p>
</div>
<figure class="ltx_figure" id="S1.F2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S1.F2.1" style="width:411.9pt;height:400pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(138.1pt,-134.1pt) scale(3.03345722191953,3.03345722191953) ;"><svg class="ltx_picture" height="182.48" id="S1.F2.1.pic1" overflow="visible" version="1.1" width="174.07"><g fill="#000000" stroke="#000000" stroke-width="0.75pt" transform="translate(0,182.48) matrix(1 0 0 -1 0 0) translate(-57.48,0) translate(0,135.21)"><path d="M 98.59 -55.98" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 62.09 -92.48)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/sam_w_pos.png" width="73"/></foreignobject></g><g color="#FFFFFF" fill="#FFFFFF" stroke="#FFFFFF" stroke-opacity="1"><path d="M 82.5 -52.41 L 90.92 -68.59" style="fill:none"></path></g><g fill="#FFFFFF" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 89.07 -68.88 L 92.36 -71.35 L 92.23 -67.24 Z"></path></g><g color="#D0021B" fill="#D0021B" fill-opacity="1" stroke="#D0021B" stroke-opacity="1"><path d="M 80.42 -50.11 C 80.42 -49.64 80.81 -49.24 81.3 -49.24 C 81.78 -49.24 82.17 -49.64 82.17 -50.11 C 82.17 -50.6 81.78 -51 81.3 -51 C 80.81 -51 80.42 -50.6 80.42 -50.11 Z"></path></g><path d="M 190.43 -55.86" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 153.93 -92.36)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/sam_w_pos_neg.png" width="73"/></foreignobject></g><g color="#D0021B" fill="#D0021B" fill-opacity="1" stroke="#D0021B" stroke-opacity="1"><path d="M 171.95 -50.32 C 171.95 -49.84 172.34 -49.45 172.83 -49.45 C 173.31 -49.45 173.7 -49.84 173.7 -50.32 C 173.7 -50.81 173.31 -51.2 172.83 -51.2 C 172.34 -51.2 171.95 -50.81 171.95 -50.32 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1"><path d="M 169.46 -46.38 C 169.46 -45.9 169.85 -45.51 170.34 -45.51 C 170.82 -45.51 171.21 -45.9 171.21 -46.38 C 171.21 -46.87 170.82 -47.26 170.34 -47.26 C 169.85 -47.26 169.46 -46.87 169.46 -46.38 Z"></path></g><g color="#FFFFFF" fill="#FFFFFF" stroke="#FFFFFF" stroke-opacity="1"><path d="M 172.48 -44.94 L 188.55 -34.39" style="fill:none"></path></g><g fill="#FFFFFF" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 189.04 -36.21 L 191.16 -32.69 L 187.08 -33.23 Z"></path></g><path d="M 89.74 -104.56" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 91.29 -103)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 144.245)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 146.67)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.38"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.3.3.3.1.1.1.1.1" style="font-size:70%;">(a)</span></foreignobject></g></g></g></g><path d="M 183.6 -104.97" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 185.16 -103.41)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 144.805)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 147.22)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.91"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.4.4.4.1.1.1.1.1" style="font-size:70%;">(b)</span></foreignobject></g></g></g></g><path d="M 192.46 -26.15" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 166.98 -46.62)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 37.905)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 39.6)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="6.07" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="51.14"><span class="ltx_text" id="S1.F2.1.pic1.5.5.5.1.1.1.1.1" style="font-size:50%;color:#FFFFFF;">Negative prompt</span></foreignobject></g></g></g></g><path d="M 97.9 -76.54" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 73.71 -130.6)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 105.085)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 106.78)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="6.07" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="48.58"><span class="ltx_text" id="S1.F2.1.pic1.6.6.6.1.1.1.1.1" style="font-size:50%;color:#FFFFFF;">Positive prompt</span></foreignobject></g></g></g></g></g></svg>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>(a) Segmentation results using only positive prompts. (b) Segmentation results using both positive and negative prompts.
</figcaption>
</figure>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Moreover, RSIs are captured from overhead perspectives and contain densely detected objects and large-scale backgrounds, making points as prompts more semantically ambiguous because points lack boundary information. We tested RSIs on SAM’s demo website <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://segment-anything.com/demo</span></span></span>; as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S1.F2" title="Figure 2 ‣ I Introduction ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">2</span></a> (a), the densely distributed tennis courts in the image can cause the mask decoder to mistakenly interpret them as a single instance. However, after adding negative samples (shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S1.F2" title="Figure 2 ‣ I Introduction ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">2</span></a> (b)), the remaining parts were effectively removed. Inspired by this, selecting appropriate locations for negative prompts is crucial. To address this, we propose a method for adaptively extracting negative prompts during training, called <span class="ltx_text ltx_font_bold" id="S1.p6.1.1">Negative Prompt Calibration</span> (NPC). The process is based on a prior assumption: <span class="ltx_text ltx_font_italic" id="S1.p6.1.2">there is no overlap between predicted masks of different instances</span>. We first calculate the IoU between each instance and use other samples with an IoU above a certain threshold with respect to a given sample as candidate negative prompts. Then, we randomly select <math alttext="k" class="ltx_Math" display="inline" id="S1.p6.1.m1.1"><semantics id="S1.p6.1.m1.1a"><mi id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><ci id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.m1.1d">italic_k</annotation></semantics></math> positive prompts to serve as negative prompts for the target sample. Finally, we input the new prompts into the mask decoder to obtain refined masks.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">We integrate the above two methods into the self-training-based point-supervised framework, named PointSAM. We conduct experiments on three representative RSI datasets: NWPU VHR-10, WHU, and HRSID. The results demonstrate that our approach effectively adapts vanilla SAM to various RSI scenarios under point supervision. Additionally, we apply PointSAM as a bounding box generator in point-supervised object detection tasks, indicating that this method can extend to other point-supervised applications. Our contributions are summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p8">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce Prototype-based Regularization (PBR), which aligns the features of source and target models at the instance level, utilizing dynamic prototype updating and the Hungarian algorithm to improve model generalization.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We develop Negative Prompt Calibration (NPC), which adaptively adjusts negative prompts during training, enhancing the accuracy of predicted masks in dense scenarios.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We demonstrate the effectiveness of PointSAM through extensive experiments on three RSI datasets (NWPU VHR-10, WHU, and HRSID), showing significant improvements in segmentation performance under point supervision. Additionally, we extend the application of PointSAM to bounding box generation in point-supervised oriented object detection tasks, showcasing its versatility and potential for broader use in point-based supervised learning scenarios.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Related Work</span>
</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS1.5.1.1">II-A</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS1.6.2">Segment Anything Model</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Segment Anything Model (SAM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite> was developed by Meta AI, leveraging a large and diverse training dataset and a powerful neural network architecture to perform segmentation tasks on any image. By inputting points or bounding boxes as prompts, the desired instance masks can be obtained. To make it more suitable for various platforms or scenarios, some methods have been improved primarily in terms of speed and accuracy. To reduce the model complexity of SAM, researchers have focused on knowledge distillation and self-supervised techniques. For example, MobileSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib28" title=""><span class="ltx_text" style="font-size:90%;">28</span></a>]</cite> distills knowledge from the large image encoder ViT-H in the original SAM into a lightweight encoder. EfficientSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib29" title=""><span class="ltx_text" style="font-size:90%;">29</span></a>]</cite> employs a reconstruction self-supervised method using MAE to transfer knowledge to a smaller image encoder that replaces the original SAM encoder. To further enhance the segmentation accuracy, HQ-SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite> introduces learnable High-Quality Output Tokens and their associated three-layer MLPs to correct the mask errors of SAM’s output tokens. Additionally, because SAM is category-agnostic, some methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib31" title=""><span class="ltx_text" style="font-size:90%;">31</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib32" title=""><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite> have incorporated text models<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite> to provide the masks with category information.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Thanks to SAM’s strong zero-shot and generalization capabilities, it has also been successfully adapted to RSIs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib11" title=""><span class="ltx_text" style="font-size:90%;">11</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib33" title=""><span class="ltx_text" style="font-size:90%;">33</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib34" title=""><span class="ltx_text" style="font-size:90%;">34</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib35" title=""><span class="ltx_text" style="font-size:90%;">35</span></a>]</cite>. Due to the semantic gap between RSIs and natural images, mainstream methods typically use SAM’s encoder as a backbone and apply existing fine-tuning techniques, such as LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib36" title=""><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite> and adapter methods. For example, TTP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib37" title=""><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite> uses SAM’s encoder as the backbone for change detection and fine-tunes with LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib36" title=""><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite>. RSPrompter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib10" title=""><span class="ltx_text" style="font-size:90%;">10</span></a>]</cite> freezes some modules of SAM and uses adapters for instance segmentation. However, these methods require fully annotated data for fine-tuning. In contrast, our work focuses on fine-tuning SAM with minimal annotation costs, and we are the first to explore fine-tuning SAM using point annotations for RSIs.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS2.5.1.1">II-B</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS2.6.2">Point-based supervision</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Point annotations are often used to save on mask or box annotations.
Compared to image-level annotations, it can indicate the object’s location, providing stronger priors for subsequent processing and offering better practicality.
Point-supervised methods are widely applied in detection <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib38" title=""><span class="ltx_text" style="font-size:90%;">38</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib39" title=""><span class="ltx_text" style="font-size:90%;">39</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib40" title=""><span class="ltx_text" style="font-size:90%;">40</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib41" title=""><span class="ltx_text" style="font-size:90%;">41</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib42" title=""><span class="ltx_text" style="font-size:90%;">42</span></a>]</cite> or segmentation<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib43" title=""><span class="ltx_text" style="font-size:90%;">43</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib44" title=""><span class="ltx_text" style="font-size:90%;">44</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib45" title=""><span class="ltx_text" style="font-size:90%;">45</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib46" title=""><span class="ltx_text" style="font-size:90%;">46</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib47" title=""><span class="ltx_text" style="font-size:90%;">47</span></a>]</cite> tasks. For example, P2BNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib39" title=""><span class="ltx_text" style="font-size:90%;">39</span></a>]</cite> uses Multiple Instance Learning (MIL) to select the box with the highest confidence from multiple boxes containing points. Point2Mask <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib44" title=""><span class="ltx_text" style="font-size:90%;">44</span></a>]</cite> formulates the pseudo-mask generation from points as an Optimal Transport (OT) problem.
Unlike natural images, instances in RSIs are mostly smaller and more densely packed, making point annotations much more convenient for label generation. PointOBB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib40" title=""><span class="ltx_text" style="font-size:90%;">40</span></a>]</cite> learns object scale and angle information through self-supervised learning across different views, enabling the generation of oriented bounding boxes from points. PMHO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib41" title=""><span class="ltx_text" style="font-size:90%;">41</span></a>]</cite> first uses SAM as a point-to-mask converter. Then, it converts the initial mask into a horizontal bounding box (HBB) and uses an HBB-to-OBB network to obtain the final oriented bounding boxes (OBB).
In our work, we aim to fine-tune the original SAM model using point annotations to better adapt it to RSIs. Consequently, a straightforward idea is to use the proposed PointSAM as a point-to-box converter, similar to PMHO. We also conducted experiments on weakly supervised oriented object detection and achieved promising results.</p>
</div>
<figure class="ltx_figure" id="S2.F3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S2.F3.1" style="width:424.9pt;height:541.7pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-61.8pt,78.6pt) scale(0.7748014054973,0.7748014054973) ;"><svg class="ltx_picture" height="966" id="S2.F3.1.pic1" overflow="visible" version="1.1" width="749.68"><g fill="#000000" stroke="#000000" stroke-width="0.75pt" transform="translate(0,966) matrix(1 0 0 -1 0 0) translate(60.5,0) translate(0,839.52)"><g color="#4A4A4A" fill="#F1F8EF" fill-opacity="1" stroke="#4A4A4A" stroke-dasharray="4.5pt,4.5pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 4.97 -29.01 C 4.97 -24.83 8.34 -21.46 12.52 -21.46 L 600.18 -21.46 C 604.35 -21.46 607.72 -24.83 607.72 -29.01 L 607.72 -139.25 C 607.72 -143.42 604.35 -146.79 600.18 -146.79 L 12.52 -146.79 C 8.34 -146.79 4.97 -143.42 4.97 -139.25 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 2.08 -2.08)"><path d="M 15.69 -112.21 h 80.95 v 80.95 h -80.95 Z" style="stroke:none"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="1" stroke="#9B9B9B" stroke-opacity="1"><path d="M 19.84 -35.42 L 92.49 -35.42 L 92.49 -108.06 L 19.84 -108.06 Z"></path></g><g color="#808080" fill="#9013FE" fill-opacity="0.04" stroke="#808080" stroke-dasharray="3.0pt,3.0pt,3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 515.48 -71.91 C 515.48 -51.85 531.75 -35.59 551.81 -35.59 C 571.87 -35.59 588.13 -51.85 588.13 -71.91 C 588.13 -91.97 571.87 -108.23 551.81 -108.23 C 531.75 -108.23 515.48 -91.97 515.48 -71.91 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 531.85 -61.72 h 12.9 v 12.94 h -12.9 Z" style="stroke:none"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="1" stroke="#9013FE" stroke-opacity="1" stroke-width="0.75pt"><path d="M 540.1 -50.85 L 539.57 -54.23 L 542.67 -55.7 L 539.29 -56.25 L 538.85 -59.64 L 537.3 -56.59 L 533.92 -57.23 L 536.34 -54.8 L 534.69 -51.8 L 537.75 -53.35 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 543.03 -59.78 C 543.03 -57.76 544.66 -56.14 546.66 -56.14 C 548.66 -56.14 550.29 -57.76 550.29 -59.78 C 550.29 -61.78 548.66 -63.41 546.66 -63.41 C 544.66 -63.41 543.03 -61.78 543.03 -59.78 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 536.96 -45.75 C 536.96 -43.74 538.58 -42.11 540.59 -42.11 C 542.59 -42.11 544.22 -43.74 544.22 -45.75 C 544.22 -47.75 542.59 -49.38 540.59 -49.38 C 538.58 -49.38 536.96 -47.75 536.96 -45.75 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 524.84 -60.27 C 524.84 -58.27 526.47 -56.64 528.48 -56.64 C 530.49 -56.64 532.11 -58.27 532.11 -60.27 C 532.11 -62.28 530.49 -63.91 528.48 -63.91 C 526.47 -63.91 524.84 -62.28 524.84 -60.27 Z"></path></g><g color="#417505" fill="#417505" fill-opacity="0.5" stroke="#417505" stroke-opacity="1"><path d="M 567.24 -64.27 C 567.24 -62.27 568.87 -60.64 570.87 -60.64 C 572.88 -60.64 574.5 -62.27 574.5 -64.27 C 574.5 -66.27 572.88 -67.9 570.87 -67.9 C 568.87 -67.9 567.24 -66.27 567.24 -64.27 Z"></path></g><g color="#417505" fill="#417505" fill-opacity="0.5" stroke="#417505" stroke-opacity="1"><path d="M 577.97 -71.88 C 577.97 -69.87 579.59 -68.24 581.6 -68.24 C 583.6 -68.24 585.23 -69.87 585.23 -71.88 C 585.23 -73.89 583.6 -75.51 581.6 -75.51 C 579.59 -75.51 577.97 -73.89 577.97 -71.88 Z"></path></g><g color="#417505" fill="#417505" fill-opacity="0.5" stroke="#417505" stroke-opacity="1"><path d="M 564.12 -83.64 C 564.12 -81.63 565.75 -80.01 567.76 -80.01 C 569.77 -80.01 571.39 -81.63 571.39 -83.64 C 571.39 -85.65 569.77 -87.28 567.76 -87.28 C 565.75 -87.28 564.12 -85.65 564.12 -83.64 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 535.42 -79.49 C 535.42 -77.48 537.04 -75.86 539.05 -75.86 C 541.05 -75.86 542.68 -77.48 542.68 -79.49 C 542.68 -81.5 541.05 -83.13 539.05 -83.13 C 537.04 -83.13 535.42 -81.5 535.42 -79.49 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 547.18 -87.44 C 547.18 -85.44 548.81 -83.81 550.81 -83.81 C 552.81 -83.81 554.44 -85.44 554.44 -87.44 C 554.44 -89.46 552.81 -91.08 550.81 -91.08 C 548.81 -91.08 547.18 -89.46 547.18 -87.44 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 538.88 -100.59 C 538.88 -98.59 540.5 -96.96 542.51 -96.96 C 544.51 -96.96 546.14 -98.59 546.14 -100.59 C 546.14 -102.59 544.51 -104.22 542.51 -104.22 C 540.5 -104.22 538.88 -102.59 538.88 -100.59 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 526.42 -91.25 C 526.42 -89.25 528.05 -87.62 530.05 -87.62 C 532.06 -87.62 533.69 -89.25 533.69 -91.25 C 533.69 -93.25 532.06 -94.88 530.05 -94.88 C 528.05 -94.88 526.42 -93.25 526.42 -91.25 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 566.25 -81.59 h 12.9 v 12.95 h -12.9 Z" style="stroke:none"></path></g><g color="#417505" fill="#417505" fill-opacity="1" stroke="#417505" stroke-opacity="1" stroke-width="0.75pt"><path d="M 574.51 -70.71 L 573.97 -74.11 L 577.08 -75.57 L 573.69 -76.11 L 573.27 -79.51 L 571.7 -76.45 L 568.33 -77.1 L 570.76 -74.67 L 569.11 -71.66 L 572.16 -73.22 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 533.9 -95.82 h 12.9 v 12.94 h -12.9 Z" style="stroke:none"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1" stroke-width="0.75pt"><path d="M 542.16 -84.95 L 541.63 -88.34 L 544.73 -89.8 L 541.34 -90.34 L 540.91 -93.74 L 539.35 -90.69 L 535.98 -91.33 L 538.41 -88.91 L 536.75 -85.9 L 539.81 -87.44 Z"></path></g><g color="#4A4A4A" fill="#F9F8F2" fill-opacity="1" stroke="#4A4A4A" stroke-dasharray="4.5pt,4.5pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 4.83 -162.41 C 4.83 -156.75 9.42 -152.15 15.09 -152.15 L 597.36 -152.15 C 603.03 -152.15 607.63 -156.75 607.63 -162.41 L 607.63 -392.4 C 607.63 -398.07 603.03 -402.67 597.36 -402.67 L 15.09 -402.67 C 9.42 -402.67 4.83 -398.07 4.83 -392.4 Z"></path></g><g fill="#808080" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 131.68 -252.9 h 89.16 v 62.43 h -89.16 Z" style="stroke:none"></path></g><g color="#B4021B" fill="#FFD2D6" fill-opacity="1" stroke="#B4021B" stroke-opacity="1"><path d="M 133.76 -198.25 C 133.76 -195.1 136.31 -192.54 139.46 -192.54 L 213.06 -192.54 C 216.21 -192.54 218.76 -195.1 218.76 -198.25 L 218.76 -245.11 C 218.76 -248.27 216.21 -250.82 213.06 -250.82 L 139.46 -250.82 C 136.31 -250.82 133.76 -248.27 133.76 -245.11 Z"></path></g><g color="#9B9B9B" fill="#EFF3FA" fill-opacity="1" stroke="#9B9B9B" stroke-opacity="1"><path d="M 256.19 -45.82 L 276.1 -25.9 L 341.67 -25.9 L 341.67 -90.98 L 321.75 -110.9 L 256.19 -110.9 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" stroke="#9B9B9B" stroke-opacity="1"><path d="M 341.67 -25.9 L 321.75 -45.82 L 256.19 -45.82" style="fill:none"></path></g><g color="#9B9B9B" fill="#9B9B9B" stroke="#9B9B9B" stroke-opacity="1"><path d="M 321.75 -45.82 L 321.75 -110.9" style="fill:none"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.3" stroke="#9013FE" stroke-opacity="0.7"><path d="M 268.91 -66.32 L 288.01 -47.22 L 292.54 -47.22 L 292.54 -51.77 L 273.44 -70.88 L 268.91 -70.88 Z"></path></g><g color="#9013FE" fill="#9013FE" stroke="#9013FE" stroke-opacity="0.7"><path d="M 292.54 -47.22 L 273.44 -66.32 L 268.91 -66.32" style="fill:none"></path></g><g color="#9013FE" fill="#9013FE" stroke="#9013FE" stroke-opacity="0.7"><path d="M 273.44 -66.32 L 273.44 -70.88" style="fill:none"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.3" stroke="#9013FE" stroke-opacity="0.7"><path d="M 284.47 -82.41 L 303.58 -63.3 L 308.11 -63.3 L 308.11 -67.86 L 289.01 -86.97 L 284.47 -86.97 Z"></path></g><g color="#9013FE" fill="#9013FE" stroke="#9013FE" stroke-opacity="0.7"><path d="M 308.11 -63.3 L 289.01 -82.41 L 284.47 -82.41" style="fill:none"></path></g><g color="#9013FE" fill="#9013FE" stroke="#9013FE" stroke-opacity="0.7"><path d="M 289.01 -82.41 L 289.01 -86.97" style="fill:none"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.3" stroke="#9013FE" stroke-opacity="0.7"><path d="M 297.45 -100.05 L 316.55 -80.95 L 321.08 -80.95 L 321.08 -85.5 L 301.98 -104.61 L 297.45 -104.61 Z"></path></g><g color="#9013FE" fill="#9013FE" stroke="#9013FE" stroke-opacity="0.7"><path d="M 321.08 -80.95 L 301.98 -100.05 L 297.45 -100.05" style="fill:none"></path></g><g color="#9013FE" fill="#9013FE" stroke="#9013FE" stroke-opacity="0.7"><path d="M 301.98 -100.05 L 301.98 -104.61" style="fill:none"></path></g><g fill="#808080" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 128.57 -94.47 h 89.16 v 45.49 h -89.16 Z" style="stroke:none"></path></g><g color="#4A90B4" fill="#EFF3FA" fill-opacity="1" stroke="#4A90B4" stroke-opacity="1"><path d="M 130.65 -56.38 C 130.65 -53.45 133.02 -51.06 135.97 -51.06 L 210.33 -51.06 C 213.26 -51.06 215.65 -53.45 215.65 -56.38 L 215.65 -87.06 C 215.65 -90.01 213.26 -92.39 210.33 -92.39 L 135.97 -92.39 C 133.02 -92.39 130.65 -90.01 130.65 -87.06 Z"></path></g><path d="M 206.85 -59.84" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 198.85 -67.84)"><foreignobject height="16" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="16" id="S2.F3.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/snow.png" width="16"/></foreignobject></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 218.84 -72.13 L 250.33 -72.13" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 247.25 -75.6 L 254.48 -72.13 L 247.25 -68.65 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 95.94 -72.13 L 123.84 -72.13" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 120.76 -75.6 L 127.99 -72.13 L 120.76 -68.65 Z"></path></g><path d="M 56.16 -71.74" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 19.66 -108.24)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S2.F3.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/000004.jpg" width="73"/></foreignobject></g><g color="#9013FE" fill="#9013FE" fill-opacity="1" stroke="#9013FE" stroke-opacity="1"><path d="M 66.26 -95.92 C 66.26 -95.35 66.73 -94.88 67.3 -94.88 C 67.87 -94.88 68.34 -95.35 68.34 -95.92 C 68.34 -96.49 67.87 -96.96 67.3 -96.96 C 66.73 -96.96 66.26 -96.49 66.26 -95.92 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="1" stroke="#9013FE" stroke-opacity="1"><path d="M 35.13 -69.94 C 35.13 -69.36 35.6 -68.9 36.17 -68.9 C 36.74 -68.9 37.2 -69.36 37.2 -69.94 C 37.2 -70.51 36.74 -70.97 36.17 -70.97 C 35.6 -70.97 35.13 -70.51 35.13 -69.94 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="1" stroke="#9013FE" stroke-opacity="1"><path d="M 50.7 -79.28 C 50.7 -78.7 51.16 -78.24 51.73 -78.24 C 52.3 -78.24 52.77 -78.7 52.77 -79.28 C 52.77 -79.85 52.3 -80.31 51.73 -80.31 C 51.16 -80.31 50.7 -79.85 50.7 -79.28 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 347.52 -72.13 L 375.65 -72.13" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 372.57 -75.6 L 379.8 -72.13 L 372.57 -68.65 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 459.95 -72.13 L 505.03 -72.13" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 501.95 -75.6 L 509.18 -72.13 L 501.95 -68.65 Z"></path></g><g fill="#808080" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 132.06 -235.95 h 89.17 v 45.49 h -89.17 Z" style="stroke:none"></path></g><g color="#4A90B4" fill="#EFF3FA" fill-opacity="1" stroke="#4A90B4" stroke-opacity="1"><path d="M 134.13 -197.87 C 134.13 -194.93 136.52 -192.54 139.46 -192.54 L 213.81 -192.54 C 216.76 -192.54 219.15 -194.93 219.15 -197.87 L 219.15 -228.55 C 219.15 -231.49 216.76 -233.87 213.81 -233.87 L 139.46 -233.87 C 136.52 -233.87 134.13 -231.49 134.13 -228.55 Z"></path></g><path d="M 209.96 -201.33" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 201.96 -209.33)"><foreignobject height="16" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="16" id="S2.F3.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/snow.png" width="16"/></foreignobject></g><path d="M 210.36 -242.79" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 202.36 -250.79)"><foreignobject height="16" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="16" id="S2.F3.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/fire.png" width="16"/></foreignobject></g><g fill="#808080" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 131.3 -354.08 h 89.16 v 62.43 h -89.16 Z" style="stroke:none"></path></g><g color="#B4021B" fill="#FBD2D6" fill-opacity="1" stroke="#B4021B" stroke-opacity="1"><path d="M 133.37 -299.43 C 133.37 -296.28 135.93 -293.72 139.08 -293.72 L 212.68 -293.72 C 215.83 -293.72 218.38 -296.28 218.38 -299.43 L 218.38 -346.3 C 218.38 -349.45 215.83 -352 212.68 -352 L 139.08 -352 C 135.93 -352 133.37 -349.45 133.37 -346.3 Z"></path></g><g fill="#808080" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 131.68 -337.13 h 89.16 v 45.49 h -89.16 Z" style="stroke:none"></path></g><g color="#4A90B4" fill="#EFF3FA" fill-opacity="1" stroke="#4A90B4" stroke-opacity="1"><path d="M 133.76 -299.06 C 133.76 -296.11 136.14 -293.72 139.08 -293.72 L 213.44 -293.72 C 216.38 -293.72 218.76 -296.11 218.76 -299.06 L 218.76 -329.73 C 218.76 -332.67 216.38 -335.06 213.44 -335.06 L 139.08 -335.06 C 136.14 -335.06 133.76 -332.67 133.76 -329.73 Z"></path></g><path d="M 209.96 -302.51" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 201.96 -310.51)"><foreignobject height="16" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="16" id="S2.F3.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/snow.png" width="16"/></foreignobject></g><path d="M 210.36 -344.31" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 202.36 -352.31)"><foreignobject height="16" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="16" id="S2.F3.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/fire.png" width="16"/></foreignobject></g><g color="#6A8CB2" fill="#6A8CB2" stroke="#6A8CB2" stroke-opacity="1" stroke-width="1.5pt"><path d="M 92.07 -283.41 L 127.41 -318.76" style="fill:none"></path></g><g fill="#6A8CB2" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 122.77 -319.04 L 130.34 -321.7 L 127.69 -314.13 Z"></path></g><g color="#EE9C85" fill="#EE9C85" stroke="#EE9C85" stroke-opacity="1" stroke-width="1.5pt"><path d="M 91.48 -259.72 L 127.48 -223.4" style="fill:none"></path></g><g fill="#EE9C85" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 127.77 -228.04 L 130.4 -220.45 L 122.84 -223.15 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 178.83 -287.11 L 178.83 -256.94" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 182.31 -260.02 L 178.83 -252.79 L 175.35 -260.02 Z"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 175.35 -284.03 L 178.83 -291.26 L 182.31 -284.03 Z"></path></g><g fill="#808080" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 376.6 -292.68 h 89.16 v 45.49 h -89.16 Z" style="stroke:none"></path></g><g color="#4A90B4" fill="#EFF3FA" fill-opacity="1" stroke="#4A90B4" stroke-opacity="1"><path d="M 378.67 -254.6 C 378.67 -251.66 381.05 -249.27 384 -249.27 L 458.35 -249.27 C 461.29 -249.27 463.68 -251.66 463.68 -254.6 L 463.68 -285.27 C 463.68 -288.22 461.29 -290.61 458.35 -290.61 L 384 -290.61 C 381.05 -290.61 378.67 -288.22 378.67 -285.27 Z"></path></g><path d="M 454.88 -258.05" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 446.88 -266.05)"><foreignobject height="16" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="16" id="S2.F3.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/snow.png" width="16"/></foreignobject></g><g fill="#808080" transform="matrix(1.0 0.0 0.0 1.0 1.04 -1.04)"><path d="M 261.75 -293.37 h 89.16 v 45.48 h -89.16 Z" style="stroke:none"></path></g><g color="#4A90B4" fill="#EFF3FA" fill-opacity="1" stroke="#4A90B4" stroke-opacity="1"><path d="M 263.82 -255.29 C 263.82 -252.35 266.21 -249.97 269.15 -249.97 L 343.5 -249.97 C 346.45 -249.97 348.83 -252.35 348.83 -255.29 L 348.83 -285.97 C 348.83 -288.91 346.45 -291.29 343.5 -291.29 L 269.15 -291.29 C 266.21 -291.29 263.82 -288.91 263.82 -285.97 Z"></path></g><path d="M 340.04 -258.75" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 332.04 -266.75)"><foreignobject height="16" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="16" id="S2.F3.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/snow.png" width="16"/></foreignobject></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 306.13 -305.64 L 306.13 -297.31" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 309.61 -300.39 L 306.13 -293.16 L 302.66 -300.39 Z"></path></g><path d="M 275.48 -183.12 C 275.48 -180.93 277.25 -179.15 279.45 -179.15 L 358.82 -179.15 C 361.01 -179.15 362.79 -180.93 362.79 -183.12 L 362.79 -195.03 C 362.79 -197.23 361.01 -199 358.82 -199 L 279.45 -199 C 277.25 -199 275.48 -197.23 275.48 -195.03 Z" style="fill:none"></path><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 279.63 -189.53 C 279.63 -186.65 281.95 -184.34 284.82 -184.34 C 287.68 -184.34 290.01 -186.65 290.01 -189.53 C 290.01 -192.39 287.68 -194.72 284.82 -194.72 C 281.95 -194.72 279.63 -192.39 279.63 -189.53 Z"></path></g><g color="#417505" fill="#417505" fill-opacity="0.5" stroke="#417505" stroke-opacity="1"><path d="M 293.74 -189.53 C 293.74 -186.65 296.07 -184.34 298.93 -184.34 C 301.8 -184.34 304.12 -186.65 304.12 -189.53 C 304.12 -192.39 301.8 -194.72 298.93 -194.72 C 296.07 -194.72 293.74 -192.39 293.74 -189.53 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 307.86 -189.53 C 307.86 -186.65 310.18 -184.34 313.04 -184.34 C 315.91 -184.34 318.23 -186.65 318.23 -189.53 C 318.23 -192.39 315.91 -194.72 313.04 -194.72 C 310.18 -194.72 307.86 -192.39 307.86 -189.53 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 321.97 -189.53 C 321.97 -186.65 324.29 -184.34 327.16 -184.34 C 330.02 -184.34 332.35 -186.65 332.35 -189.53 C 332.35 -192.39 330.02 -194.72 327.16 -194.72 C 324.29 -194.72 321.97 -192.39 321.97 -189.53 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 336.08 -189.53 C 336.08 -186.65 338.41 -184.34 341.27 -184.34 C 344.14 -184.34 346.46 -186.65 346.46 -189.53 C 346.46 -192.39 344.14 -194.72 341.27 -194.72 C 338.41 -194.72 336.08 -192.39 336.08 -189.53 Z"></path></g><g color="#417505" fill="#417505" fill-opacity="0.5" stroke="#417505" stroke-opacity="1"><path d="M 350.2 -189.53 C 350.2 -186.65 352.52 -184.34 355.39 -184.34 C 358.25 -184.34 360.57 -186.65 360.57 -189.53 C 360.57 -192.39 358.25 -194.72 355.39 -194.72 C 352.52 -194.72 350.2 -192.39 350.2 -189.53 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 365.16 -189.74 L 410.25 -189.74" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 407.17 -193.21 L 414.4 -189.74 L 407.17 -186.26 Z"></path></g><g color="#4A4A4A" fill="#F4F4F4" fill-opacity="1" stroke="#4A4A4A" stroke-dasharray="4.5pt,4.5pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 613.5 -28.3 C 613.5 -23.83 617.12 -20.2 621.61 -20.2 L 675.79 -20.2 C 680.26 -20.2 683.89 -23.83 683.89 -28.3 L 683.89 -394.56 C 683.89 -399.05 680.26 -402.68 675.79 -402.68 L 621.61 -402.68 C 617.12 -402.68 613.5 -399.05 613.5 -394.56 Z"></path></g><path d="M 647.14 -35.63" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 639.14 -43.63)"><foreignobject height="16" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="16" id="S2.F3.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/snow.png" width="16"/></foreignobject></g><path d="M 646.62 -89.1" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 638.62 -97.1)"><foreignobject height="16" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="16" id="S2.F3.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/fire.png" width="16"/></foreignobject></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 649.85 -144.21 h 13.88 v 13.92 h -13.88 Z" style="stroke:none"></path></g><g color="#417505" fill="#417505" fill-opacity="1" stroke="#417505" stroke-opacity="1" stroke-width="0.75pt"><path d="M 658.8 -132.37 L 658.21 -136.14 L 661.65 -137.75 L 657.9 -138.36 L 657.41 -142.13 L 655.68 -138.74 L 651.93 -139.46 L 654.63 -136.76 L 652.79 -133.42 L 656.19 -135.14 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 640.99 -144.21 h 13.88 v 13.92 h -13.88 Z" style="stroke:none"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1" stroke-width="0.75pt"><path d="M 649.94 -132.37 L 649.35 -136.14 L 652.79 -137.75 L 649.03 -138.36 L 648.55 -142.13 L 646.81 -138.74 L 643.07 -139.46 L 645.77 -136.76 L 643.93 -133.42 L 647.32 -135.14 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 632.14 -144.21 h 13.88 v 13.92 h -13.88 Z" style="stroke:none"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="1" stroke="#9013FE" stroke-opacity="1" stroke-width="0.75pt"><path d="M 641.08 -132.37 L 640.48 -136.14 L 643.94 -137.75 L 640.17 -138.36 L 639.69 -142.13 L 637.96 -138.74 L 634.22 -139.46 L 636.9 -136.76 L 635.07 -133.42 L 638.47 -135.14 Z"></path></g><g color="#EE9C85" fill="#EE9C85" stroke="#EE9C85" stroke-opacity="1" stroke-width="1.5pt"><path d="M 487.28 -254.6 L 463.68 -254.6" style="fill:none"></path></g><g fill="#EE9C85" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 484.19 -258.07 L 491.43 -254.6 L 484.19 -251.12 Z"></path></g><g color="#6A8CB2" fill="#6A8CB2" stroke="#6A8CB2" stroke-opacity="1" stroke-width="1.5pt"><path d="M 487.21 -285.27 L 463.68 -285.27" style="fill:none"></path></g><g fill="#6A8CB2" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 484.13 -288.75 L 491.37 -285.27 L 484.13 -281.8 Z"></path></g><g color="#EE9C85" fill="#EE9C85" stroke="#EE9C85" stroke-opacity="1" stroke-width="1.5pt"><path d="M 373.12 -254.95 L 349.52 -254.95" style="fill:none"></path></g><g fill="#EE9C85" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 370.04 -258.43 L 377.27 -254.95 L 370.04 -251.47 Z"></path></g><g color="#6A8CB2" fill="#6A8CB2" stroke="#6A8CB2" stroke-opacity="1" stroke-width="1.5pt"><path d="M 373.06 -285.63 L 349.52 -285.63" style="fill:none"></path></g><g fill="#6A8CB2" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 369.98 -289.1 L 377.21 -285.63 L 369.98 -282.15 Z"></path></g><g color="#808080" fill="#9013FE" fill-opacity="0.04" stroke="#808080" stroke-dasharray="3.0pt,3.0pt,3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 417.24 -193.46 C 417.24 -173.4 433.5 -157.14 453.56 -157.14 C 473.62 -157.14 489.88 -173.4 489.88 -193.46 C 489.88 -213.52 473.62 -229.78 453.56 -229.78 C 433.5 -229.78 417.24 -213.52 417.24 -193.46 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 460.96 -183.18 C 460.96 -181.17 462.58 -179.55 464.59 -179.55 C 466.59 -179.55 468.22 -181.17 468.22 -183.18 C 468.22 -185.19 466.59 -186.81 464.59 -186.81 C 462.58 -186.81 460.96 -185.19 460.96 -183.18 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 455.93 -164.24 C 455.93 -162.24 457.54 -160.61 459.56 -160.61 C 461.56 -160.61 463.19 -162.24 463.19 -164.24 C 463.19 -166.25 461.56 -167.87 459.56 -167.87 C 457.54 -167.87 455.93 -166.25 455.93 -164.24 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 439.53 -174.41 C 439.53 -172.41 441.15 -170.78 443.16 -170.78 C 445.16 -170.78 446.79 -172.41 446.79 -174.41 C 446.79 -176.42 445.16 -178.04 443.16 -178.04 C 441.15 -178.04 439.53 -176.42 439.53 -174.41 Z"></path></g><g color="#417505" fill="#417505" fill-opacity="0.5" stroke="#417505" stroke-opacity="1"><path d="M 462.52 -196.2 C 462.52 -194.2 464.13 -192.57 466.15 -192.57 C 468.15 -192.57 469.78 -194.2 469.78 -196.2 C 469.78 -198.22 468.15 -199.83 466.15 -199.83 C 464.13 -199.83 462.52 -198.22 462.52 -196.2 Z"></path></g><g color="#417505" fill="#417505" fill-opacity="0.5" stroke="#417505" stroke-opacity="1"><path d="M 476.97 -201.33 C 476.97 -199.32 478.6 -197.7 480.6 -197.7 C 482.61 -197.7 484.24 -199.32 484.24 -201.33 C 484.24 -203.33 482.61 -204.96 480.6 -204.96 C 478.6 -204.96 476.97 -203.33 476.97 -201.33 Z"></path></g><g color="#417505" fill="#417505" fill-opacity="0.5" stroke="#417505" stroke-opacity="1"><path d="M 454.42 -211.84 C 454.42 -209.84 456.04 -208.21 458.05 -208.21 C 460.06 -208.21 461.69 -209.84 461.69 -211.84 C 461.69 -213.84 460.06 -215.47 458.05 -215.47 C 456.04 -215.47 454.42 -213.84 454.42 -211.84 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 431.47 -194.56 C 431.47 -192.56 433.09 -190.93 435.1 -190.93 C 437.1 -190.93 438.73 -192.56 438.73 -194.56 C 438.73 -196.56 437.1 -198.19 435.1 -198.19 C 433.09 -198.19 431.47 -196.56 431.47 -194.56 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 443.22 -202.52 C 443.22 -200.51 444.85 -198.89 446.86 -198.89 C 448.87 -198.89 450.49 -200.51 450.49 -202.52 C 450.49 -204.52 448.87 -206.15 446.86 -206.15 C 444.85 -206.15 443.22 -204.52 443.22 -202.52 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 434.92 -215.66 C 434.92 -213.66 436.55 -212.03 438.55 -212.03 C 440.57 -212.03 442.19 -213.66 442.19 -215.66 C 442.19 -217.67 440.57 -219.29 438.55 -219.29 C 436.55 -219.29 434.92 -217.67 434.92 -215.66 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 422.47 -206.32 C 422.47 -204.32 424.1 -202.69 426.1 -202.69 C 428.11 -202.69 429.73 -204.32 429.73 -206.32 C 429.73 -208.33 428.11 -209.95 426.1 -209.95 C 424.1 -209.95 422.47 -208.33 422.47 -206.32 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 447.88 -180.32 h 14.53 v 12.45 h -14.53 Z" style="stroke:none"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="1" stroke="#9013FE" stroke-opacity="1"><path d="M 455.15 -169.95 L 460.34 -178.25 L 449.96 -178.25 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 462.83 -212.08 h 14.53 v 12.45 h -14.53 Z" style="stroke:none"></path></g><g color="#417505" fill="#417505" fill-opacity="1" stroke="#417505" stroke-opacity="1"><path d="M 470.09 -201.7 L 475.28 -210 L 464.9 -210 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 429.2 -210.83 h 14.53 v 12.45 h -14.53 Z" style="stroke:none"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1"><path d="M 436.47 -200.46 L 441.66 -208.76 L 431.28 -208.76 Z"></path></g><g color="#417505" fill="#417505" fill-opacity="0.5" stroke="#417505" stroke-opacity="1"><path d="M 470.4 -216.13 C 470.4 -214.12 472.02 -212.49 474.03 -212.49 C 476.04 -212.49 477.67 -214.12 477.67 -216.13 C 477.67 -218.14 476.04 -219.76 474.03 -219.76 C 472.02 -219.76 470.4 -218.14 470.4 -216.13 Z"></path></g><g color="#808080" fill="#9013FE" fill-opacity="0.04" stroke="#808080" stroke-dasharray="3.0pt,3.0pt,3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 524.23 -167.38 C 524.23 -163.25 527.58 -159.91 531.71 -159.91 L 578.33 -159.91 C 582.46 -159.91 585.8 -163.25 585.8 -167.38 L 585.8 -214.69 C 585.8 -218.83 582.46 -222.18 578.33 -222.18 L 531.71 -222.18 C 527.58 -222.18 524.23 -218.83 524.23 -214.69 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 530.56 -175.13 h 14.53 v 12.45 h -14.53 Z" style="stroke:none"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="1" stroke="#9013FE" stroke-opacity="1"><path d="M 537.83 -164.76 L 543.02 -173.06 L 532.64 -173.06 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 566.28 -195.83 h 12.9 v 12.95 h -12.9 Z" style="stroke:none"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="1" stroke="#9013FE" stroke-opacity="1" stroke-width="0.75pt"><path d="M 574.54 -184.95 L 574 -188.35 L 577.11 -189.8 L 573.72 -190.35 L 573.29 -193.75 L 571.73 -190.69 L 568.36 -191.33 L 570.79 -188.91 L 569.13 -185.9 L 572.19 -187.45 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 530.56 -193.71 h 14.53 v 12.45 h -14.53 Z" style="stroke:none"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1"><path d="M 537.83 -183.33 L 543.02 -191.64 L 532.64 -191.64 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 566.28 -174.92 h 12.9 v 12.94 h -12.9 Z" style="stroke:none"></path></g><g color="#417505" fill="#417505" fill-opacity="1" stroke="#417505" stroke-opacity="1" stroke-width="0.75pt"><path d="M 574.54 -164.05 L 574 -167.43 L 577.11 -168.9 L 573.72 -169.44 L 573.29 -172.84 L 571.73 -169.79 L 568.36 -170.43 L 570.79 -168 L 569.13 -165 L 572.19 -166.54 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 566.28 -217.68 h 12.9 v 12.94 h -12.9 Z" style="stroke:none"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1" stroke-width="0.75pt"><path d="M 574.54 -206.82 L 574 -210.21 L 577.11 -211.66 L 573.72 -212.21 L 573.29 -215.61 L 571.73 -212.56 L 568.36 -213.2 L 570.79 -210.77 L 569.13 -207.76 L 572.19 -209.32 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 530.98 -215.19 h 14.53 v 12.45 h -14.53 Z" style="stroke:none"></path></g><g color="#417505" fill="#417505" fill-opacity="1" stroke="#417505" stroke-opacity="1"><path d="M 538.24 -204.82 L 543.43 -213.12 L 533.05 -213.12 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" stroke="#9B9B9B" stroke-opacity="1" stroke-width="0.75pt"><path d="M 565.92 -206.87 L 544.05 -189.11" style="fill:none"></path></g><g color="#9B9B9B" fill="#9B9B9B" stroke="#9B9B9B" stroke-opacity="1" stroke-width="0.75pt"><path d="M 544.13 -208.95 L 565.92 -173.14" style="fill:none"></path></g><g color="#9B9B9B" fill="#9B9B9B" stroke="#9B9B9B" stroke-opacity="1" stroke-width="0.75pt"><path d="M 567.3 -188.53 L 543.5 -168.91" style="fill:none"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 493.85 -190.09 L 516.45 -190.09" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 513.37 -193.57 L 520.6 -190.09 L 513.37 -186.61 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 631.05 -212.92 h 14.53 v 12.45 h -14.53 Z" style="stroke:none"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="1" stroke="#9013FE" stroke-opacity="1"><path d="M 638.31 -202.54 L 643.5 -210.84 L 633.13 -210.84 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 641.43 -212.92 h 14.53 v 12.45 h -14.53 Z" style="stroke:none"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1"><path d="M 648.69 -202.54 L 653.88 -210.84 L 643.5 -210.84 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 0 0)"><path d="M 651.81 -212.92 h 14.53 v 12.45 h -14.53 Z" style="stroke:none"></path></g><g color="#417505" fill="#417505" fill-opacity="1" stroke="#417505" stroke-opacity="1"><path d="M 659.07 -202.54 L 664.26 -210.84 L 653.88 -210.84 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 631.69 -274.64 C 631.69 -272.63 633.32 -271 635.33 -271 C 637.33 -271 638.96 -272.63 638.96 -274.64 C 638.96 -276.64 637.33 -278.27 635.33 -278.27 C 633.32 -278.27 631.69 -276.64 631.69 -274.64 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="0.5" stroke="#4A90E2" stroke-opacity="1"><path d="M 643.71 -274.61 C 643.71 -272.6 645.34 -270.97 647.34 -270.97 C 649.36 -270.97 650.98 -272.6 650.98 -274.61 C 650.98 -276.61 649.36 -278.24 647.34 -278.24 C 645.34 -278.24 643.71 -276.61 643.71 -274.61 Z"></path></g><g color="#417505" fill="#417505" fill-opacity="0.5" stroke="#417505" stroke-opacity="1"><path d="M 656.36 -275.07 C 656.36 -273.07 657.98 -271.44 659.99 -271.44 C 662 -271.44 663.63 -273.07 663.63 -275.07 C 663.63 -277.08 662 -278.7 659.99 -278.7 C 657.98 -278.7 656.36 -277.08 656.36 -275.07 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 219.15 -197.87 C 233.59 -185.6 234.78 -187.58 273.04 -187.71" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 268.25 -191.76 L 276.69 -187.71 L 268.25 -183.67 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 552.08 -114.5 L 552.08 -153.25" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 548.6 -150.17 L 552.08 -157.4 L 555.55 -150.17 Z"></path></g><g fill="#000000" transform="matrix(1.0 0.0 0.0 1.0 2.08 -2.08)"><path d="M 7.73 -312.15 h 80.95 v 80.95 h -80.95 Z" style="stroke:none"></path></g><g color="#808080" fill="#808080" fill-opacity="1" stroke="#808080" stroke-opacity="1"><path d="M 11.88 -235.36 L 84.53 -235.36 L 84.53 -308 L 11.88 -308 Z"></path></g><path d="M 48.2 -271.68" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 11.7 -308.18)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S2.F3.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/input.png" width="73"/></foreignobject></g><path d="M 306.12 -344.32" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 267.62 -382.82)"><foreignobject height="77" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="77"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="77" id="S2.F3.1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/input.png" width="77"/></foreignobject></g><g color="#D0021B" fill="#D0021B" fill-opacity="1" stroke="#D0021B" stroke-opacity="1"><path d="M 637.31 -340.67 L 638.98 -340.67 L 638.98 -343.98 L 642.3 -343.98 L 642.3 -345.65 L 638.98 -345.65 L 638.98 -348.97 L 637.31 -348.97 L 637.31 -345.65 L 634 -345.65 L 634 -343.98 L 637.31 -343.98 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1"><path d="M 654.27 -340.67 L 655.93 -340.67 L 655.93 -343.98 L 659.25 -343.98 L 659.25 -345.65 L 655.93 -345.65 L 655.93 -348.97 L 654.27 -348.97 L 654.27 -345.65 L 650.94 -345.65 L 650.94 -343.98 L 654.27 -343.98 Z"></path></g><path d="M 649.08 -338.84 L 643.89 -351.3" style="fill:none"></path><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1"><path d="M 290.73 -348.1 C 294.39 -345.13 295.83 -344.57 297.01 -338.12" style="fill:none"></path></g><g fill="#F5A623" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 298.74 -339.04 L 297.48 -335.13 L 295.2 -338.55 Z"></path></g><path d="M 412.29 -343.98" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 373.79 -382.48)"><foreignobject height="77" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="77"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="77" id="S2.F3.1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/refined_mask.png" width="77"/></foreignobject></g><path d="M 564.06 -344.59" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 525.06 -383.59)"><foreignobject height="78" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="78"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="78" id="S2.F3.1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/init_mask.png" width="78"/></foreignobject></g><g color="#D0021B" fill="#D0021B" fill-opacity="1" stroke="#D0021B" stroke-opacity="1"><path d="M 560.12 -316.74 L 560.89 -316.74 L 560.89 -318.95 L 563.1 -318.95 L 563.1 -319.72 L 560.89 -319.72 L 560.89 -321.93 L 560.12 -321.93 L 560.12 -319.72 L 557.91 -319.72 L 557.91 -318.95 L 560.12 -318.95 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 529.52 -254.25 C 556.98 -254.25 565.91 -277.43 566.29 -299.68" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 562.46 -295.01 L 566.28 -303.55 L 570.55 -295.22 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 523.19 -345.92 L 459.16 -345.92" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 462.25 -342.44 L 455.01 -345.92 L 462.25 -349.4 Z"></path></g><g color="#D0021B" fill="#D0021B" stroke="#D0021B" stroke-opacity="1"><path d="M 373.75 -305.46 L 451.41 -305.46 L 451.41 -383.12 L 373.75 -383.12 Z" style="fill:none"></path></g><g color="#D0021B" fill="#D0021B" stroke="#D0021B" stroke-opacity="1"><path d="M 525.19 -305.73 L 602.84 -305.73 L 602.84 -383.39 L 525.19 -383.39 Z" style="fill:none"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1"><path d="M 543.51 -346.92 L 544.28 -346.92 L 544.28 -349.13 L 546.49 -349.13 L 546.49 -349.9 L 544.28 -349.9 L 544.28 -352.11 L 543.51 -352.11 L 543.51 -349.9 L 541.3 -349.9 L 541.3 -349.13 L 543.51 -349.13 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1"><path d="M 403.5 -327.8 L 404.27 -327.8 L 404.27 -330.01 L 406.48 -330.01 L 406.48 -330.78 L 404.27 -330.78 L 404.27 -332.99 L 403.5 -332.99 L 403.5 -330.78 L 401.29 -330.78 L 401.29 -330.01 L 403.5 -330.01 Z"></path></g><g color="#D0021B" fill="#D0021B" fill-opacity="1" stroke="#D0021B" stroke-opacity="1"><path d="M 409.37 -316.15 L 410.14 -316.15 L 410.14 -318.36 L 412.35 -318.36 L 412.35 -319.13 L 410.14 -319.13 L 410.14 -321.34 L 409.37 -321.34 L 409.37 -319.13 L 407.16 -319.13 L 407.16 -318.36 L 409.37 -318.36 Z"></path></g><g color="#D0021B" fill="#D0021B" fill-opacity="1" stroke="#D0021B" stroke-opacity="1"><path d="M 302.71 -316.85 L 303.48 -316.85 L 303.48 -319.06 L 305.69 -319.06 L 305.69 -319.83 L 303.48 -319.83 L 303.48 -322.04 L 302.71 -322.04 L 302.71 -319.83 L 300.5 -319.83 L 300.5 -319.06 L 302.71 -319.06 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1"><path d="M 296.83 -327.77 L 297.59 -327.77 L 297.59 -329.98 L 299.81 -329.98 L 299.81 -330.74 L 297.59 -330.74 L 297.59 -332.96 L 296.83 -332.96 L 296.83 -330.74 L 294.62 -330.74 L 294.62 -329.98 L 296.83 -329.98 Z"></path></g><g color="#4A90E2" fill="#4A90E2" fill-opacity="1" stroke="#4A90E2" stroke-opacity="1"><path d="M 287.22 -347.76 L 287.99 -347.76 L 287.99 -349.98 L 290.2 -349.98 L 290.2 -350.74 L 287.99 -350.74 L 287.99 -352.95 L 287.22 -352.95 L 287.22 -350.74 L 285.01 -350.74 L 285.01 -349.98 L 287.22 -349.98 Z"></path></g><g color="#6A8CB2" fill="#6A8CB2" stroke="#6A8CB2" stroke-opacity="1" stroke-width="1.5pt"><path d="M 258.76 -285.76 L 221.96 -321.18" style="fill:none"></path></g><g fill="#6A8CB2" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 258.96 -290.41 L 261.76 -282.89 L 254.14 -285.4 Z"></path></g><g color="#EE9C85" fill="#EE9C85" stroke="#EE9C85" stroke-opacity="1" stroke-width="1.5pt"><path d="M 259.39 -256.31 L 221.9 -219.94" style="fill:none"></path></g><g fill="#EE9C85" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 254.76 -256.66 L 262.37 -259.21 L 259.6 -251.67 Z"></path></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1" stroke-width="1.5pt"><path d="M 451.41 -305.46 C 463.18 -292.7 484.24 -307.91 500.53 -292.98" style="fill:none"></path></g><g fill="#F5A623" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 500.98 -299.12 L 503.32 -290.06 L 494.79 -293.9 Z"></path></g><g color="#808080" fill="#9013FE" fill-opacity="0.04" stroke="#808080" stroke-dasharray="3.0pt,3.0pt,3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 384.94 -69.8 C 384.94 -49.74 401.2 -33.48 421.26 -33.48 C 441.32 -33.48 457.59 -49.74 457.59 -69.8 C 457.59 -89.86 441.32 -106.12 421.26 -106.12 C 401.2 -106.12 384.94 -89.86 384.94 -69.8 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="0.5" stroke="#9B9B9B" stroke-opacity="1"><path d="M 413.65 -57.7 C 413.65 -55.69 415.28 -54.07 417.28 -54.07 C 419.29 -54.07 420.91 -55.69 420.91 -57.7 C 420.91 -59.7 419.29 -61.33 417.28 -61.33 C 415.28 -61.33 413.65 -59.7 413.65 -57.7 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 407.99 -43.67 C 407.99 -41.67 409.62 -40.04 411.62 -40.04 C 413.64 -40.04 415.26 -41.67 415.26 -43.67 C 415.26 -45.67 413.64 -47.3 411.62 -47.3 C 409.62 -47.3 407.99 -45.67 407.99 -43.67 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 405.23 -53.7 C 405.23 -51.69 406.85 -50.07 408.86 -50.07 C 410.87 -50.07 412.49 -51.69 412.49 -53.7 C 412.49 -55.71 410.87 -57.34 408.86 -57.34 C 406.85 -57.34 405.23 -55.71 405.23 -53.7 Z"></path></g><g color="#9013FE" fill="#9013FE" fill-opacity="0.5" stroke="#9013FE" stroke-opacity="1"><path d="M 395.48 -58.2 C 395.48 -56.2 397.09 -54.57 399.11 -54.57 C 401.11 -54.57 402.74 -56.2 402.74 -58.2 C 402.74 -60.2 401.11 -61.83 399.11 -61.83 C 397.09 -61.83 395.48 -60.2 395.48 -58.2 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="0.5" stroke="#9B9B9B" stroke-opacity="1"><path d="M 437.52 -62.19 C 437.52 -60.19 439.14 -58.56 441.15 -58.56 C 443.16 -58.56 444.78 -60.19 444.78 -62.19 C 444.78 -64.2 443.16 -65.83 441.15 -65.83 C 439.14 -65.83 437.52 -64.2 437.52 -62.19 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="0.5" stroke="#9B9B9B" stroke-opacity="1"><path d="M 448.25 -69.8 C 448.25 -67.8 449.87 -66.17 451.88 -66.17 C 453.88 -66.17 455.51 -67.8 455.51 -69.8 C 455.51 -71.81 453.88 -73.43 451.88 -73.43 C 449.87 -73.43 448.25 -71.81 448.25 -69.8 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="0.5" stroke="#9B9B9B" stroke-opacity="1"><path d="M 434.4 -81.57 C 434.4 -79.56 436.03 -77.94 438.03 -77.94 C 440.05 -77.94 441.67 -79.56 441.67 -81.57 C 441.67 -83.57 440.05 -85.2 438.03 -85.2 C 436.03 -85.2 434.4 -83.57 434.4 -81.57 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="0.5" stroke="#9B9B9B" stroke-opacity="1"><path d="M 438.91 -72.91 C 438.91 -70.91 440.53 -69.28 442.54 -69.28 C 444.54 -69.28 446.17 -70.91 446.17 -72.91 C 446.17 -74.93 444.54 -76.55 442.54 -76.55 C 440.53 -76.55 438.91 -74.93 438.91 -72.91 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="0.5" stroke="#9B9B9B" stroke-opacity="1"><path d="M 406.04 -77.42 C 406.04 -75.4 407.67 -73.79 409.67 -73.79 C 411.67 -73.79 413.3 -75.4 413.3 -77.42 C 413.3 -79.42 411.67 -81.05 409.67 -81.05 C 407.67 -81.05 406.04 -79.42 406.04 -77.42 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="0.5" stroke="#9B9B9B" stroke-opacity="1"><path d="M 417.8 -85.37 C 417.8 -83.36 419.43 -81.74 421.43 -81.74 C 423.44 -81.74 425.06 -83.36 425.06 -85.37 C 425.06 -87.38 423.44 -89 421.43 -89 C 419.43 -89 417.8 -87.38 417.8 -85.37 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="0.5" stroke="#9B9B9B" stroke-opacity="1"><path d="M 409.5 -98.52 C 409.5 -96.51 411.12 -94.88 413.13 -94.88 C 415.14 -94.88 416.76 -96.51 416.76 -98.52 C 416.76 -100.52 415.14 -102.15 413.13 -102.15 C 411.12 -102.15 409.5 -100.52 409.5 -98.52 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="0.5" stroke="#9B9B9B" stroke-opacity="1"><path d="M 407.77 -87.8 C 407.77 -85.78 409.39 -84.16 411.41 -84.16 C 413.41 -84.16 415.04 -85.78 415.04 -87.8 C 415.04 -89.8 413.41 -91.43 411.41 -91.43 C 409.39 -91.43 407.77 -89.8 407.77 -87.8 Z"></path></g><g color="#9B9B9B" fill="#9B9B9B" fill-opacity="0.5" stroke="#9B9B9B" stroke-opacity="1"><path d="M 397.04 -89.18 C 397.04 -87.17 398.67 -85.54 400.67 -85.54 C 402.69 -85.54 404.31 -87.17 404.31 -89.18 C 404.31 -91.18 402.69 -92.81 400.67 -92.81 C 398.67 -92.81 397.04 -91.18 397.04 -89.18 Z"></path></g><path d="M 484.57 -69.01" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 462.6 -67.46)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 96.825)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 101.63)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Cluster</text></g></g></g></g><path d="M 6.9 -392.4" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 8.46 -660.92)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 530.12)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 533.58)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="164.16"><span class="ltx_text ltx_font_bold" id="S2.F3.1.pic1.17.17.17.1.1.1.1.1">(b) SAM with Self-training</span></foreignobject></g></g></g></g><path d="M 176.26 -213.21" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 150.86 -369.15)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 298.08)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 302.92)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="27.6" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="50.78">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.18.18.18.1.1.1.1.1" style="width:36.7pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.18.18.18.1.1.1.1.1.1">Image</span>
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.18.18.18.1.1.1.1.1.2">Encoder</span>
</span></foreignobject></g></g></g></g><path d="M 173.14 -71.72" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 147.75 -133.33)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 109.42)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 114.27)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="27.6" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="50.78">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.19.19.19.1.1.1.1.1" style="width:36.7pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.19.19.19.1.1.1.1.1.1">Image</span>
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.19.19.19.1.1.1.1.1.2">Encoder</span>
</span></foreignobject></g></g></g></g><path d="M 177.81 -243.31" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 158.29 -413.81)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 332.71)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 337.56)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="16.6" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.05">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.20.20.20.1.1.1.1.1" style="width:28.2pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.20.20.20.1.1.1.1.1.1">LoRA</span>
</span></foreignobject></g></g></g></g><path d="M 176.26 -314.39" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 150.86 -537.79)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 432.99)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 437.83)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="27.6" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="50.78">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.21.21.21.1.1.1.1.1" style="width:36.7pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.21.21.21.1.1.1.1.1.1">Image</span>
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.21.21.21.1.1.1.1.1.2">Encoder</span>
</span></foreignobject></g></g></g></g><path d="M 177.13 -344.49" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 157.6 -582.45)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 467.62)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 472.47)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="16.6" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.05">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.22.22.22.1.1.1.1.1" style="width:28.2pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.22.22.22.1.1.1.1.1.1">LoRA</span>
</span></foreignobject></g></g></g></g><path d="M 180.9 -272.03" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 182.46 -458.19)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 367.515)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 372.32)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Shared</text></g></g></g></g><path d="M 306.87 -392.28" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 262.42 -659.87)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 529.105)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 532.5)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Point Prompts</text></g></g></g></g><path d="M 318.17 -221.04" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 275.01 -219.48)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 300.86)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 304.32)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="86.33"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.F3.1.pic1.23.23.23.1.1.1.1.1">Memory Bank</span></foreignobject></g></g></g></g><path d="M 389.79 -186.62" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 367.82 -185.07)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 253.635)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 258.44)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Cluster</text></g></g></g></g><path d="M 241.54 -188.36" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 215.5 -186.8)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 257.215)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 260.6)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Enqueue</text></g></g></g></g><path d="M 494.11 -244.04" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 495.66 -582.83)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 331.31)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 337.23)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="11.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="15.48"><math alttext="\displaystyle\mathcal{M}^{t}" class="ltx_Math" display="inline" id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msup id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">ℳ</mi><mi id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">ℳ</ci><ci id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\displaystyle\mathcal{M}^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.1.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">caligraphic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></foreignobject></g></g></g></g><path d="M 494.11 -273.44" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 495.66 -650.71)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 370.15)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 375.71)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="11.12" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.32"><math alttext="\displaystyle\mathcal{M}^{s}" class="ltx_Math" display="inline" id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msup id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">ℳ</mi><mi id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">ℳ</ci><ci id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\displaystyle\mathcal{M}^{s}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.1.pic1.16.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">caligraphic_M start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math></foreignobject></g></g></g></g><path d="M 306.33 -270.63" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 280.94 -464.85)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 374.64)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 379.48)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="27.6" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="50.78">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.24.24.24.1.1.1.1.1" style="width:36.7pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.24.24.24.1.1.1.1.1.1">Prompt</span>
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.24.24.24.1.1.1.1.1.2">Encoder</span>
</span></foreignobject></g></g></g></g><path d="M 421.17 -269.94" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 395.39 -463.69)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 373.71)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 378.55)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="27.6" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="51.57">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.25.25.25.1.1.1.1.1" style="width:37.3pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.25.25.25.1.1.1.1.1.1">Mask</span>
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.25.25.25.1.1.1.1.1.2">Decoder</span>
</span></foreignobject></g></g></g></g><path d="M 56.74 -120.22" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 40.02 -206.43)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 166.355)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 169.75)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Input</text></g></g></g></g><path d="M 295.95 -120.22" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 257.79 -206.43)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 166.355)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 169.75)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Feature map</text></g></g></g></g><path d="M 649.73 -166.12" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 614.9 -291.46)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 236.085)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 240.93)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="29.19" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="69.67">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.26.26.26.1.1.1.1.1" style="width:50.4pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.26.26.26.1.1.1.1.1.1">Target</span>
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.26.26.26.1.1.1.1.1.2">prototypes</span>
</span></foreignobject></g></g></g></g><path d="M 648.69 -234.47" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 613.86 -405.39)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 327.225)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 332.07)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="29.19" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="69.67">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.27.27.27.1.1.1.1.1" style="width:50.4pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.27.27.27.1.1.1.1.1.1">Predicted</span>
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.27.27.27.1.1.1.1.1.2">prototypes</span>
</span></foreignobject></g></g></g></g><path d="M 647.65 -302.83" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 619.49 -519.68)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 418.74)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 423.58)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="29.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="56.33">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.28.28.28.1.1.1.1.1" style="width:40.7pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.28.28.28.1.1.1.1.1.1">Feature</span>
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.28.28.28.1.1.1.1.1.2">points</span>
</span></foreignobject></g></g></g></g><path d="M 646.62 -53.79" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 626.51 -94.37)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 76.44)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 81.18)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Frozen</text></g></g></g></g><path d="M 648.69 -107.1" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 623.11 -184.57)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 148.865)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 152.26)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Training</text></g></g></g></g><path d="M 426.71 -120.22" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 383.13 -206.43)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 166.355)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 169.75)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Feature points</text></g></g></g></g><path d="M 554.1 -242.83" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 525.66 -241.27)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 329.92)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 333.38)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="57.27"><span class="ltx_text ltx_font_bold" id="S2.F3.1.pic1.29.29.29.1.1.1.1.1" style="color:#D1031C;">Matching</span></foreignobject></g></g></g></g><path d="M 647.65 -375.33" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 616.74 -640.15)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 515.035)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 519.88)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="29.19" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="61.82">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.30.30.30.1.1.1.1.1" style="width:44.7pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.30.30.30.1.1.1.1.1.1">Pos/Neg</span>
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.30.30.30.1.1.1.1.1.2">prompts</span>
</span></foreignobject></g></g></g></g><path d="M 489.1 -342.81" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 454.88 -341.25)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 461.885)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 466.69)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="68.45"><span class="ltx_text ltx_font_bold" id="S2.F3.1.pic1.31.31.31.1.1.1.1.1" style="color:#D1031C;">Calibration</span></foreignobject></g></g></g></g><path d="M 562.08 -392.28" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 525.91 -658.6)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 527.845)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 532.65)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Initial mask</text></g></g></g></g><path d="M 412.64 -392.28" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 371.76 -658.6)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 527.845)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 532.65)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Refined mask</text></g></g></g></g><path d="M 176.58 -189.56" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 153.11 -188)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 257.555)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 262.36)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="46.93"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.F3.1.pic1.32.32.32.1.1.1.1.1" style="color:#ED9C85;">Teacher</span></foreignobject></g></g></g></g><path d="M 176.58 -354.57" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 152.94 -838.49)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 477.555)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 482.36)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="47.28"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.F3.1.pic1.33.33.33.1.1.1.1.1" style="color:#6B8CB3;">Student</span></foreignobject></g></g></g></g><path d="M 50.51 -312.38" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 33.79 -742.59)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 422.575)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 425.97)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Input</text></g></g></g></g><path d="M 110.94 -240.09" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(0.70401 0.71019 -0.71019 0.70401 219.14 -378.83)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 334.58)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 339.42)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="28.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="44.72">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.34.34.34.1.1.1.1.1" style="width:32.3pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.34.34.34.1.1.1.1.1.1"><span class="ltx_text" id="S2.F3.1.pic1.34.34.34.1.1.1.1.1.1.1" style="font-size:90%;color:#ED9C85;">Strong 
<br class="ltx_break"/><span class="ltx_text" id="S2.F3.1.pic1.34.34.34.1.1.1.1.1.1.1.1">Aug.</span></span></span>
</span></foreignobject></g></g></g></g><path d="M 111.21 -304.63" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(0.72008 -0.6939 0.6939 0.72008 -53.98 -447.56)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 420.63)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 425.47)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="28.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.53">
<span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S2.F3.1.pic1.35.35.35.1.1.1.1.1" style="width:28.6pt;">
<span class="ltx_p ltx_align_center" id="S2.F3.1.pic1.35.35.35.1.1.1.1.1.1"><span class="ltx_text" id="S2.F3.1.pic1.35.35.35.1.1.1.1.1.1.1" style="font-size:90%;color:#6B8CB3;">Weak 
<br class="ltx_break"/><span class="ltx_text" id="S2.F3.1.pic1.35.35.35.1.1.1.1.1.1.1.1">Aug.</span></span></span>
</span></foreignobject></g></g></g></g><path d="M 488.57 -301.13" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 462.58 -715.13)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 406.975)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 410.02)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="10.93" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="51.65"><span class="ltx_text" id="S2.F3.1.pic1.36.36.36.1.1.1.1.1" style="font-size:90%;">Supervise</span></foreignobject></g></g></g></g><path d="M 7.05 -139.25" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 8.6 -239)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 192.58)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 196.04)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="205.31"><span class="ltx_text ltx_font_bold" id="S2.F3.1.pic1.37.37.37.1.1.1.1.1">(a) Offline Prototypes Generation</span></foreignobject></g></g></g></g><path d="M 90.41 -38.53" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 38.13 -99.03)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 55.16)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 58.94)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="7.56" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="51.03"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.F3.1.pic1.38.38.38.1.1.1.1.1" style="font-size:80%;color:#FAFAFA;">GT Points</span></foreignobject></g></g></g></g></g></svg>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Overall architecture of the proposed PointSAM. (a) Offline prototype generation. First, feature points are obtained from the target domain dataset using the encoder of the frozen Source SAM model, and then clustering is applied to these features to obtain the target domain prototypes. (b) SAM with self-training. The training images undergo strong augmentation and weak augmentation, and are then processed through two encoders with shared weights: the teacher and the student. The original layers of the encoder are frozen, and Low-Rank Adaptation (LoRA) is used for fine-tuning. Calibration refers to Negative Prompt Calibration, which is used to obtain refined masks by adjusting the negative prompts. Matching refers to Hungarian matching, which is used to align predicted prototypes with target prototypes.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS3.5.1.1">II-C</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS3.6.2">Self-Training</span>
</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Self-training is widely used in fields such as semi-supervised learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">48</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">19</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>]</cite> and domain adaptation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">20</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib50" title=""><span class="ltx_text" style="font-size:90%;">50</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib51" title=""><span class="ltx_text" style="font-size:90%;">51</span></a>]</cite>. This is due to its ability to progressively assign pseudo-labels to unlabeled data, thereby enhancing the training of labeled data. This iterative process not only leverages the information present in the unlabeled data but also mitigates overfitting to the limited labeled data. However, in the absence of labeled data, self-training often falls into <span class="ltx_text ltx_font_italic" id="S2.SS3.p1.1.1">confirmation bias<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.SS3.p1.1.1.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib52" title=""><span class="ltx_text" style="font-size:90%;">52</span></a><span class="ltx_text ltx_font_upright" id="S2.SS3.p1.1.1.2.2">]</span></cite></span>. This occurs because the model may continually reinforce its own incorrect predictions during the generation of pseudo-labels, especially when the initial pseudo-label quality is low. This bias can cause the model to gradually deviate from the correct decision boundary, ultimately affecting the overall performance of the model. There are two main approaches to address this issue: one is to use feature alignment <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">23</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib25" title=""><span class="ltx_text" style="font-size:90%;">25</span></a>]</cite>, and the other is to apply logit constraints <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">20</span></a>]</cite> to regularize self-training. For example, STFAR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">23</span></a>]</cite> uses instance-level and image-level features to align the features of the source and target domains. WeSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite> uses a frozen source domain network as the anchor network to regularize the target teacher and student models.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">Although these methods can mitigate error accumulation in self-training, we find the following shortcomings: 1) Feature alignment methods require the use of features from target data. Due to the large scale of SAM’s pre-training data, obtaining features from the target data is unrealistic. 2) Logits-based methods often rely on the predicted logits, but if the source model cannot provide accurate predictions, these methods will not yield good results. In our work, we directly use the features from a frozen source model on the target data as prototypes to regularize self-training. Furthermore, we only select embeddings corresponding to the labeled points from the encoder’s extracted features, thus avoiding the issue of excessive logit prediction bias.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS4.5.1.1">II-D</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS4.6.2">Recognition in Remote Sensing Images</span>
</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">Remote sensing images (RSIs) are captured by airborne or satellite sensors to observe and analyze the Earth’s surface. These images provide critical information for a wide range of applications, including environmental monitoring <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib53" title=""><span class="ltx_text" style="font-size:90%;">53</span></a>]</cite>, urban planning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib54" title=""><span class="ltx_text" style="font-size:90%;">54</span></a>]</cite>, disaster management <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib55" title=""><span class="ltx_text" style="font-size:90%;">55</span></a>]</cite>, and military operations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib56" title=""><span class="ltx_text" style="font-size:90%;">56</span></a>]</cite>. A key characteristic of RSIs is their overhead perspective, typically categorized into optical images and Synthetic Aperture Radar (SAR) images. The objects detected in these images often exhibit significant scale variations and dense distributions. Existing methods address these challenges through feature processing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib57" title=""><span class="ltx_text" style="font-size:90%;">57</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib58" title=""><span class="ltx_text" style="font-size:90%;">58</span></a>]</cite>, loss function design <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib59" title=""><span class="ltx_text" style="font-size:90%;">59</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib60" title=""><span class="ltx_text" style="font-size:90%;">60</span></a>]</cite>, and post-processing stages <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib61" title=""><span class="ltx_text" style="font-size:90%;">61</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib62" title=""><span class="ltx_text" style="font-size:90%;">62</span></a>]</cite>. However, these approaches are primarily tailored for object counting and detection tasks, with interactive segmentation remaining relatively unexplored. In our case, SAM often struggles to segment dense objects, especially when only points are used as prompts. If the positive prompt is not well-annotated, the predicted mask may become confused with the surrounding foreground. Negative prompts can help mitigate this issue, but selecting the correct negative prompt remains challenging. Therefore, we propose using network-adaptive learned negative prompts to calibrate the predicted masks.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Methodology</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.5.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.6.2">Preliminary</span>
</h3>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS1.SSS1.5.1.1">III-A</span>1 </span>Segment Anything Model</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.6">SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a>]</cite> mainly consists of three components: an image encoder <math alttext="\Phi_{\text{img}}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.1.m1.1"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><msub id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.1.1.2" mathvariant="normal" xref="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml">Φ</mi><mtext id="S3.SS1.SSS1.p1.1.m1.1.1.3" xref="S3.SS1.SSS1.p1.1.m1.1.1.3a.cmml">img</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><apply id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.2">Φ</ci><ci id="S3.SS1.SSS1.p1.1.m1.1.1.3a.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.3"><mtext id="S3.SS1.SSS1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS1.p1.1.m1.1.1.3">img</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">\Phi_{\text{img}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.1.m1.1d">roman_Φ start_POSTSUBSCRIPT img end_POSTSUBSCRIPT</annotation></semantics></math>, a prompt encoder <math alttext="\Phi_{\text{prompt}}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.2.m2.1"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><msub id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS1.p1.2.m2.1.1.2" mathvariant="normal" xref="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml">Φ</mi><mtext id="S3.SS1.SSS1.p1.2.m2.1.1.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.3a.cmml">prompt</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><apply id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.2">Φ</ci><ci id="S3.SS1.SSS1.p1.2.m2.1.1.3a.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.3"><mtext id="S3.SS1.SSS1.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS1.p1.2.m2.1.1.3">prompt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">\Phi_{\text{prompt}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.2.m2.1d">roman_Φ start_POSTSUBSCRIPT prompt end_POSTSUBSCRIPT</annotation></semantics></math>, and a mask decoder <math alttext="\Phi_{\text{mask}}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.3.m3.1"><semantics id="S3.SS1.SSS1.p1.3.m3.1a"><msub id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.1.1.2" mathvariant="normal" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml">Φ</mi><mtext id="S3.SS1.SSS1.p1.3.m3.1.1.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3a.cmml">mask</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.1b"><apply id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2">Φ</ci><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3a.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3"><mtext id="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS1.p1.3.m3.1.1.3">mask</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.1c">\Phi_{\text{mask}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.3.m3.1d">roman_Φ start_POSTSUBSCRIPT mask end_POSTSUBSCRIPT</annotation></semantics></math>. The image encoder is based on the Vision Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib63" title=""><span class="ltx_text" style="font-size:90%;">63</span></a>]</cite> and extracts the input image as image embeddings. The prompt encoder is used to encode various types of prompts <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.4.m4.1"><semantics id="S3.SS1.SSS1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.4.m4.1.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.4.m4.1b"><ci id="S3.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.4.m4.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.4.m4.1d">caligraphic_P</annotation></semantics></math>, generally including points, boxes, masks, and text. There are two types of point prompts: positive prompts and negative prompts. Positive prompts are used to refer to the foreground, while negative prompts are used to refer to the background. The mask decoder is used to combine the outputs of the image encoder and the prompt encoder to generate the final mask predictions <math alttext="\mathcal{M}_{pred}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.5.m5.1"><semantics id="S3.SS1.SSS1.p1.5.m5.1a"><msub id="S3.SS1.SSS1.p1.5.m5.1.1" xref="S3.SS1.SSS1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.5.m5.1.1.2" xref="S3.SS1.SSS1.p1.5.m5.1.1.2.cmml">ℳ</mi><mrow id="S3.SS1.SSS1.p1.5.m5.1.1.3" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.5.m5.1.1.3.2" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.2.cmml">p</mi><mo id="S3.SS1.SSS1.p1.5.m5.1.1.3.1" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS1.p1.5.m5.1.1.3.3" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.3.cmml">r</mi><mo id="S3.SS1.SSS1.p1.5.m5.1.1.3.1a" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS1.p1.5.m5.1.1.3.4" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.4.cmml">e</mi><mo id="S3.SS1.SSS1.p1.5.m5.1.1.3.1b" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS1.p1.5.m5.1.1.3.5" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.5.m5.1b"><apply id="S3.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.2">ℳ</ci><apply id="S3.SS1.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.3"><times id="S3.SS1.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS1.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.2">𝑝</ci><ci id="S3.SS1.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.3">𝑟</ci><ci id="S3.SS1.SSS1.p1.5.m5.1.1.3.4.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.4">𝑒</ci><ci id="S3.SS1.SSS1.p1.5.m5.1.1.3.5.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.5.m5.1c">\mathcal{M}_{pred}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.5.m5.1d">caligraphic_M start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math>. Given an input image <math alttext="\mathcal{I}_{img}\in\mathbb{R}^{C\times H\times W}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.6.m6.1"><semantics id="S3.SS1.SSS1.p1.6.m6.1a"><mrow id="S3.SS1.SSS1.p1.6.m6.1.1" xref="S3.SS1.SSS1.p1.6.m6.1.1.cmml"><msub id="S3.SS1.SSS1.p1.6.m6.1.1.2" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.6.m6.1.1.2.2" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.2.cmml">ℐ</mi><mrow id="S3.SS1.SSS1.p1.6.m6.1.1.2.3" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.cmml"><mi id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.2" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.2.cmml">i</mi><mo id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.1" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.3" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.3.cmml">m</mi><mo id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.1a" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.4" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.4.cmml">g</mi></mrow></msub><mo id="S3.SS1.SSS1.p1.6.m6.1.1.1" xref="S3.SS1.SSS1.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS1.p1.6.m6.1.1.3" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.6.m6.1.1.3.2" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS1.p1.6.m6.1.1.3.3" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3.cmml"><mi id="S3.SS1.SSS1.p1.6.m6.1.1.3.3.2" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3.2.cmml">C</mi><mo id="S3.SS1.SSS1.p1.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS1.p1.6.m6.1.1.3.3.3" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3.3.cmml">H</mi><mo id="S3.SS1.SSS1.p1.6.m6.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS1.p1.6.m6.1.1.3.3.4" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3.4.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.6.m6.1b"><apply id="S3.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1"><in id="S3.SS1.SSS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.1"></in><apply id="S3.SS1.SSS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.2">ℐ</ci><apply id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3"><times id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.1"></times><ci id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.2">𝑖</ci><ci id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.3">𝑚</ci><ci id="S3.SS1.SSS1.p1.6.m6.1.1.2.3.4.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.2.3.4">𝑔</ci></apply></apply><apply id="S3.SS1.SSS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3"><times id="S3.SS1.SSS1.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3.1"></times><ci id="S3.SS1.SSS1.p1.6.m6.1.1.3.3.2.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3.2">𝐶</ci><ci id="S3.SS1.SSS1.p1.6.m6.1.1.3.3.3.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3.3">𝐻</ci><ci id="S3.SS1.SSS1.p1.6.m6.1.1.3.3.4.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1.3.3.4">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.6.m6.1c">\mathcal{I}_{img}\in\mathbb{R}^{C\times H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.6.m6.1d">caligraphic_I start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C × italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math>, the entire process can be simplified as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{M}_{pred}=\Phi_{\text{mask}}(\Phi_{\text{img}}(\mathcal{I}_{img}),%
\Phi_{\text{prompt}}(\mathcal{P}))." class="ltx_Math" display="block" id="S3.E1.m1.2"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.4" xref="S3.E1.m1.2.2.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.4.2" xref="S3.E1.m1.2.2.1.1.4.2.cmml">ℳ</mi><mrow id="S3.E1.m1.2.2.1.1.4.3" xref="S3.E1.m1.2.2.1.1.4.3.cmml"><mi id="S3.E1.m1.2.2.1.1.4.3.2" xref="S3.E1.m1.2.2.1.1.4.3.2.cmml">p</mi><mo id="S3.E1.m1.2.2.1.1.4.3.1" xref="S3.E1.m1.2.2.1.1.4.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.4.3.3" xref="S3.E1.m1.2.2.1.1.4.3.3.cmml">r</mi><mo id="S3.E1.m1.2.2.1.1.4.3.1a" xref="S3.E1.m1.2.2.1.1.4.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.4.3.4" xref="S3.E1.m1.2.2.1.1.4.3.4.cmml">e</mi><mo id="S3.E1.m1.2.2.1.1.4.3.1b" xref="S3.E1.m1.2.2.1.1.4.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.4.3.5" xref="S3.E1.m1.2.2.1.1.4.3.5.cmml">d</mi></mrow></msub><mo id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml"><msub id="S3.E1.m1.2.2.1.1.2.4" xref="S3.E1.m1.2.2.1.1.2.4.cmml"><mi id="S3.E1.m1.2.2.1.1.2.4.2" mathvariant="normal" xref="S3.E1.m1.2.2.1.1.2.4.2.cmml">Φ</mi><mtext id="S3.E1.m1.2.2.1.1.2.4.3" xref="S3.E1.m1.2.2.1.1.2.4.3a.cmml">mask</mtext></msub><mo id="S3.E1.m1.2.2.1.1.2.3" xref="S3.E1.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml"><mo id="S3.E1.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml">Φ</mi><mtext id="S3.E1.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.3a.cmml">img</mtext></msub><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">ℐ</mi><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">m</mi><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.4" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.4.cmml">g</mi></mrow></msub><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.1.1.2.2.2.4" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">,</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.cmml"><msub id="S3.E1.m1.2.2.1.1.2.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2" mathvariant="normal" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.cmml">Φ</mi><mtext id="S3.E1.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.3a.cmml">prompt</mtext></msub><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.1" xref="S3.E1.m1.2.2.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.cmml"><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S3.E1.m1.2.2.1.1.2.2.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝒫</mi><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.2" stretchy="false" xref="S3.E1.m1.2.2.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.1.1.2.2.2.5" stretchy="false" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.2.2.1.2" lspace="0em" xref="S3.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1"><eq id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3"></eq><apply id="S3.E1.m1.2.2.1.1.4.cmml" xref="S3.E1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.4.1.cmml" xref="S3.E1.m1.2.2.1.1.4">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.4.2.cmml" xref="S3.E1.m1.2.2.1.1.4.2">ℳ</ci><apply id="S3.E1.m1.2.2.1.1.4.3.cmml" xref="S3.E1.m1.2.2.1.1.4.3"><times id="S3.E1.m1.2.2.1.1.4.3.1.cmml" xref="S3.E1.m1.2.2.1.1.4.3.1"></times><ci id="S3.E1.m1.2.2.1.1.4.3.2.cmml" xref="S3.E1.m1.2.2.1.1.4.3.2">𝑝</ci><ci id="S3.E1.m1.2.2.1.1.4.3.3.cmml" xref="S3.E1.m1.2.2.1.1.4.3.3">𝑟</ci><ci id="S3.E1.m1.2.2.1.1.4.3.4.cmml" xref="S3.E1.m1.2.2.1.1.4.3.4">𝑒</ci><ci id="S3.E1.m1.2.2.1.1.4.3.5.cmml" xref="S3.E1.m1.2.2.1.1.4.3.5">𝑑</ci></apply></apply><apply id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"><times id="S3.E1.m1.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.3"></times><apply id="S3.E1.m1.2.2.1.1.2.4.cmml" xref="S3.E1.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.4.1.cmml" xref="S3.E1.m1.2.2.1.1.2.4">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.4.2.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2">Φ</ci><ci id="S3.E1.m1.2.2.1.1.2.4.3a.cmml" xref="S3.E1.m1.2.2.1.1.2.4.3"><mtext id="S3.E1.m1.2.2.1.1.2.4.3.cmml" mathsize="70%" xref="S3.E1.m1.2.2.1.1.2.4.3">mask</mtext></ci></apply><interval closure="open" id="S3.E1.m1.2.2.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2"><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1"><times id="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.2">Φ</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.3.3a.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.3"><mtext id="S3.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.3">img</mtext></ci></apply><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2">ℐ</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3"><times id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝑚</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.4">𝑔</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2"><times id="S3.E1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.1"></times><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2">Φ</ci><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.3a.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.3"><mtext id="S3.E1.m1.2.2.1.1.2.2.2.2.2.3.cmml" mathsize="70%" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.3">prompt</mtext></ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝒫</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\mathcal{M}_{pred}=\Phi_{\text{mask}}(\Phi_{\text{img}}(\mathcal{I}_{img}),%
\Phi_{\text{prompt}}(\mathcal{P})).</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.2d">caligraphic_M start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT = roman_Φ start_POSTSUBSCRIPT mask end_POSTSUBSCRIPT ( roman_Φ start_POSTSUBSCRIPT img end_POSTSUBSCRIPT ( caligraphic_I start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT ) , roman_Φ start_POSTSUBSCRIPT prompt end_POSTSUBSCRIPT ( caligraphic_P ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p2">
<p class="ltx_p" id="S3.SS1.SSS1.p2.1">In the training process of SAM, ground truth masks <math alttext="\mathcal{M}_{gt}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.1.m1.1"><semantics id="S3.SS1.SSS1.p2.1.m1.1a"><msub id="S3.SS1.SSS1.p2.1.m1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p2.1.m1.1.1.2" xref="S3.SS1.SSS1.p2.1.m1.1.1.2.cmml">ℳ</mi><mrow id="S3.SS1.SSS1.p2.1.m1.1.1.3" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS1.p2.1.m1.1.1.3.2" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.2.cmml">g</mi><mo id="S3.SS1.SSS1.p2.1.m1.1.1.3.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS1.p2.1.m1.1.1.3.3" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.1.m1.1b"><apply id="S3.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.2">ℳ</ci><apply id="S3.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3"><times id="S3.SS1.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.1"></times><ci id="S3.SS1.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.2">𝑔</ci><ci id="S3.SS1.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.1.m1.1c">\mathcal{M}_{gt}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are used for supervision.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS1.SSS2.5.1.1">III-A</span>2 </span>Low-Rank Adaptation</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.9">Low-Rank Adaptation (LoRA) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib36" title=""><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite> is a technique used to reduce the computational and memory requirements of training large neural networks. By approximating weight updates with low-rank matrices, LoRA allows for more efficient fine-tuning of pre-trained models. This approach enables the adaptation of large models to new tasks or datasets with significantly lower resource consumption while maintaining performance. For each weight in the encoder network <math alttext="\theta\in\mathbb{R}^{d_{i}\times d_{o}}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.1.m1.1"><semantics id="S3.SS1.SSS2.p1.1.m1.1a"><mrow id="S3.SS1.SSS2.p1.1.m1.1.1" xref="S3.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p1.1.m1.1.1.2" xref="S3.SS1.SSS2.p1.1.m1.1.1.2.cmml">θ</mi><mo id="S3.SS1.SSS2.p1.1.m1.1.1.1" xref="S3.SS1.SSS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p1.1.m1.1.1.3" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.SSS2.p1.1.m1.1.1.3.2" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS2.p1.1.m1.1.1.3.3" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.cmml"><msub id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.2" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.3" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.2" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.3" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.3.cmml">o</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.1.m1.1b"><apply id="S3.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1"><in id="S3.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.1"></in><ci id="S3.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.2">𝜃</ci><apply id="S3.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3"><times id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.1"></times><apply id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.3.3.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.1.m1.1c">\theta\in\mathbb{R}^{d_{i}\times d_{o}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.1.m1.1d">italic_θ ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, we use a low-rank approximation <math alttext="\omega=AB" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.2.m2.1"><semantics id="S3.SS1.SSS2.p1.2.m2.1a"><mrow id="S3.SS1.SSS2.p1.2.m2.1.1" xref="S3.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.1.1.2" xref="S3.SS1.SSS2.p1.2.m2.1.1.2.cmml">ω</mi><mo id="S3.SS1.SSS2.p1.2.m2.1.1.1" xref="S3.SS1.SSS2.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS1.SSS2.p1.2.m2.1.1.3" xref="S3.SS1.SSS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.1.1.3.2" xref="S3.SS1.SSS2.p1.2.m2.1.1.3.2.cmml">A</mi><mo id="S3.SS1.SSS2.p1.2.m2.1.1.3.1" xref="S3.SS1.SSS2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS2.p1.2.m2.1.1.3.3" xref="S3.SS1.SSS2.p1.2.m2.1.1.3.3.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.2.m2.1b"><apply id="S3.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1"><eq id="S3.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.1"></eq><ci id="S3.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.2">𝜔</ci><apply id="S3.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.3"><times id="S3.SS1.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.3.1"></times><ci id="S3.SS1.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.3.2">𝐴</ci><ci id="S3.SS1.SSS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.2.m2.1c">\omega=AB</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.2.m2.1d">italic_ω = italic_A italic_B</annotation></semantics></math> where <math alttext="A\in\mathbb{R}^{d_{i}\times r}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.3.m3.1"><semantics id="S3.SS1.SSS2.p1.3.m3.1a"><mrow id="S3.SS1.SSS2.p1.3.m3.1.1" xref="S3.SS1.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS2.p1.3.m3.1.1.2" xref="S3.SS1.SSS2.p1.3.m3.1.1.2.cmml">A</mi><mo id="S3.SS1.SSS2.p1.3.m3.1.1.1" xref="S3.SS1.SSS2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p1.3.m3.1.1.3" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.SSS2.p1.3.m3.1.1.3.2" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS2.p1.3.m3.1.1.3.3" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.cmml"><msub id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.2" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.3" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.3" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.3.m3.1b"><apply id="S3.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1"><in id="S3.SS1.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.1"></in><ci id="S3.SS1.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.2">𝐴</ci><apply id="S3.SS1.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3"><times id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.1"></times><apply id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS2.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.3.m3.1c">A\in\mathbb{R}^{d_{i}\times r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.3.m3.1d">italic_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="A\in\mathbb{R}^{r\times d_{o}}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.4.m4.1"><semantics id="S3.SS1.SSS2.p1.4.m4.1a"><mrow id="S3.SS1.SSS2.p1.4.m4.1.1" xref="S3.SS1.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS1.SSS2.p1.4.m4.1.1.2" xref="S3.SS1.SSS2.p1.4.m4.1.1.2.cmml">A</mi><mo id="S3.SS1.SSS2.p1.4.m4.1.1.1" xref="S3.SS1.SSS2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS2.p1.4.m4.1.1.3" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS2.p1.4.m4.1.1.3.2" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS2.p1.4.m4.1.1.3.3" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.2" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.2.cmml">r</mi><mo id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.2" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.3" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.3.cmml">o</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.4.m4.1b"><apply id="S3.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1"><in id="S3.SS1.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.1"></in><ci id="S3.SS1.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.2">𝐴</ci><apply id="S3.SS1.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3"><times id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.1"></times><ci id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.2">𝑟</ci><apply id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1.3.3.3.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.4.m4.1c">A\in\mathbb{R}^{r\times d_{o}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.4.m4.1d">italic_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_r × italic_d start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="r" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.5.m5.1"><semantics id="S3.SS1.SSS2.p1.5.m5.1a"><mi id="S3.SS1.SSS2.p1.5.m5.1.1" xref="S3.SS1.SSS2.p1.5.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.5.m5.1b"><ci id="S3.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p1.5.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.5.m5.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.5.m5.1d">italic_r</annotation></semantics></math> indicating the rank. We can achieve a compression rate of <math alttext="r\left(d_{i}+d_{o}\right)/d_{i}\cdot d_{o}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.6.m6.1"><semantics id="S3.SS1.SSS2.p1.6.m6.1a"><mrow id="S3.SS1.SSS2.p1.6.m6.1.1" xref="S3.SS1.SSS2.p1.6.m6.1.1.cmml"><mrow id="S3.SS1.SSS2.p1.6.m6.1.1.1" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.cmml"><mrow id="S3.SS1.SSS2.p1.6.m6.1.1.1.1" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.cmml"><mi id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.3" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.3.cmml">r</mi><mo id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.2" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.2" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.cmml"><msub id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.2" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.2.cmml">d</mi><mi id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.3" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.1" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.2" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.2.cmml">d</mi><mi id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.3" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.3.cmml">o</mi></msub></mrow><mo id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.3" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.SSS2.p1.6.m6.1.1.1.2" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.2.cmml">/</mo><msub id="S3.SS1.SSS2.p1.6.m6.1.1.1.3" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.3.cmml"><mi id="S3.SS1.SSS2.p1.6.m6.1.1.1.3.2" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.3.2.cmml">d</mi><mi id="S3.SS1.SSS2.p1.6.m6.1.1.1.3.3" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.SS1.SSS2.p1.6.m6.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS2.p1.6.m6.1.1.2.cmml">⋅</mo><msub id="S3.SS1.SSS2.p1.6.m6.1.1.3" xref="S3.SS1.SSS2.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.SSS2.p1.6.m6.1.1.3.2" xref="S3.SS1.SSS2.p1.6.m6.1.1.3.2.cmml">d</mi><mi id="S3.SS1.SSS2.p1.6.m6.1.1.3.3" xref="S3.SS1.SSS2.p1.6.m6.1.1.3.3.cmml">o</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.6.m6.1b"><apply id="S3.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1"><ci id="S3.SS1.SSS2.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.2">⋅</ci><apply id="S3.SS1.SSS2.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1"><divide id="S3.SS1.SSS2.p1.6.m6.1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.2"></divide><apply id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1"><times id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.2"></times><ci id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.3">𝑟</ci><apply id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1"><plus id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.1"></plus><apply id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.2">𝑑</ci><ci id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.1.1.1.1.3.3">𝑜</ci></apply></apply></apply><apply id="S3.SS1.SSS2.p1.6.m6.1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.6.m6.1.1.1.3.1.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.6.m6.1.1.1.3.2.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.3.2">𝑑</ci><ci id="S3.SS1.SSS2.p1.6.m6.1.1.1.3.3.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS2.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.3.2">𝑑</ci><ci id="S3.SS1.SSS2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.SSS2.p1.6.m6.1.1.3.3">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.6.m6.1c">r\left(d_{i}+d_{o}\right)/d_{i}\cdot d_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.6.m6.1d">italic_r ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_d start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) / italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_d start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math>. Only <math alttext="A" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.7.m7.1"><semantics id="S3.SS1.SSS2.p1.7.m7.1a"><mi id="S3.SS1.SSS2.p1.7.m7.1.1" xref="S3.SS1.SSS2.p1.7.m7.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.7.m7.1b"><ci id="S3.SS1.SSS2.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS2.p1.7.m7.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.7.m7.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.7.m7.1d">italic_A</annotation></semantics></math> and <math alttext="B" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.8.m8.1"><semantics id="S3.SS1.SSS2.p1.8.m8.1a"><mi id="S3.SS1.SSS2.p1.8.m8.1.1" xref="S3.SS1.SSS2.p1.8.m8.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.8.m8.1b"><ci id="S3.SS1.SSS2.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS2.p1.8.m8.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.8.m8.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.8.m8.1d">italic_B</annotation></semantics></math> are updated via backpropagation during adaptation to reduce memory footprint. At the inference stage, the weight is reconstructed by combining the low-rank reconstruction and original weight, <math alttext="\theta=\theta+AB" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.9.m9.1"><semantics id="S3.SS1.SSS2.p1.9.m9.1a"><mrow id="S3.SS1.SSS2.p1.9.m9.1.1" xref="S3.SS1.SSS2.p1.9.m9.1.1.cmml"><mi id="S3.SS1.SSS2.p1.9.m9.1.1.2" xref="S3.SS1.SSS2.p1.9.m9.1.1.2.cmml">θ</mi><mo id="S3.SS1.SSS2.p1.9.m9.1.1.1" xref="S3.SS1.SSS2.p1.9.m9.1.1.1.cmml">=</mo><mrow id="S3.SS1.SSS2.p1.9.m9.1.1.3" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.cmml"><mi id="S3.SS1.SSS2.p1.9.m9.1.1.3.2" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.2.cmml">θ</mi><mo id="S3.SS1.SSS2.p1.9.m9.1.1.3.1" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.1.cmml">+</mo><mrow id="S3.SS1.SSS2.p1.9.m9.1.1.3.3" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.3.cmml"><mi id="S3.SS1.SSS2.p1.9.m9.1.1.3.3.2" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.3.2.cmml">A</mi><mo id="S3.SS1.SSS2.p1.9.m9.1.1.3.3.1" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS2.p1.9.m9.1.1.3.3.3" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.3.3.cmml">B</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.9.m9.1b"><apply id="S3.SS1.SSS2.p1.9.m9.1.1.cmml" xref="S3.SS1.SSS2.p1.9.m9.1.1"><eq id="S3.SS1.SSS2.p1.9.m9.1.1.1.cmml" xref="S3.SS1.SSS2.p1.9.m9.1.1.1"></eq><ci id="S3.SS1.SSS2.p1.9.m9.1.1.2.cmml" xref="S3.SS1.SSS2.p1.9.m9.1.1.2">𝜃</ci><apply id="S3.SS1.SSS2.p1.9.m9.1.1.3.cmml" xref="S3.SS1.SSS2.p1.9.m9.1.1.3"><plus id="S3.SS1.SSS2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.1"></plus><ci id="S3.SS1.SSS2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.2">𝜃</ci><apply id="S3.SS1.SSS2.p1.9.m9.1.1.3.3.cmml" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.3"><times id="S3.SS1.SSS2.p1.9.m9.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.3.1"></times><ci id="S3.SS1.SSS2.p1.9.m9.1.1.3.3.2.cmml" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.3.2">𝐴</ci><ci id="S3.SS1.SSS2.p1.9.m9.1.1.3.3.3.cmml" xref="S3.SS1.SSS2.p1.9.m9.1.1.3.3.3">𝐵</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.9.m9.1c">\theta=\theta+AB</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.9.m9.1d">italic_θ = italic_θ + italic_A italic_B</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.5.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.6.2">Pointly-supervised Segment Anything Model</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.9">The overall architecture of our proposed Pointly-supervised Segmentation Anything Model (PointSAM) is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S2.F3" title="Figure 3 ‣ II-B Point-based supervision ‣ II Related Work ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">3</span></a>. The pipeline is divided into two stages: Offline Prototype Generation and SAM with Self-Training. In the first stage, we extract prototypes of instances from the target dataset offline (see Sec. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS3.SSS1" title="III-C1 Offline Prototype Generation ‣ III-C Prototype-based Regularization ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span>1</span></a>). During the self-training phase, two different views of each image, <math alttext="\mathcal{I}_{img}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">ℐ</mi><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">m</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1a" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.4" xref="S3.SS2.p1.1.m1.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">ℐ</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><times id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝑚</ci><ci id="S3.SS2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS2.p1.1.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{I}_{img}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">caligraphic_I start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, are generated: <math alttext="\mathcal{I}_{img}^{s}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msubsup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">ℐ</mi><mrow id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.3.2" xref="S3.SS2.p1.2.m2.1.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.2.m2.1.1.2.3.1" xref="S3.SS2.p1.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.2.3.3" xref="S3.SS2.p1.2.m2.1.1.2.3.3.cmml">m</mi><mo id="S3.SS2.p1.2.m2.1.1.2.3.1a" xref="S3.SS2.p1.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.2.3.4" xref="S3.SS2.p1.2.m2.1.1.2.3.4.cmml">g</mi></mrow><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">ℐ</ci><apply id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3"><times id="S3.SS2.p1.2.m2.1.1.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.2">𝑖</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.3">𝑚</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.4.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathcal{I}_{img}^{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">caligraphic_I start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> with strong data augmentation and <math alttext="\mathcal{I}_{img}^{w}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msubsup id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">ℐ</mi><mrow id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.3.2" xref="S3.SS2.p1.3.m3.1.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.3.m3.1.1.2.3.1" xref="S3.SS2.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.3.m3.1.1.2.3.3" xref="S3.SS2.p1.3.m3.1.1.2.3.3.cmml">m</mi><mo id="S3.SS2.p1.3.m3.1.1.2.3.1a" xref="S3.SS2.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.3.m3.1.1.2.3.4" xref="S3.SS2.p1.3.m3.1.1.2.3.4.cmml">g</mi></mrow><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">ℐ</ci><apply id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3"><times id="S3.SS2.p1.3.m3.1.1.2.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3.1"></times><ci id="S3.SS2.p1.3.m3.1.1.2.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3.2">𝑖</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3.3">𝑚</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.4.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathcal{I}_{img}^{w}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">caligraphic_I start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> with weak data augmentation. The data augmentation techniques are detailed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite>. Both <math alttext="\mathcal{I}_{img}^{s}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msubsup id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.2.2.cmml">ℐ</mi><mrow id="S3.SS2.p1.4.m4.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.2.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2.3.2" xref="S3.SS2.p1.4.m4.1.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.4.m4.1.1.2.3.1" xref="S3.SS2.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.1.1.2.3.3" xref="S3.SS2.p1.4.m4.1.1.2.3.3.cmml">m</mi><mo id="S3.SS2.p1.4.m4.1.1.2.3.1a" xref="S3.SS2.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.1.1.2.3.4" xref="S3.SS2.p1.4.m4.1.1.2.3.4.cmml">g</mi></mrow><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2.2">ℐ</ci><apply id="S3.SS2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3"><times id="S3.SS2.p1.4.m4.1.1.2.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3.1"></times><ci id="S3.SS2.p1.4.m4.1.1.2.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3.2">𝑖</ci><ci id="S3.SS2.p1.4.m4.1.1.2.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3.3">𝑚</ci><ci id="S3.SS2.p1.4.m4.1.1.2.3.4.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\mathcal{I}_{img}^{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">caligraphic_I start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{I}_{img}^{w}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msubsup id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2.cmml">ℐ</mi><mrow id="S3.SS2.p1.5.m5.1.1.2.3" xref="S3.SS2.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2.3.2" xref="S3.SS2.p1.5.m5.1.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.5.m5.1.1.2.3.1" xref="S3.SS2.p1.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m5.1.1.2.3.3" xref="S3.SS2.p1.5.m5.1.1.2.3.3.cmml">m</mi><mo id="S3.SS2.p1.5.m5.1.1.2.3.1a" xref="S3.SS2.p1.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m5.1.1.2.3.4" xref="S3.SS2.p1.5.m5.1.1.2.3.4.cmml">g</mi></mrow><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2">ℐ</ci><apply id="S3.SS2.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3"><times id="S3.SS2.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.1"></times><ci id="S3.SS2.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.2">𝑖</ci><ci id="S3.SS2.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.3">𝑚</ci><ci id="S3.SS2.p1.5.m5.1.1.2.3.4.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mathcal{I}_{img}^{w}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">caligraphic_I start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT</annotation></semantics></math> are then fed into shared teacher and student encoders. The encoder structures are fixed, and additional LoRA layers are used to fine-tune the model. The teacher’s image encoder outputs predicted instance features to a memory bank, which is updated using a First-in-First-Out (FIFO) strategy. These features are clustered to obtain new predicted prototypes (see Sec. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS3.SSS2" title="III-C2 Memory Bank Updating ‣ III-C Prototype-based Regularization ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span>2</span></a>). The offline-extracted prototypes are aligned with the new predicted prototypes using a matching loss (see Sec. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS3.SSS3" title="III-C3 Hungarian Matching ‣ III-C Prototype-based Regularization ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-C</span>3</span></a>). Simultaneously, the teacher and student networks predict corresponding masks <math alttext="\mathcal{M}^{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><msup id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">ℳ</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{M}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">caligraphic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{M}^{s}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><msup id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">ℳ</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathcal{M}^{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">caligraphic_M start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math>. We apply the Negative Prompt Calibration (NPC) strategy to <math alttext="\mathcal{M}^{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><msup id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">superscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2">ℳ</ci><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\mathcal{M}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">caligraphic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> to generate refined masks, <math alttext="\mathcal{M}^{r}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><msup id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml">ℳ</mi><mi id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">superscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2">ℳ</ci><ci id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\mathcal{M}^{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">caligraphic_M start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> (see Sec. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS4" title="III-D Negative Prompt Calibration ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a>), which are then used as pseudo-labels to train the student network. For more information on the network training loss, refer to Sec. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.SS5" title="III-E Total Loss ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-E</span></span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.5.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.6.2">Prototype-based Regularization</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">General self-training methods are prone to <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.1">confirmation bias</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib52" title=""><span class="ltx_text" style="font-size:90%;">52</span></a>]</cite>. There are two common solutions to solve this problem. The first approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">23</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib25" title=""><span class="ltx_text" style="font-size:90%;">25</span></a>]</cite> involves aligning the predicted features extracted by the model from the source data with those extracted from the target data. However, due to the vast amount of data used to train SAM, it is challenging to obtain an accurate source distribution. Additionally, the limited number of batches used in SAM’s fine-tuning can also result in inaccurate prediction distributions. Therefore, this approach is not suitable for our task. The second approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite> introduces an anchor model to obtain the corresponding logits to constrain the predicted logits. Specifically, this method uses the frozen weights of the source model to predict the results on the target data and constrains the self-training process of the target model with these results. However, since the source model’s predictions might contain significant errors, this approach may not deliver the expected results. Instead of directly constraining logits, we propose instance-level constraints without relying on source data. First, we generate target prototypes using GT points through <span class="ltx_text ltx_font_bold" id="S3.SS3.p1.1.2">Offline Prototype Generation</span>. Predicted prototypes are then dynamically obtained via <span class="ltx_text ltx_font_bold" id="S3.SS3.p1.1.3">Memory Bank Updating</span>. Finally, <span class="ltx_text ltx_font_bold" id="S3.SS3.p1.1.4">Hungarian Matching</span> is used to align the target and predicted prototypes. The following sections will provide a detailed explanation of each step in the proposed approach</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS3.SSS1.5.1.1">III-C</span>1 </span>Offline Prototype Generation</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.6">We begin by using the source model to extract embeddings offline for prompts corresponding to each instance in the target dataset. As illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S2.F3" title="Figure 3 ‣ II-B Point-based supervision ‣ II Related Work ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">3</span></a>(a), given an image <math alttext="\mathcal{I}_{img}\in\mathbb{R}^{C\times H\times W}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mrow id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml"><msub id="S3.SS3.SSS1.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.1.m1.1.1.2.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.2.cmml">ℐ</mi><mrow id="S3.SS3.SSS1.p1.1.m1.1.1.2.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.3.cmml">m</mi><mo id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.1a" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.4" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.4.cmml">g</mi></mrow></msub><mo id="S3.SS3.SSS1.p1.1.m1.1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.2.cmml">C</mi><mo id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.3.cmml">H</mi><mo id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.4" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.4.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"><in id="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.1"></in><apply id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.2">ℐ</ci><apply id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3"><times id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.1"></times><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.3">𝑚</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.3.4.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.3.4">𝑔</ci></apply></apply><apply id="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3"><times id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.2">𝐶</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.3">𝐻</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.4">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">\mathcal{I}_{img}\in\mathbb{R}^{C\times H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">caligraphic_I start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C × italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math> from the target dataset, we pass it through the frozen image encoder of SAM to obtain the backbone feature map <math alttext="\mathcal{F}^{b}\in\mathbb{R}^{C_{b}\times H/s\times W/s}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mrow id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml"><msup id="S3.SS3.SSS1.p1.2.m2.1.1.2" xref="S3.SS3.SSS1.p1.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.2.m2.1.1.2.2" xref="S3.SS3.SSS1.p1.2.m2.1.1.2.2.cmml">ℱ</mi><mi id="S3.SS3.SSS1.p1.2.m2.1.1.2.3" xref="S3.SS3.SSS1.p1.2.m2.1.1.2.3.cmml">b</mi></msup><mo id="S3.SS3.SSS1.p1.2.m2.1.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.2.m2.1.1.3" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.2.m2.1.1.3.3" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.cmml"><mrow id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.cmml"><mrow id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.cmml"><mrow id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.cmml"><msub id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.2" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.2.cmml">C</mi><mi id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.3" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.3.cmml">b</mi></msub><mo id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.1.cmml">×</mo><mi id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.3" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.3.cmml">H</mi></mrow><mo id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.1.cmml">/</mo><mi id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.3" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.3.cmml">s</mi></mrow><mo id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.3" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.3.cmml">W</mi></mrow><mo id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.1.cmml">/</mo><mi id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.3" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.3.cmml">s</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><apply id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1"><in id="S3.SS3.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.1"></in><apply id="S3.SS3.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.2.2">ℱ</ci><ci id="S3.SS3.SSS1.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.2.3">𝑏</ci></apply><apply id="S3.SS3.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3"><divide id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.1"></divide><apply id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2"><times id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.1"></times><apply id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2"><divide id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.1"></divide><apply id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2"><times id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.1"></times><apply id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.2">𝐶</ci><ci id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.2.3">𝑏</ci></apply><ci id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.2.3">𝐻</ci></apply><ci id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.2.3">𝑠</ci></apply><ci id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.2.3">𝑊</ci></apply><ci id="S3.SS3.SSS1.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1.3.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">\mathcal{F}^{b}\in\mathbb{R}^{C_{b}\times H/s\times W/s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">caligraphic_F start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT × italic_H / italic_s × italic_W / italic_s end_POSTSUPERSCRIPT</annotation></semantics></math>. To locate the ground truth (GT) prompt <math alttext="\left(x_{k},y_{k}\right)" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.3.m3.2"><semantics id="S3.SS3.SSS1.p1.3.m3.2a"><mrow id="S3.SS3.SSS1.p1.3.m3.2.2.2" xref="S3.SS3.SSS1.p1.3.m3.2.2.3.cmml"><mo id="S3.SS3.SSS1.p1.3.m3.2.2.2.3" xref="S3.SS3.SSS1.p1.3.m3.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS1.p1.3.m3.1.1.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.2" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.3" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS3.SSS1.p1.3.m3.2.2.2.4" xref="S3.SS3.SSS1.p1.3.m3.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS1.p1.3.m3.2.2.2.2" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.cmml">y</mi><mi id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.3" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS3.SSS1.p1.3.m3.2.2.2.5" xref="S3.SS3.SSS1.p1.3.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.2b"><interval closure="open" id="S3.SS3.SSS1.p1.3.m3.2.2.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2"><apply id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.2">𝑦</ci><ci id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.3">𝑘</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.2c">\left(x_{k},y_{k}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.3.m3.2d">( italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> within the original image, we map it to the feature map coordinates (<math alttext="x_{k}^{\prime}={x_{k}}/s" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.4.m4.1"><semantics id="S3.SS3.SSS1.p1.4.m4.1a"><mrow id="S3.SS3.SSS1.p1.4.m4.1.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.cmml"><msubsup id="S3.SS3.SSS1.p1.4.m4.1.1.2" xref="S3.SS3.SSS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS3.SSS1.p1.4.m4.1.1.2.2.2" xref="S3.SS3.SSS1.p1.4.m4.1.1.2.2.2.cmml">x</mi><mi id="S3.SS3.SSS1.p1.4.m4.1.1.2.2.3" xref="S3.SS3.SSS1.p1.4.m4.1.1.2.2.3.cmml">k</mi><mo id="S3.SS3.SSS1.p1.4.m4.1.1.2.3" xref="S3.SS3.SSS1.p1.4.m4.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS1.p1.4.m4.1.1.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.4.m4.1.1.3" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.cmml"><msub id="S3.SS3.SSS1.p1.4.m4.1.1.3.2" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.2.cmml"><mi id="S3.SS3.SSS1.p1.4.m4.1.1.3.2.2" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.2.2.cmml">x</mi><mi id="S3.SS3.SSS1.p1.4.m4.1.1.3.2.3" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.2.3.cmml">k</mi></msub><mo id="S3.SS3.SSS1.p1.4.m4.1.1.3.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.1.cmml">/</mo><mi id="S3.SS3.SSS1.p1.4.m4.1.1.3.3" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.3.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m4.1b"><apply id="S3.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1"><eq id="S3.SS3.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.1"></eq><apply id="S3.SS3.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.2">superscript</csymbol><apply id="S3.SS3.SSS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.4.m4.1.1.2.2.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.4.m4.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.2.2.2">𝑥</ci><ci id="S3.SS3.SSS1.p1.4.m4.1.1.2.2.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.2.2.3">𝑘</ci></apply><ci id="S3.SS3.SSS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.2.3">′</ci></apply><apply id="S3.SS3.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.3"><divide id="S3.SS3.SSS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.1"></divide><apply id="S3.SS3.SSS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.4.m4.1.1.3.2.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.4.m4.1.1.3.2.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.2.2">𝑥</ci><ci id="S3.SS3.SSS1.p1.4.m4.1.1.3.2.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS3.SSS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m4.1c">x_{k}^{\prime}={x_{k}}/s</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT / italic_s</annotation></semantics></math>, <math alttext="y_{k}^{\prime}=y_{k}/s" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.5.m5.1"><semantics id="S3.SS3.SSS1.p1.5.m5.1a"><mrow id="S3.SS3.SSS1.p1.5.m5.1.1" xref="S3.SS3.SSS1.p1.5.m5.1.1.cmml"><msubsup id="S3.SS3.SSS1.p1.5.m5.1.1.2" xref="S3.SS3.SSS1.p1.5.m5.1.1.2.cmml"><mi id="S3.SS3.SSS1.p1.5.m5.1.1.2.2.2" xref="S3.SS3.SSS1.p1.5.m5.1.1.2.2.2.cmml">y</mi><mi id="S3.SS3.SSS1.p1.5.m5.1.1.2.2.3" xref="S3.SS3.SSS1.p1.5.m5.1.1.2.2.3.cmml">k</mi><mo id="S3.SS3.SSS1.p1.5.m5.1.1.2.3" xref="S3.SS3.SSS1.p1.5.m5.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS1.p1.5.m5.1.1.1" xref="S3.SS3.SSS1.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.5.m5.1.1.3" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.cmml"><msub id="S3.SS3.SSS1.p1.5.m5.1.1.3.2" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.2.cmml"><mi id="S3.SS3.SSS1.p1.5.m5.1.1.3.2.2" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.2.2.cmml">y</mi><mi id="S3.SS3.SSS1.p1.5.m5.1.1.3.2.3" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.2.3.cmml">k</mi></msub><mo id="S3.SS3.SSS1.p1.5.m5.1.1.3.1" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.1.cmml">/</mo><mi id="S3.SS3.SSS1.p1.5.m5.1.1.3.3" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.3.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.5.m5.1b"><apply id="S3.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1"><eq id="S3.SS3.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.1"></eq><apply id="S3.SS3.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.2">superscript</csymbol><apply id="S3.SS3.SSS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.5.m5.1.1.2.2.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.5.m5.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.2.2.2">𝑦</ci><ci id="S3.SS3.SSS1.p1.5.m5.1.1.2.2.3.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.2.2.3">𝑘</ci></apply><ci id="S3.SS3.SSS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.2.3">′</ci></apply><apply id="S3.SS3.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.3"><divide id="S3.SS3.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.1"></divide><apply id="S3.SS3.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.5.m5.1.1.3.2.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.5.m5.1.1.3.2.2.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.2.2">𝑦</ci><ci id="S3.SS3.SSS1.p1.5.m5.1.1.3.2.3.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS3.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.5.m5.1c">y_{k}^{\prime}=y_{k}/s</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT / italic_s</annotation></semantics></math>) and extract the corresponding embedding <math alttext="f_{k}^{t}\in\mathbb{R}^{C_{b}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.6.m6.1"><semantics id="S3.SS3.SSS1.p1.6.m6.1a"><mrow id="S3.SS3.SSS1.p1.6.m6.1.1" xref="S3.SS3.SSS1.p1.6.m6.1.1.cmml"><msubsup id="S3.SS3.SSS1.p1.6.m6.1.1.2" xref="S3.SS3.SSS1.p1.6.m6.1.1.2.cmml"><mi id="S3.SS3.SSS1.p1.6.m6.1.1.2.2.2" xref="S3.SS3.SSS1.p1.6.m6.1.1.2.2.2.cmml">f</mi><mi id="S3.SS3.SSS1.p1.6.m6.1.1.2.2.3" xref="S3.SS3.SSS1.p1.6.m6.1.1.2.2.3.cmml">k</mi><mi id="S3.SS3.SSS1.p1.6.m6.1.1.2.3" xref="S3.SS3.SSS1.p1.6.m6.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.SS3.SSS1.p1.6.m6.1.1.1" xref="S3.SS3.SSS1.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.6.m6.1.1.3" xref="S3.SS3.SSS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.6.m6.1.1.3.2" xref="S3.SS3.SSS1.p1.6.m6.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS3.SSS1.p1.6.m6.1.1.3.3" xref="S3.SS3.SSS1.p1.6.m6.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.p1.6.m6.1.1.3.3.2" xref="S3.SS3.SSS1.p1.6.m6.1.1.3.3.2.cmml">C</mi><mi id="S3.SS3.SSS1.p1.6.m6.1.1.3.3.3" xref="S3.SS3.SSS1.p1.6.m6.1.1.3.3.3.cmml">b</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.6.m6.1b"><apply id="S3.SS3.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1"><in id="S3.SS3.SSS1.p1.6.m6.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.1"></in><apply id="S3.SS3.SSS1.p1.6.m6.1.1.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.2">superscript</csymbol><apply id="S3.SS3.SSS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m6.1.1.2.2.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m6.1.1.2.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.2.2.2">𝑓</ci><ci id="S3.SS3.SSS1.p1.6.m6.1.1.2.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.2.2.3">𝑘</ci></apply><ci id="S3.SS3.SSS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.2.3">𝑡</ci></apply><apply id="S3.SS3.SSS1.p1.6.m6.1.1.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m6.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.3.3.2">𝐶</ci><ci id="S3.SS3.SSS1.p1.6.m6.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1.3.3.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.6.m6.1c">f_{k}^{t}\in\mathbb{R}^{C_{b}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{k}^{t}=\mathcal{F}^{b}\left(x_{k}^{\prime},y_{k}^{\prime}\right)" class="ltx_Math" display="block" id="S3.E2.m1.2"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><msubsup id="S3.E2.m1.2.2.4" xref="S3.E2.m1.2.2.4.cmml"><mi id="S3.E2.m1.2.2.4.2.2" xref="S3.E2.m1.2.2.4.2.2.cmml">f</mi><mi id="S3.E2.m1.2.2.4.2.3" xref="S3.E2.m1.2.2.4.2.3.cmml">k</mi><mi id="S3.E2.m1.2.2.4.3" xref="S3.E2.m1.2.2.4.3.cmml">t</mi></msubsup><mo id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml">=</mo><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><msup id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.2.cmml">ℱ</mi><mi id="S3.E2.m1.2.2.2.4.3" xref="S3.E2.m1.2.2.2.4.3.cmml">b</mi></msup><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.3.cmml"><mo id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml">(</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E2.m1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.2.3.cmml">k</mi><mo id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E2.m1.2.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E2.m1.2.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.2.3.cmml">k</mi><mo id="S3.E2.m1.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.E2.m1.2.2.2.2.2.5" xref="S3.E2.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><eq id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"></eq><apply id="S3.E2.m1.2.2.4.cmml" xref="S3.E2.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.4.1.cmml" xref="S3.E2.m1.2.2.4">superscript</csymbol><apply id="S3.E2.m1.2.2.4.2.cmml" xref="S3.E2.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.4.2.1.cmml" xref="S3.E2.m1.2.2.4">subscript</csymbol><ci id="S3.E2.m1.2.2.4.2.2.cmml" xref="S3.E2.m1.2.2.4.2.2">𝑓</ci><ci id="S3.E2.m1.2.2.4.2.3.cmml" xref="S3.E2.m1.2.2.4.2.3">𝑘</ci></apply><ci id="S3.E2.m1.2.2.4.3.cmml" xref="S3.E2.m1.2.2.4.3">𝑡</ci></apply><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><times id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"></times><apply id="S3.E2.m1.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4">superscript</csymbol><ci id="S3.E2.m1.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.4.2">ℱ</ci><ci id="S3.E2.m1.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.4.3">𝑏</ci></apply><interval closure="open" id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E2.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="S3.E2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3">′</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">f_{k}^{t}=\mathcal{F}^{b}\left(x_{k}^{\prime},y_{k}^{\prime}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.2d">italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = caligraphic_F start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT ( italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.p2.3">In this way, we can obtain a large number of feature points <math alttext="\{f_{k}^{t}\}_{k=1\cdots K}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.1.m1.1"><semantics id="S3.SS3.SSS1.p2.1.m1.1a"><msub id="S3.SS3.SSS1.p2.1.m1.1.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.cmml"><mrow id="S3.SS3.SSS1.p2.1.m1.1.1.1.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.2.cmml"><mo id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.3.cmml">k</mi><mi id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS1.p2.1.m1.1.1.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2.cmml">k</mi><mo id="S3.SS3.SSS1.p2.1.m1.1.1.3.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.1.cmml">=</mo><mrow id="S3.SS3.SSS1.p2.1.m1.1.1.3.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.cmml"><mn id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.2.cmml">1</mn><mo id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3" mathvariant="normal" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.cmml">⋯</mi><mo id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.1a" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.4" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.4.cmml">K</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.1.m1.1b"><apply id="S3.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1">subscript</csymbol><set id="S3.SS3.SSS1.p2.1.m1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1"><apply id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S3.SS3.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3"><eq id="S3.SS3.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.1"></eq><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.2">𝑘</ci><apply id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3"><times id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.1"></times><cn id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.2">1</cn><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.3">⋯</ci><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3.3.4.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3.3.4">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.1.m1.1c">\{f_{k}^{t}\}_{k=1\cdots K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.1.m1.1d">{ italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_k = 1 ⋯ italic_K end_POSTSUBSCRIPT</annotation></semantics></math> from the source model corresponding to GT points in the target data. Next, we cluster these feature points. Since SAM is a class-agnostic segmenter, the feature points lack class labels, and the number of clusters is unknown. Consequently, using Kmeans for clustering directly is suboptimal. To address this, we employ FINCH <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite>, a clustering algorithm that does not require prior knowledge of the number of clusters. We then compute the mean feature of each cluster to represent the target prototype. Let <math alttext="C^{t}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.2.m2.1"><semantics id="S3.SS3.SSS1.p2.2.m2.1a"><msubsup id="S3.SS3.SSS1.p2.2.m2.1.1" xref="S3.SS3.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p2.2.m2.1.1.2.2" xref="S3.SS3.SSS1.p2.2.m2.1.1.2.2.cmml">C</mi><mi id="S3.SS3.SSS1.p2.2.m2.1.1.3" xref="S3.SS3.SSS1.p2.2.m2.1.1.3.cmml">i</mi><mi id="S3.SS3.SSS1.p2.2.m2.1.1.2.3" xref="S3.SS3.SSS1.p2.2.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.2.m2.1b"><apply id="S3.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.2.2">𝐶</ci><ci id="S3.SS3.SSS1.p2.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.2.m2.1c">C^{t}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.2.m2.1d">italic_C start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denote the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.3.m3.1"><semantics id="S3.SS3.SSS1.p2.3.m3.1a"><mi id="S3.SS3.SSS1.p2.3.m3.1.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.3.m3.1b"><ci id="S3.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.3.m3.1d">italic_i</annotation></semantics></math>-th cluster:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{P}^{t}_{i}=\frac{1}{\left|C^{t}_{i}\right|}\sum_{f_{k}^{t}\in C^{t}_{%
i}}f_{k}^{t}" class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.2" xref="S3.E3.m1.1.2.cmml"><msubsup id="S3.E3.m1.1.2.2" xref="S3.E3.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.2.2.2.2" xref="S3.E3.m1.1.2.2.2.2.cmml">𝒫</mi><mi id="S3.E3.m1.1.2.2.3" xref="S3.E3.m1.1.2.2.3.cmml">i</mi><mi id="S3.E3.m1.1.2.2.2.3" xref="S3.E3.m1.1.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.E3.m1.1.2.1" xref="S3.E3.m1.1.2.1.cmml">=</mo><mrow id="S3.E3.m1.1.2.3" xref="S3.E3.m1.1.2.3.cmml"><mfrac id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mn id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml">1</mn><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.1.cmml">|</mo><msubsup id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.2.2.cmml">C</mi><mi id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.E3.m1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E3.m1.1.2.3.1" xref="S3.E3.m1.1.2.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.1.2.3.2" xref="S3.E3.m1.1.2.3.2.cmml"><munder id="S3.E3.m1.1.2.3.2.1" xref="S3.E3.m1.1.2.3.2.1.cmml"><mo id="S3.E3.m1.1.2.3.2.1.2" movablelimits="false" xref="S3.E3.m1.1.2.3.2.1.2.cmml">∑</mo><mrow id="S3.E3.m1.1.2.3.2.1.3" xref="S3.E3.m1.1.2.3.2.1.3.cmml"><msubsup id="S3.E3.m1.1.2.3.2.1.3.2" xref="S3.E3.m1.1.2.3.2.1.3.2.cmml"><mi id="S3.E3.m1.1.2.3.2.1.3.2.2.2" xref="S3.E3.m1.1.2.3.2.1.3.2.2.2.cmml">f</mi><mi id="S3.E3.m1.1.2.3.2.1.3.2.2.3" xref="S3.E3.m1.1.2.3.2.1.3.2.2.3.cmml">k</mi><mi id="S3.E3.m1.1.2.3.2.1.3.2.3" xref="S3.E3.m1.1.2.3.2.1.3.2.3.cmml">t</mi></msubsup><mo id="S3.E3.m1.1.2.3.2.1.3.1" xref="S3.E3.m1.1.2.3.2.1.3.1.cmml">∈</mo><msubsup id="S3.E3.m1.1.2.3.2.1.3.3" xref="S3.E3.m1.1.2.3.2.1.3.3.cmml"><mi id="S3.E3.m1.1.2.3.2.1.3.3.2.2" xref="S3.E3.m1.1.2.3.2.1.3.3.2.2.cmml">C</mi><mi id="S3.E3.m1.1.2.3.2.1.3.3.3" xref="S3.E3.m1.1.2.3.2.1.3.3.3.cmml">i</mi><mi id="S3.E3.m1.1.2.3.2.1.3.3.2.3" xref="S3.E3.m1.1.2.3.2.1.3.3.2.3.cmml">t</mi></msubsup></mrow></munder><msubsup id="S3.E3.m1.1.2.3.2.2" xref="S3.E3.m1.1.2.3.2.2.cmml"><mi id="S3.E3.m1.1.2.3.2.2.2.2" xref="S3.E3.m1.1.2.3.2.2.2.2.cmml">f</mi><mi id="S3.E3.m1.1.2.3.2.2.2.3" xref="S3.E3.m1.1.2.3.2.2.2.3.cmml">k</mi><mi id="S3.E3.m1.1.2.3.2.2.3" xref="S3.E3.m1.1.2.3.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.2.cmml" xref="S3.E3.m1.1.2"><eq id="S3.E3.m1.1.2.1.cmml" xref="S3.E3.m1.1.2.1"></eq><apply id="S3.E3.m1.1.2.2.cmml" xref="S3.E3.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.2.1.cmml" xref="S3.E3.m1.1.2.2">subscript</csymbol><apply id="S3.E3.m1.1.2.2.2.cmml" xref="S3.E3.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.2.2.1.cmml" xref="S3.E3.m1.1.2.2">superscript</csymbol><ci id="S3.E3.m1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.2.2.2.2">𝒫</ci><ci id="S3.E3.m1.1.2.2.2.3.cmml" xref="S3.E3.m1.1.2.2.2.3">𝑡</ci></apply><ci id="S3.E3.m1.1.2.2.3.cmml" xref="S3.E3.m1.1.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.1.2.3.cmml" xref="S3.E3.m1.1.2.3"><times id="S3.E3.m1.1.2.3.1.cmml" xref="S3.E3.m1.1.2.3.1"></times><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><divide id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1"></divide><cn id="S3.E3.m1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.3">1</cn><apply id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1"><abs id="S3.E3.m1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2"></abs><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.2">𝐶</ci><ci id="S3.E3.m1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.1.2.3.2.cmml" xref="S3.E3.m1.1.2.3.2"><apply id="S3.E3.m1.1.2.3.2.1.cmml" xref="S3.E3.m1.1.2.3.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.3.2.1.1.cmml" xref="S3.E3.m1.1.2.3.2.1">subscript</csymbol><sum id="S3.E3.m1.1.2.3.2.1.2.cmml" xref="S3.E3.m1.1.2.3.2.1.2"></sum><apply id="S3.E3.m1.1.2.3.2.1.3.cmml" xref="S3.E3.m1.1.2.3.2.1.3"><in id="S3.E3.m1.1.2.3.2.1.3.1.cmml" xref="S3.E3.m1.1.2.3.2.1.3.1"></in><apply id="S3.E3.m1.1.2.3.2.1.3.2.cmml" xref="S3.E3.m1.1.2.3.2.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.3.2.1.3.2.1.cmml" xref="S3.E3.m1.1.2.3.2.1.3.2">superscript</csymbol><apply id="S3.E3.m1.1.2.3.2.1.3.2.2.cmml" xref="S3.E3.m1.1.2.3.2.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.3.2.1.3.2.2.1.cmml" xref="S3.E3.m1.1.2.3.2.1.3.2">subscript</csymbol><ci id="S3.E3.m1.1.2.3.2.1.3.2.2.2.cmml" xref="S3.E3.m1.1.2.3.2.1.3.2.2.2">𝑓</ci><ci id="S3.E3.m1.1.2.3.2.1.3.2.2.3.cmml" xref="S3.E3.m1.1.2.3.2.1.3.2.2.3">𝑘</ci></apply><ci id="S3.E3.m1.1.2.3.2.1.3.2.3.cmml" xref="S3.E3.m1.1.2.3.2.1.3.2.3">𝑡</ci></apply><apply id="S3.E3.m1.1.2.3.2.1.3.3.cmml" xref="S3.E3.m1.1.2.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.3.2.1.3.3.1.cmml" xref="S3.E3.m1.1.2.3.2.1.3.3">subscript</csymbol><apply id="S3.E3.m1.1.2.3.2.1.3.3.2.cmml" xref="S3.E3.m1.1.2.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.3.2.1.3.3.2.1.cmml" xref="S3.E3.m1.1.2.3.2.1.3.3">superscript</csymbol><ci id="S3.E3.m1.1.2.3.2.1.3.3.2.2.cmml" xref="S3.E3.m1.1.2.3.2.1.3.3.2.2">𝐶</ci><ci id="S3.E3.m1.1.2.3.2.1.3.3.2.3.cmml" xref="S3.E3.m1.1.2.3.2.1.3.3.2.3">𝑡</ci></apply><ci id="S3.E3.m1.1.2.3.2.1.3.3.3.cmml" xref="S3.E3.m1.1.2.3.2.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.1.2.3.2.2.cmml" xref="S3.E3.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.3.2.2.1.cmml" xref="S3.E3.m1.1.2.3.2.2">superscript</csymbol><apply id="S3.E3.m1.1.2.3.2.2.2.cmml" xref="S3.E3.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.3.2.2.2.1.cmml" xref="S3.E3.m1.1.2.3.2.2">subscript</csymbol><ci id="S3.E3.m1.1.2.3.2.2.2.2.cmml" xref="S3.E3.m1.1.2.3.2.2.2.2">𝑓</ci><ci id="S3.E3.m1.1.2.3.2.2.2.3.cmml" xref="S3.E3.m1.1.2.3.2.2.2.3">𝑘</ci></apply><ci id="S3.E3.m1.1.2.3.2.2.3.cmml" xref="S3.E3.m1.1.2.3.2.2.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\mathcal{P}^{t}_{i}=\frac{1}{\left|C^{t}_{i}\right|}\sum_{f_{k}^{t}\in C^{t}_{%
i}}f_{k}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">caligraphic_P start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG | italic_C start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∈ italic_C start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p4">
<p class="ltx_p" id="S3.SS3.SSS1.p4.1">Thus, we obtain the feature prototype representations of the source model for the target dataset. Notably, <math alttext="\mathcal{P}^{t}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p4.1.m1.1"><semantics id="S3.SS3.SSS1.p4.1.m1.1a"><msup id="S3.SS3.SSS1.p4.1.m1.1.1" xref="S3.SS3.SSS1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p4.1.m1.1.1.2" xref="S3.SS3.SSS1.p4.1.m1.1.1.2.cmml">𝒫</mi><mi id="S3.SS3.SSS1.p4.1.m1.1.1.3" xref="S3.SS3.SSS1.p4.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p4.1.m1.1b"><apply id="S3.SS3.SSS1.p4.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p4.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p4.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p4.1.m1.1.1.2">𝒫</ci><ci id="S3.SS3.SSS1.p4.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p4.1.m1.1c">\mathcal{P}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p4.1.m1.1d">caligraphic_P start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> is not updated after extraction.</p>
</div>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.F4.1" style="width:424.9pt;height:365.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(2.7pt,-2.3pt) scale(1.01267378372032,1.01267378372032) ;"><svg class="ltx_picture" height="498.87" id="S3.F4.1.pic1" overflow="visible" version="1.1" width="566.8"><g fill="#000000" stroke="#000000" stroke-width="0.75pt" transform="translate(0,498.87) matrix(1 0 0 -1 0 0) translate(-11.42,0) translate(0,434.27)"><g color="#4A4A4A" fill="#F1F8EF" fill-opacity="1" stroke="#4A4A4A" stroke-dasharray="4.5pt,4.5pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 11.93 -59.76 C 11.93 -56.32 14.73 -53.53 18.16 -53.53 L 467.52 -53.53 C 470.95 -53.53 473.74 -56.32 473.74 -59.76 L 473.74 -259.01 C 473.74 -262.45 470.95 -265.23 467.52 -265.23 L 18.16 -265.23 C 14.73 -265.23 11.93 -262.45 11.93 -259.01 Z"></path></g><g color="#808080" fill="#FFFFFF" fill-opacity="0.8" stroke="#808080" stroke-dasharray="5.63pt,4.5pt" stroke-dashoffset="0.0pt" stroke-opacity="1" stroke-width="1.5pt"><path d="M 250.71 -74.38 C 250.71 -70.93 253.5 -68.15 256.93 -68.15 L 353.96 -68.15 C 357.41 -68.15 360.19 -70.93 360.19 -74.38 L 360.19 -245.26 C 360.19 -248.7 357.41 -251.48 353.96 -251.48 L 256.93 -251.48 C 253.5 -251.48 250.71 -248.7 250.71 -245.26 Z"></path></g><g color="#4A4A4A" fill="#F9F8F2" fill-opacity="1" stroke="#4A4A4A" stroke-dasharray="4.5pt,4.5pt" stroke-dashoffset="0.0pt" stroke-opacity="1"><path d="M 479.45 -61.18 C 479.45 -57.13 482.73 -53.85 486.78 -53.85 L 570.36 -53.85 C 574.41 -53.85 577.7 -57.13 577.7 -61.18 L 577.7 -258.22 C 577.7 -262.27 574.41 -265.56 570.36 -265.56 L 486.78 -265.56 C 482.73 -265.56 479.45 -262.27 479.45 -258.22 Z"></path></g><path d="M 427.04 -97.29" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 390.54 -133.79)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S3.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/refined_mask_1.png" width="73"/></foreignobject></g><path d="M 172.27 -96.77" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 135.77 -133.27)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S3.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/init_mask_1.png" width="73"/></foreignobject></g><path d="M 528.57 -96.77" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 492.07 -133.27)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S3.F4.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/gt_1.png" width="73"/></foreignobject></g><path d="M 58.12 -96.77" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 21.62 -133.27)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S3.F4.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/prompt_1.png" width="73"/></foreignobject></g><path d="M 427.04 -207.56" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 390.54 -244.05)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S3.F4.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/refined_mask_2.png" width="73"/></foreignobject></g><path d="M 58.12 -207.04" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 21.62 -243.54)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S3.F4.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/prompt_2.png" width="73"/></foreignobject></g><path d="M 172.27 -207.04" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 135.77 -243.54)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S3.F4.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/init_mask_2.png" width="73"/></foreignobject></g><path d="M 528.57 -207.04" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 492.07 -243.54)"><foreignobject height="73" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="73" id="S3.F4.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/gt_2.png" width="73"/></foreignobject></g><g fill="#F5F2E4" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="1.5pt"><path d="M 279.86 -90.55 L 304.8 -90.55 L 304.8 -115.49 L 279.86 -115.49 Z"></path></g><g fill="#F5F2E4" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="1.5pt"><path d="M 304.8 -90.55 L 329.75 -90.55 L 329.75 -115.49 L 304.8 -115.49 Z"></path></g><g fill="#F5F2E4" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="1.5pt"><path d="M 329.75 -90.55 L 354.69 -90.55 L 354.69 -115.49 L 329.75 -115.49 Z"></path></g><g fill="#F5F2E4" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="1.5pt"><path d="M 279.86 -115.49 L 304.8 -115.49 L 304.8 -140.43 L 279.86 -140.43 Z"></path></g><g fill="#F5F2E4" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="1.5pt"><path d="M 304.8 -115.49 L 329.75 -115.49 L 329.75 -140.43 L 304.8 -140.43 Z"></path></g><g fill="#F5F2E4" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="1.5pt"><path d="M 329.75 -115.49 L 354.69 -115.49 L 354.69 -140.43 L 329.75 -140.43 Z"></path></g><g fill="#F5F2E4" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="1.5pt"><path d="M 279.86 -140.43 L 304.8 -140.43 L 304.8 -165.38 L 279.86 -165.38 Z"></path></g><g fill="#F5F2E4" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="1.5pt"><path d="M 304.8 -140.43 L 329.75 -140.43 L 329.75 -165.38 L 304.8 -165.38 Z"></path></g><g fill="#F5F2E4" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="1.5pt"><path d="M 329.75 -140.43 L 354.69 -140.43 L 354.69 -165.38 L 329.75 -165.38 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 56.84 -146.12 C 56.84 -145.41 57.41 -144.84 58.12 -144.84 C 58.82 -144.84 59.39 -145.41 59.39 -146.12 C 59.39 -146.81 58.82 -147.38 58.12 -147.38 C 57.41 -147.38 56.84 -146.81 56.84 -146.12 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 56.84 -152.27 C 56.84 -151.57 57.41 -151 58.12 -151 C 58.82 -151 59.39 -151.57 59.39 -152.27 C 59.39 -152.98 58.82 -153.55 58.12 -153.55 C 57.41 -153.55 56.84 -152.98 56.84 -152.27 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 56.84 -158.43 C 56.84 -157.72 57.41 -157.15 58.12 -157.15 C 58.82 -157.15 59.39 -157.72 59.39 -158.43 C 59.39 -159.13 58.82 -159.7 58.12 -159.7 C 57.41 -159.7 56.84 -159.13 56.84 -158.43 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 170.99 -146.64 C 170.99 -145.93 171.56 -145.36 172.27 -145.36 C 172.98 -145.36 173.55 -145.93 173.55 -146.64 C 173.55 -147.33 172.98 -147.9 172.27 -147.9 C 171.56 -147.9 170.99 -147.33 170.99 -146.64 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 170.99 -152.79 C 170.99 -152.09 171.56 -151.52 172.27 -151.52 C 172.98 -151.52 173.55 -152.09 173.55 -152.79 C 173.55 -153.5 172.98 -154.07 172.27 -154.07 C 171.56 -154.07 170.99 -153.5 170.99 -152.79 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 170.99 -158.95 C 170.99 -158.24 171.56 -157.67 172.27 -157.67 C 172.98 -157.67 173.55 -158.24 173.55 -158.95 C 173.55 -159.65 172.98 -160.22 172.27 -160.22 C 171.56 -160.22 170.99 -159.65 170.99 -158.95 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 425.77 -145.6 C 425.77 -144.89 426.34 -144.32 427.04 -144.32 C 427.75 -144.32 428.32 -144.89 428.32 -145.6 C 428.32 -146.3 427.75 -146.87 427.04 -146.87 C 426.34 -146.87 425.77 -146.3 425.77 -145.6 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 425.77 -151.75 C 425.77 -151.05 426.34 -150.48 427.04 -150.48 C 427.75 -150.48 428.32 -151.05 428.32 -151.75 C 428.32 -152.46 427.75 -153.03 427.04 -153.03 C 426.34 -153.03 425.77 -152.46 425.77 -151.75 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 425.77 -157.91 C 425.77 -157.2 426.34 -156.63 427.04 -156.63 C 427.75 -156.63 428.32 -157.2 428.32 -157.91 C 428.32 -158.61 427.75 -159.18 427.04 -159.18 C 426.34 -159.18 425.77 -158.61 425.77 -157.91 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 527.3 -146.12 C 527.3 -145.41 527.87 -144.84 528.57 -144.84 C 529.28 -144.84 529.85 -145.41 529.85 -146.12 C 529.85 -146.81 529.28 -147.38 528.57 -147.38 C 527.87 -147.38 527.3 -146.81 527.3 -146.12 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 527.3 -152.27 C 527.3 -151.57 527.87 -151 528.57 -151 C 529.28 -151 529.85 -151.57 529.85 -152.27 C 529.85 -152.98 529.28 -153.55 528.57 -153.55 C 527.87 -153.55 527.3 -152.98 527.3 -152.27 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" fill-opacity="1" stroke="#4A4A4A" stroke-opacity="1"><path d="M 527.3 -158.43 C 527.3 -157.72 527.87 -157.15 528.57 -157.15 C 529.28 -157.15 529.85 -157.72 529.85 -158.43 C 529.85 -159.13 529.28 -159.7 528.57 -159.7 C 527.87 -159.7 527.3 -159.13 527.3 -158.43 Z"></path></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1" stroke-width="1.5pt"><path d="M 135.95 -60.45 L 208.59 -60.45 L 208.59 -133.09 L 135.95 -133.09 Z" style="fill:none"></path></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1" stroke-width="1.5pt"><path d="M 21.79 -60.45 L 94.44 -60.45 L 94.44 -133.09 L 21.79 -133.09 Z" style="fill:none"></path></g><g color="#4A90E2" fill="#4A90E2" stroke="#4A90E2" stroke-opacity="1" stroke-width="1.5pt"><path d="M 135.95 -170.71 L 208.59 -170.71 L 208.59 -243.36 L 135.95 -243.36 Z" style="fill:none"></path></g><g color="#4A90E2" fill="#4A90E2" stroke="#4A90E2" stroke-opacity="1" stroke-width="1.5pt"><path d="M 21.79 -170.71 L 94.44 -170.71 L 94.44 -243.36 L 21.79 -243.36 Z" style="fill:none"></path></g><g color="#4A90E2" fill="#4A90E2" stroke="#4A90E2" stroke-opacity="1" stroke-width="1.5pt"><path d="M 390.72 -171.23 L 463.37 -171.23 L 463.37 -243.88 L 390.72 -243.88 Z" style="fill:none"></path></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1" stroke-width="1.5pt"><path d="M 390.72 -60.97 L 463.37 -60.97 L 463.37 -133.61 L 390.72 -133.61 Z" style="fill:none"></path></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1" stroke-width="1.5pt"><path d="M 492.25 -60.45 L 564.89 -60.45 L 564.89 -133.09 L 492.25 -133.09 Z" style="fill:none"></path></g><g color="#4A90E2" fill="#4A90E2" stroke="#4A90E2" stroke-opacity="1" stroke-width="1.5pt"><path d="M 492.25 -170.71 L 564.89 -170.71 L 564.89 -243.36 L 492.25 -243.36 Z" style="fill:none"></path></g><path d="M 317.28 -80.75" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 305.28 -87.75)"><foreignobject height="14" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="24"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="14" id="S3.F4.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/patch_2.png" width="24"/></foreignobject></g><g color="#4A90E2" fill="#4A90E2" stroke="#4A90E2" stroke-opacity="1"><path d="M 305.58 -73.82 L 328.93 -73.82 L 328.93 -87.95 L 305.58 -87.95 Z" style="fill:none"></path></g><path d="M 291.18 -80.88" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 279.68 -87.38)"><foreignobject height="13" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="23"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="13" id="S3.F4.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/patch_1.png" width="23"/></foreignobject></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1"><path d="M 279.68 -74.6 L 302.67 -74.6 L 302.67 -87.17 L 279.68 -87.17 Z" style="fill:none"></path></g><path d="M 264.2 -101.64" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 252.7 -108.14)"><foreignobject height="13" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="23"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="13" id="S3.F4.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/patch_1.png" width="23"/></foreignobject></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1"><path d="M 252.7 -95.35 L 275.68 -95.35 L 275.68 -107.93 L 252.7 -107.93 Z" style="fill:none"></path></g><path d="M 264.35 -127.45" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 252.35 -134.45)"><foreignobject height="14" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="24"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="14" id="S3.F4.1.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/patch_2.png" width="24"/></foreignobject></g><g color="#4A90E2" fill="#4A90E2" stroke="#4A90E2" stroke-opacity="1"><path d="M 252.66 -120.52 L 276.01 -120.52 L 276.01 -134.65 L 252.66 -134.65 Z" style="fill:none"></path></g><path d="M 276.3 -224.62" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 264.8 -231.12)"><foreignobject height="13" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="23"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="13" id="S3.F4.1.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/patch_1.png" width="23"/></foreignobject></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1"><path d="M 264.81 -218.33 L 287.8 -218.33 L 287.8 -230.9 L 264.81 -230.9 Z" style="fill:none"></path></g><path d="M 339.41 -224.32" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 327.41 -231.32)"><foreignobject height="14" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="24"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="14" id="S3.F4.1.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.g1" src="extracted/5867981/pic/patch_2.png" width="24"/></foreignobject></g><g color="#4A90E2" fill="#4A90E2" stroke="#4A90E2" stroke-opacity="1"><path d="M 327.76 -217.37 L 351.11 -217.37 L 351.11 -231.51 L 327.76 -231.51 Z" style="fill:none"></path></g><g color="#F5A623" fill="#F5A623" stroke="#F5A623" stroke-opacity="1" stroke-width="1.5pt"><path d="M 291.89 -220.63 L 320.88 -220.63" style="fill:none"></path></g><g fill="#F5A623" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 317.8 -224.11 L 325.03 -220.63 L 317.8 -217.15 Z"></path></g><g color="#4A90E2" fill="#4A90E2" stroke="#4A90E2" stroke-opacity="1" stroke-width="1.5pt"><path d="M 294.8 -229.35 L 323.79 -229.35" style="fill:none"></path></g><g fill="#4A90E2" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 297.88 -225.87 L 290.65 -229.35 L 297.88 -232.82 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 94.44 -152.81 L 133.87 -152.81" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 130.79 -156.29 L 138.02 -152.81 L 130.79 -149.34 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 202.89 -153.85 L 242.32 -153.85" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 239.24 -157.33 L 246.47 -153.85 L 239.24 -150.37 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 363.74 -155.93 L 403.18 -155.93" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 400.09 -159.4 L 407.33 -155.93 L 400.09 -152.45 Z"></path></g><g color="#4A4A4A" fill="#4A4A4A" stroke="#4A4A4A" stroke-opacity="1" stroke-width="1.5pt"><path d="M 305.62 -188.1 L 305.62 -205.74" style="fill:none"></path></g><g fill="#4A4A4A" fill-opacity="1" stroke-opacity="0" stroke-width="0.08pt"><path d="M 302.15 -202.66 L 305.62 -209.89 L 309.1 -202.66 Z"></path></g><path d="M 55.34 -254.51" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 40.3 -429.66)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 344.815)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 347.86)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="10.93" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="30.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.F4.1.pic1.15.15.15.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">Input</span></foreignobject></g></g></g></g><path d="M 170.64 -254.51" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 137.57 -428.51)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 343.675)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 348)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="8.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="66.14"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.F4.1.pic1.16.16.16.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">Initial Mask</span></foreignobject></g></g></g></g><path d="M 425.85 -254.51" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 388.54 -428.51)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 343.675)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 348)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="8.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="74.62"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.F4.1.pic1.17.17.17.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">Refined Mask</span></foreignobject></g></g></g></g><path d="M 526.69 -254.51" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 488.1 -428.51)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 343.675)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 348)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="8.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="78.33"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.F4.1.pic1.18.18.18.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">Ground Truth</span></foreignobject></g></g></g></g><path d="M 315.84 -167.89" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 285.03 -401.81)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 228.105)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 232.36)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="8.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="61.61"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.F4.1.pic1.19.19.19.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">IoU Matrix</span></foreignobject></g></g></g></g><path d="M 342.22 -152.91" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 336.45 -255.57)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 204.6)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 205.33)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">…</text></g></g></g></g><path d="M 342.22 -127.96" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 336.45 -213.99)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 171.34)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 172.07)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">…</text></g></g></g></g><path d="M 342.22 -103.02" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 336.45 -172.43)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 138.09)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 138.82)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">…</text></g></g></g></g><path d="M 317.28 -103.02" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 306.21 -175.71)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 141.375)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 145.39)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="22.14"><span class="ltx_text ltx_font_bold" id="S3.F4.1.pic1.20.20.20.1.1.1.1.1" style="font-size:90%;color:#DB594F;">0.16</span></foreignobject></g></g></g></g><path d="M 292.33 -127.96" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 281.26 -217.28)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 174.625)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 178.64)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="22.14"><span class="ltx_text ltx_font_bold" id="S3.F4.1.pic1.21.21.21.1.1.1.1.1" style="font-size:90%;color:#DB594F;">0.16</span></foreignobject></g></g></g></g><path d="M 292.33 -152.91" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 286.57 -255.57)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 204.6)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 205.33)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">…</text></g></g></g></g><path d="M 317.28 -152.91" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 311.51 -255.57)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 204.6)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 205.33)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">…</text></g></g></g></g><path d="M 292.33 -103.02" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 289.22 -175.71)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 141.375)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 145.39)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text ltx_font_bold" id="S3.F4.1.pic1.22.22.22.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">0</span></foreignobject></g></g></g></g><path d="M 317.28 -127.96" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 314.17 -217.28)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 174.625)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 178.64)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text ltx_font_bold" id="S3.F4.1.pic1.23.23.23.1.1.1.1.1" style="font-size:90%;color:#4A4A4A;">0</span></foreignobject></g></g></g></g><path d="M 310.74 -239.52" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 283.01 -403.82)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 323.98)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 328.6)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.24" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="55.46"><span class="ltx_text ltx_font_bold" id="S3.F4.1.pic1.24.24.24.1.1.1.1.1" style="color:#DB594F;">constrain</span></foreignobject></g></g></g></g><path d="M 116.23 -149.7" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 100.93 -148.14)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 205.135)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 207.9)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="11.07" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="30.6"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.F4.1.pic1.25.25.25.1.1.1.1.1" style="font-size:80%;">Eq.(9)</span></foreignobject></g></g></g></g><path d="M 224.68 -150.74" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 206.61 -149.18)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 206.515)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 209.28)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="11.07" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="36.13"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.F4.1.pic1.26.26.26.1.1.1.1.1" style="font-size:80%;">Eq.(10)</span></foreignobject></g></g></g></g><path d="M 385.53 -152.81" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 367.47 -151.26)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 209.285)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 212.05)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="11.07" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="36.13"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.F4.1.pic1.27.27.27.1.1.1.1.1" style="font-size:80%;">Eq.(13)</span></foreignobject></g></g></g></g><path d="M 307.7 -198.99" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 309.26 -337.19)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 270.855)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 273.62)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="11.07" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="36.13"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.F4.1.pic1.28.28.28.1.1.1.1.1" style="font-size:80%;">Eq.(12)</span></foreignobject></g></g></g></g><path d="M 303.55 -198.99" style="fill:none"></path><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 265.86 -337.19)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 270.855)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 273.62)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="11.07" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="36.13"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.F4.1.pic1.29.29.29.1.1.1.1.1" style="font-size:80%;">Eq.(11)</span></foreignobject></g></g></g></g></g></svg>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The process of negative prompt calibration. The positive and negative prompts are represented by red points (<span class="ltx_text" id="S3.F4.4.1" style="font-size:120%;color:#FF0000;">•</span>) and green points (<span class="ltx_text" id="S3.F4.5.2" style="font-size:120%;color:#00FF00;">•</span>), respectively. Different prompts input into SAM generates different initial masks. To refine these masks, an IoU matrix is calculated for each instance pair. Matrix values greater than 0 indicate that the two objects can act as negative constraints for each other. By using the positive prompt of one object as the new negative prompt for another and inputting it into SAM again, a refined mask is generated.
</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS3.SSS2.5.1.1">III-C</span>2 </span>Memory Bank Updating</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.3">During the self-training process of SAM, we also extract the features corresponding to the prompts for prototype prediction. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S2.F3" title="Figure 3 ‣ II-B Point-based supervision ‣ II Related Work ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">3</span></a> (b). Since the teacher model produces more stable features, we use its encoder output to extract the predicted features. Due to the dynamic nature of network training, we use a memory bank to maintain these features. Given the predicted instance feature <math alttext="f^{p}_{k}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><msubsup id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.2.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.2.cmml">f</mi><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml">k</mi><mi id="S3.SS3.SSS2.p1.1.m1.1.1.2.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.2">𝑓</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.3">𝑝</ci></apply><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">f^{p}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">italic_f start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> with a positive prompt from the teacher’s image encoder, we use the following rule to update the memory bank, where <math alttext="\mathcal{B}[0]" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.2.m2.1"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mrow id="S3.SS3.SSS2.p1.2.m2.1.2" xref="S3.SS3.SSS2.p1.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p1.2.m2.1.2.2" xref="S3.SS3.SSS2.p1.2.m2.1.2.2.cmml">ℬ</mi><mo id="S3.SS3.SSS2.p1.2.m2.1.2.1" xref="S3.SS3.SSS2.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p1.2.m2.1.2.3.2" xref="S3.SS3.SSS2.p1.2.m2.1.2.3.1.cmml"><mo id="S3.SS3.SSS2.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS2.p1.2.m2.1.2.3.1.1.cmml">[</mo><mn id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">0</mn><mo id="S3.SS3.SSS2.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS2.p1.2.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><apply id="S3.SS3.SSS2.p1.2.m2.1.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.2"><times id="S3.SS3.SSS2.p1.2.m2.1.2.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.2.1"></times><ci id="S3.SS3.SSS2.p1.2.m2.1.2.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.2.2">ℬ</ci><apply id="S3.SS3.SSS2.p1.2.m2.1.2.3.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.2.3.2"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.2.m2.1.2.3.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.2.3.2.1">delimited-[]</csymbol><cn id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS3.SSS2.p1.2.m2.1.1">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">\mathcal{B}[0]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.2.m2.1d">caligraphic_B [ 0 ]</annotation></semantics></math> refers to the first element in the queue and <math alttext="\backslash" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.3.m3.1"><semantics id="S3.SS3.SSS2.p1.3.m3.1a"><mo id="S3.SS3.SSS2.p1.3.m3.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m3.1b"><ci id="S3.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m3.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.3.m3.1d">\</annotation></semantics></math> represents a deletion operation.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\vspace{-0.1cm}\mathcal{B}=\mathcal{B}\bigcup f_{k}^{c},\quad\mathcal{B}=%
\mathcal{B}\setminus\mathcal{B}[0]" class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.3.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml">ℬ</mi><mo id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.1.1.3.2" xref="S3.E4.m1.2.2.1.1.3.2.cmml">ℬ</mi><mo id="S3.E4.m1.2.2.1.1.3.1" xref="S3.E4.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.1.1.3.3" xref="S3.E4.m1.2.2.1.1.3.3.cmml"><mo id="S3.E4.m1.2.2.1.1.3.3.1" movablelimits="false" xref="S3.E4.m1.2.2.1.1.3.3.1.cmml">⋃</mo><msubsup id="S3.E4.m1.2.2.1.1.3.3.2" xref="S3.E4.m1.2.2.1.1.3.3.2.cmml"><mi id="S3.E4.m1.2.2.1.1.3.3.2.2.2" xref="S3.E4.m1.2.2.1.1.3.3.2.2.2.cmml">f</mi><mi id="S3.E4.m1.2.2.1.1.3.3.2.2.3" xref="S3.E4.m1.2.2.1.1.3.3.2.2.3.cmml">k</mi><mi id="S3.E4.m1.2.2.1.1.3.3.2.3" xref="S3.E4.m1.2.2.1.1.3.3.2.3.cmml">c</mi></msubsup></mrow></mrow></mrow><mo id="S3.E4.m1.3.3.2.3" rspace="1.167em" xref="S3.E4.m1.3.3.3a.cmml">,</mo><mrow id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.2.2.2" xref="S3.E4.m1.3.3.2.2.2.cmml">ℬ</mi><mo id="S3.E4.m1.3.3.2.2.1" xref="S3.E4.m1.3.3.2.2.1.cmml">=</mo><mrow id="S3.E4.m1.3.3.2.2.3" xref="S3.E4.m1.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.2.2.3.2" xref="S3.E4.m1.3.3.2.2.3.2.cmml">ℬ</mi><mo id="S3.E4.m1.3.3.2.2.3.1" xref="S3.E4.m1.3.3.2.2.3.1.cmml">∖</mo><mrow id="S3.E4.m1.3.3.2.2.3.3" xref="S3.E4.m1.3.3.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.2.2.3.3.2" xref="S3.E4.m1.3.3.2.2.3.3.2.cmml">ℬ</mi><mo id="S3.E4.m1.3.3.2.2.3.3.1" xref="S3.E4.m1.3.3.2.2.3.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.2.2.3.3.3.2" xref="S3.E4.m1.3.3.2.2.3.3.3.1.cmml"><mo id="S3.E4.m1.3.3.2.2.3.3.3.2.1" stretchy="false" xref="S3.E4.m1.3.3.2.2.3.3.3.1.1.cmml">[</mo><mn id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">0</mn><mo id="S3.E4.m1.3.3.2.2.3.3.3.2.2" stretchy="false" xref="S3.E4.m1.3.3.2.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3a.cmml" xref="S3.E4.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1"><eq id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"></eq><ci id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2">ℬ</ci><apply id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3"><times id="S3.E4.m1.2.2.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3.1"></times><ci id="S3.E4.m1.2.2.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.2">ℬ</ci><apply id="S3.E4.m1.2.2.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3"><union id="S3.E4.m1.2.2.1.1.3.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3.3.1"></union><apply id="S3.E4.m1.2.2.1.1.3.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.3.2.1.cmml" xref="S3.E4.m1.2.2.1.1.3.3.2">superscript</csymbol><apply id="S3.E4.m1.2.2.1.1.3.3.2.2.cmml" xref="S3.E4.m1.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.3.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.3.3.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.3.3.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.3.3.2.2.2">𝑓</ci><ci id="S3.E4.m1.2.2.1.1.3.3.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3.2.2.3">𝑘</ci></apply><ci id="S3.E4.m1.2.2.1.1.3.3.2.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3.2.3">𝑐</ci></apply></apply></apply></apply><apply id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.2"><eq id="S3.E4.m1.3.3.2.2.1.cmml" xref="S3.E4.m1.3.3.2.2.1"></eq><ci id="S3.E4.m1.3.3.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2">ℬ</ci><apply id="S3.E4.m1.3.3.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.3"><setdiff id="S3.E4.m1.3.3.2.2.3.1.cmml" xref="S3.E4.m1.3.3.2.2.3.1"></setdiff><ci id="S3.E4.m1.3.3.2.2.3.2.cmml" xref="S3.E4.m1.3.3.2.2.3.2">ℬ</ci><apply id="S3.E4.m1.3.3.2.2.3.3.cmml" xref="S3.E4.m1.3.3.2.2.3.3"><times id="S3.E4.m1.3.3.2.2.3.3.1.cmml" xref="S3.E4.m1.3.3.2.2.3.3.1"></times><ci id="S3.E4.m1.3.3.2.2.3.3.2.cmml" xref="S3.E4.m1.3.3.2.2.3.3.2">ℬ</ci><apply id="S3.E4.m1.3.3.2.2.3.3.3.1.cmml" xref="S3.E4.m1.3.3.2.2.3.3.3.2"><csymbol cd="latexml" id="S3.E4.m1.3.3.2.2.3.3.3.1.1.cmml" xref="S3.E4.m1.3.3.2.2.3.3.3.2.1">delimited-[]</csymbol><cn id="S3.E4.m1.1.1.cmml" type="integer" xref="S3.E4.m1.1.1">0</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\vspace{-0.1cm}\mathcal{B}=\mathcal{B}\bigcup f_{k}^{c},\quad\mathcal{B}=%
\mathcal{B}\setminus\mathcal{B}[0]</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">caligraphic_B = caligraphic_B ⋃ italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT , caligraphic_B = caligraphic_B ∖ caligraphic_B [ 0 ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p2.3">Note that <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.1.m1.1"><semantics id="S3.SS3.SSS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p2.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b"><ci id="S3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.1.m1.1d">caligraphic_B</annotation></semantics></math> is initialized as an empty set <math alttext="\mathcal{B}=\emptyset" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.2.m2.1"><semantics id="S3.SS3.SSS2.p2.2.m2.1a"><mrow id="S3.SS3.SSS2.p2.2.m2.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p2.2.m2.1.1.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml">ℬ</mi><mo id="S3.SS3.SSS2.p2.2.m2.1.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.1.cmml">=</mo><mi id="S3.SS3.SSS2.p2.2.m2.1.1.3" mathvariant="normal" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.1b"><apply id="S3.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1"><eq id="S3.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.1"></eq><ci id="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.2">ℬ</ci><emptyset id="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.1c">\mathcal{B}=\emptyset</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.2.m2.1d">caligraphic_B = ∅</annotation></semantics></math> at the beginning of training. We fill the queue with features using the teacher model without dequeue until <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.3.m3.1"><semantics id="S3.SS3.SSS2.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p2.3.m3.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m3.1b"><ci id="S3.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m3.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.3.m3.1d">caligraphic_B</annotation></semantics></math> reaches the predefined length.
The update mechanism follows a first-in, first-out (FIFO) approach to dynamically update the predicted feature information and prevent the features from becoming outdated.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p3">
<p class="ltx_p" id="S3.SS3.SSS2.p3.5">Similar to the generation of target prototypes, we also utilize the FINCH <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite> algorithm to cluster the features in the memory bank <math alttext="\mathcal{B}=\left\{f_{1}^{p},f_{2}^{p},\cdots,f_{K}^{p}\right\}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.1.m1.4"><semantics id="S3.SS3.SSS2.p3.1.m1.4a"><mrow id="S3.SS3.SSS2.p3.1.m1.4.4" xref="S3.SS3.SSS2.p3.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.1.m1.4.4.5" xref="S3.SS3.SSS2.p3.1.m1.4.4.5.cmml">ℬ</mi><mo id="S3.SS3.SSS2.p3.1.m1.4.4.4" xref="S3.SS3.SSS2.p3.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS2.p3.1.m1.4.4.3.3" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.4.cmml"><mo id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.4" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.4.cmml">{</mo><msubsup id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.2.2" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.2.2.cmml">f</mi><mn id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.2.3" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.2.3.cmml">1</mn><mi id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.3" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.3.cmml">p</mi></msubsup><mo id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.5" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.2.2" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.2.2.cmml">f</mi><mn id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.2.3" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.2.3.cmml">2</mn><mi id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.3" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.3.cmml">p</mi></msubsup><mo id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.6" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS3.SSS2.p3.1.m1.1.1" mathvariant="normal" xref="S3.SS3.SSS2.p3.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.7" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.2.2" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.2.2.cmml">f</mi><mi id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.2.3" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.2.3.cmml">K</mi><mi id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.3" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.3.cmml">p</mi></msubsup><mo id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.8" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.1.m1.4b"><apply id="S3.SS3.SSS2.p3.1.m1.4.4.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4"><eq id="S3.SS3.SSS2.p3.1.m1.4.4.4.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.4"></eq><ci id="S3.SS3.SSS2.p3.1.m1.4.4.5.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.5">ℬ</ci><set id="S3.SS3.SSS2.p3.1.m1.4.4.3.4.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3"><apply id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.2.2">𝑓</ci><cn id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.2.2.1.1.1.3">𝑝</ci></apply><apply id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.2.2">𝑓</ci><cn id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.3.3.2.2.2.3">𝑝</ci></apply><ci id="S3.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1">⋯</ci><apply id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3">superscript</csymbol><apply id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.2.2">𝑓</ci><ci id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.2.3">𝐾</ci></apply><ci id="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.4.4.3.3.3.3">𝑝</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.1.m1.4c">\mathcal{B}=\left\{f_{1}^{p},f_{2}^{p},\cdots,f_{K}^{p}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.1.m1.4d">caligraphic_B = { italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT , italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT , ⋯ , italic_f start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT }</annotation></semantics></math>. Suppose <math alttext="C^{p}_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.2.m2.1"><semantics id="S3.SS3.SSS2.p3.2.m2.1a"><msubsup id="S3.SS3.SSS2.p3.2.m2.1.1" xref="S3.SS3.SSS2.p3.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.1.1.2.2" xref="S3.SS3.SSS2.p3.2.m2.1.1.2.2.cmml">C</mi><mi id="S3.SS3.SSS2.p3.2.m2.1.1.3" xref="S3.SS3.SSS2.p3.2.m2.1.1.3.cmml">j</mi><mi id="S3.SS3.SSS2.p3.2.m2.1.1.2.3" xref="S3.SS3.SSS2.p3.2.m2.1.1.2.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.2.m2.1b"><apply id="S3.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.2.2">𝐶</ci><ci id="S3.SS3.SSS2.p3.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.2.3">𝑝</ci></apply><ci id="S3.SS3.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.2.m2.1c">C^{p}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.2.m2.1d">italic_C start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.3.m3.1"><semantics id="S3.SS3.SSS2.p3.3.m3.1a"><mi id="S3.SS3.SSS2.p3.3.m3.1.1" xref="S3.SS3.SSS2.p3.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.3.m3.1b"><ci id="S3.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.3.m3.1d">italic_j</annotation></semantics></math>-th cluster in <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.4.m4.1"><semantics id="S3.SS3.SSS2.p3.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.4.m4.1.1" xref="S3.SS3.SSS2.p3.4.m4.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.4.m4.1b"><ci id="S3.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p3.4.m4.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.4.m4.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.4.m4.1d">caligraphic_B</annotation></semantics></math>, the predicted prototypes <math alttext="\mathcal{P}^{p}_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.5.m5.1"><semantics id="S3.SS3.SSS2.p3.5.m5.1a"><msubsup id="S3.SS3.SSS2.p3.5.m5.1.1" xref="S3.SS3.SSS2.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p3.5.m5.1.1.2.2" xref="S3.SS3.SSS2.p3.5.m5.1.1.2.2.cmml">𝒫</mi><mi id="S3.SS3.SSS2.p3.5.m5.1.1.3" xref="S3.SS3.SSS2.p3.5.m5.1.1.3.cmml">j</mi><mi id="S3.SS3.SSS2.p3.5.m5.1.1.2.3" xref="S3.SS3.SSS2.p3.5.m5.1.1.2.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.5.m5.1b"><apply id="S3.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.5.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1">subscript</csymbol><apply id="S3.SS3.SSS2.p3.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1">superscript</csymbol><ci id="S3.SS3.SSS2.p3.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1.2.2">𝒫</ci><ci id="S3.SS3.SSS2.p3.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1.2.3">𝑝</ci></apply><ci id="S3.SS3.SSS2.p3.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p3.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.5.m5.1c">\mathcal{P}^{p}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.5.m5.1d">caligraphic_P start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> can be defined as:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{P}^{p}_{j}=\frac{1}{\left|C^{p}_{j}\right|}\sum_{f_{k}^{p}\in C^{p}_{%
j}}f_{k}^{p}" class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.2" xref="S3.E5.m1.1.2.cmml"><msubsup id="S3.E5.m1.1.2.2" xref="S3.E5.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.2.2.2.2" xref="S3.E5.m1.1.2.2.2.2.cmml">𝒫</mi><mi id="S3.E5.m1.1.2.2.3" xref="S3.E5.m1.1.2.2.3.cmml">j</mi><mi id="S3.E5.m1.1.2.2.2.3" xref="S3.E5.m1.1.2.2.2.3.cmml">p</mi></msubsup><mo id="S3.E5.m1.1.2.1" xref="S3.E5.m1.1.2.1.cmml">=</mo><mrow id="S3.E5.m1.1.2.3" xref="S3.E5.m1.1.2.3.cmml"><mfrac id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mn id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml">1</mn><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.2.cmml"><mo id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.1.cmml">|</mo><msubsup id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.2.2.cmml">C</mi><mi id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml">j</mi><mi id="S3.E5.m1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.2.3.cmml">p</mi></msubsup><mo id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E5.m1.1.2.3.1" xref="S3.E5.m1.1.2.3.1.cmml">⁢</mo><mrow id="S3.E5.m1.1.2.3.2" xref="S3.E5.m1.1.2.3.2.cmml"><munder id="S3.E5.m1.1.2.3.2.1" xref="S3.E5.m1.1.2.3.2.1.cmml"><mo id="S3.E5.m1.1.2.3.2.1.2" movablelimits="false" xref="S3.E5.m1.1.2.3.2.1.2.cmml">∑</mo><mrow id="S3.E5.m1.1.2.3.2.1.3" xref="S3.E5.m1.1.2.3.2.1.3.cmml"><msubsup id="S3.E5.m1.1.2.3.2.1.3.2" xref="S3.E5.m1.1.2.3.2.1.3.2.cmml"><mi id="S3.E5.m1.1.2.3.2.1.3.2.2.2" xref="S3.E5.m1.1.2.3.2.1.3.2.2.2.cmml">f</mi><mi id="S3.E5.m1.1.2.3.2.1.3.2.2.3" xref="S3.E5.m1.1.2.3.2.1.3.2.2.3.cmml">k</mi><mi id="S3.E5.m1.1.2.3.2.1.3.2.3" xref="S3.E5.m1.1.2.3.2.1.3.2.3.cmml">p</mi></msubsup><mo id="S3.E5.m1.1.2.3.2.1.3.1" xref="S3.E5.m1.1.2.3.2.1.3.1.cmml">∈</mo><msubsup id="S3.E5.m1.1.2.3.2.1.3.3" xref="S3.E5.m1.1.2.3.2.1.3.3.cmml"><mi id="S3.E5.m1.1.2.3.2.1.3.3.2.2" xref="S3.E5.m1.1.2.3.2.1.3.3.2.2.cmml">C</mi><mi id="S3.E5.m1.1.2.3.2.1.3.3.3" xref="S3.E5.m1.1.2.3.2.1.3.3.3.cmml">j</mi><mi id="S3.E5.m1.1.2.3.2.1.3.3.2.3" xref="S3.E5.m1.1.2.3.2.1.3.3.2.3.cmml">p</mi></msubsup></mrow></munder><msubsup id="S3.E5.m1.1.2.3.2.2" xref="S3.E5.m1.1.2.3.2.2.cmml"><mi id="S3.E5.m1.1.2.3.2.2.2.2" xref="S3.E5.m1.1.2.3.2.2.2.2.cmml">f</mi><mi id="S3.E5.m1.1.2.3.2.2.2.3" xref="S3.E5.m1.1.2.3.2.2.2.3.cmml">k</mi><mi id="S3.E5.m1.1.2.3.2.2.3" xref="S3.E5.m1.1.2.3.2.2.3.cmml">p</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.2.cmml" xref="S3.E5.m1.1.2"><eq id="S3.E5.m1.1.2.1.cmml" xref="S3.E5.m1.1.2.1"></eq><apply id="S3.E5.m1.1.2.2.cmml" xref="S3.E5.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.2.1.cmml" xref="S3.E5.m1.1.2.2">subscript</csymbol><apply id="S3.E5.m1.1.2.2.2.cmml" xref="S3.E5.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.2.2.1.cmml" xref="S3.E5.m1.1.2.2">superscript</csymbol><ci id="S3.E5.m1.1.2.2.2.2.cmml" xref="S3.E5.m1.1.2.2.2.2">𝒫</ci><ci id="S3.E5.m1.1.2.2.2.3.cmml" xref="S3.E5.m1.1.2.2.2.3">𝑝</ci></apply><ci id="S3.E5.m1.1.2.2.3.cmml" xref="S3.E5.m1.1.2.2.3">𝑗</ci></apply><apply id="S3.E5.m1.1.2.3.cmml" xref="S3.E5.m1.1.2.3"><times id="S3.E5.m1.1.2.3.1.cmml" xref="S3.E5.m1.1.2.3.1"></times><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><divide id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1"></divide><cn id="S3.E5.m1.1.1.3.cmml" type="integer" xref="S3.E5.m1.1.1.3">1</cn><apply id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1"><abs id="S3.E5.m1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2"></abs><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2">𝐶</ci><ci id="S3.E5.m1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="S3.E5.m1.1.2.3.2.cmml" xref="S3.E5.m1.1.2.3.2"><apply id="S3.E5.m1.1.2.3.2.1.cmml" xref="S3.E5.m1.1.2.3.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.2.1.1.cmml" xref="S3.E5.m1.1.2.3.2.1">subscript</csymbol><sum id="S3.E5.m1.1.2.3.2.1.2.cmml" xref="S3.E5.m1.1.2.3.2.1.2"></sum><apply id="S3.E5.m1.1.2.3.2.1.3.cmml" xref="S3.E5.m1.1.2.3.2.1.3"><in id="S3.E5.m1.1.2.3.2.1.3.1.cmml" xref="S3.E5.m1.1.2.3.2.1.3.1"></in><apply id="S3.E5.m1.1.2.3.2.1.3.2.cmml" xref="S3.E5.m1.1.2.3.2.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.2.1.3.2.1.cmml" xref="S3.E5.m1.1.2.3.2.1.3.2">superscript</csymbol><apply id="S3.E5.m1.1.2.3.2.1.3.2.2.cmml" xref="S3.E5.m1.1.2.3.2.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.2.1.3.2.2.1.cmml" xref="S3.E5.m1.1.2.3.2.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.2.3.2.1.3.2.2.2.cmml" xref="S3.E5.m1.1.2.3.2.1.3.2.2.2">𝑓</ci><ci id="S3.E5.m1.1.2.3.2.1.3.2.2.3.cmml" xref="S3.E5.m1.1.2.3.2.1.3.2.2.3">𝑘</ci></apply><ci id="S3.E5.m1.1.2.3.2.1.3.2.3.cmml" xref="S3.E5.m1.1.2.3.2.1.3.2.3">𝑝</ci></apply><apply id="S3.E5.m1.1.2.3.2.1.3.3.cmml" xref="S3.E5.m1.1.2.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.2.1.3.3.1.cmml" xref="S3.E5.m1.1.2.3.2.1.3.3">subscript</csymbol><apply id="S3.E5.m1.1.2.3.2.1.3.3.2.cmml" xref="S3.E5.m1.1.2.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.2.1.3.3.2.1.cmml" xref="S3.E5.m1.1.2.3.2.1.3.3">superscript</csymbol><ci id="S3.E5.m1.1.2.3.2.1.3.3.2.2.cmml" xref="S3.E5.m1.1.2.3.2.1.3.3.2.2">𝐶</ci><ci id="S3.E5.m1.1.2.3.2.1.3.3.2.3.cmml" xref="S3.E5.m1.1.2.3.2.1.3.3.2.3">𝑝</ci></apply><ci id="S3.E5.m1.1.2.3.2.1.3.3.3.cmml" xref="S3.E5.m1.1.2.3.2.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E5.m1.1.2.3.2.2.cmml" xref="S3.E5.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.2.2.1.cmml" xref="S3.E5.m1.1.2.3.2.2">superscript</csymbol><apply id="S3.E5.m1.1.2.3.2.2.2.cmml" xref="S3.E5.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.2.2.2.1.cmml" xref="S3.E5.m1.1.2.3.2.2">subscript</csymbol><ci id="S3.E5.m1.1.2.3.2.2.2.2.cmml" xref="S3.E5.m1.1.2.3.2.2.2.2">𝑓</ci><ci id="S3.E5.m1.1.2.3.2.2.2.3.cmml" xref="S3.E5.m1.1.2.3.2.2.2.3">𝑘</ci></apply><ci id="S3.E5.m1.1.2.3.2.2.3.cmml" xref="S3.E5.m1.1.2.3.2.2.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathcal{P}^{p}_{j}=\frac{1}{\left|C^{p}_{j}\right|}\sum_{f_{k}^{p}\in C^{p}_{%
j}}f_{k}^{p}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">caligraphic_P start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG | italic_C start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT ∈ italic_C start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S3.SS3.SSS3.5.1.1">III-C</span>3 </span>Hungarian Matching</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.2">Since the target prototypes <math alttext="\{\mathcal{P}^{t}_{i}\}_{i=1\cdots I}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.1.m1.1"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><msub id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml"><mrow id="S3.SS3.SSS3.p1.1.m1.1.1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.2.cmml">𝒫</mi><mi id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS3.p1.1.m1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.SSS3.p1.1.m1.1.1.3.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.1.cmml">=</mo><mrow id="S3.SS3.SSS3.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.cmml"><mn id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.2.cmml">1</mn><mo id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.3" mathvariant="normal" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.3.cmml">⋯</mi><mo id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.1a" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.4" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.4.cmml">I</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><apply id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">subscript</csymbol><set id="S3.SS3.SSS3.p1.1.m1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1"><apply id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.2">𝒫</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3"><eq id="S3.SS3.SSS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.1"></eq><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.2">𝑖</ci><apply id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3"><times id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.1"></times><cn id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.2">1</cn><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.3">⋯</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.4">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">\{\mathcal{P}^{t}_{i}\}_{i=1\cdots I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.1.m1.1d">{ caligraphic_P start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 ⋯ italic_I end_POSTSUBSCRIPT</annotation></semantics></math> and predicted prototypes <math alttext="\{\mathcal{P}^{p}_{j}\}_{j=1\cdots J}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.2.m2.1"><semantics id="S3.SS3.SSS3.p1.2.m2.1a"><msub id="S3.SS3.SSS3.p1.2.m2.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.cmml"><mrow id="S3.SS3.SSS3.p1.2.m2.1.1.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.2.cmml">{</mo><msubsup id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.2.2" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.2.2.cmml">𝒫</mi><mi id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.3" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.3.cmml">j</mi><mi id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.2.3" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.2.3.cmml">p</mi></msubsup><mo id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS3.p1.2.m2.1.1.3" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS3.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.2.cmml">j</mi><mo id="S3.SS3.SSS3.p1.2.m2.1.1.3.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.1.cmml">=</mo><mrow id="S3.SS3.SSS3.p1.2.m2.1.1.3.3" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3.cmml"><mn id="S3.SS3.SSS3.p1.2.m2.1.1.3.3.2" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3.2.cmml">1</mn><mo id="S3.SS3.SSS3.p1.2.m2.1.1.3.3.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p1.2.m2.1.1.3.3.3" mathvariant="normal" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3.3.cmml">⋯</mi><mo id="S3.SS3.SSS3.p1.2.m2.1.1.3.3.1a" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p1.2.m2.1.1.3.3.4" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3.4.cmml">J</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.2.m2.1b"><apply id="S3.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1">subscript</csymbol><set id="S3.SS3.SSS3.p1.2.m2.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1"><apply id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.2.2">𝒫</ci><ci id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S3.SS3.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3"><eq id="S3.SS3.SSS3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.1"></eq><ci id="S3.SS3.SSS3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.2">𝑗</ci><apply id="S3.SS3.SSS3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3"><times id="S3.SS3.SSS3.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3.1"></times><cn id="S3.SS3.SSS3.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3.2">1</cn><ci id="S3.SS3.SSS3.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3.3">⋯</ci><ci id="S3.SS3.SSS3.p1.2.m2.1.1.3.3.4.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.3.4">𝐽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.2.m2.1c">\{\mathcal{P}^{p}_{j}\}_{j=1\cdots J}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.2.m2.1d">{ caligraphic_P start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j = 1 ⋯ italic_J end_POSTSUBSCRIPT</annotation></semantics></math> cannot be definitively matched one-to-one in order, it is not feasible to use a simple metric function to enforce their consistency. Inspired by the instance matching in DETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib64" title=""><span class="ltx_text" style="font-size:90%;">64</span></a>]</cite>, we use Hungarian Matching here for computing feature similarity. Then we will describe the specific process.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p2">
<p class="ltx_p" id="S3.SS3.SSS3.p2.6">Define a distance matrix <math alttext="\mathbf{D}\in\mathbb{R}^{K_{t}\times K_{p}}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.1.m1.1"><semantics id="S3.SS3.SSS3.p2.1.m1.1a"><mrow id="S3.SS3.SSS3.p2.1.m1.1.1" xref="S3.SS3.SSS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.1.1.2" xref="S3.SS3.SSS3.p2.1.m1.1.1.2.cmml">𝐃</mi><mo id="S3.SS3.SSS3.p2.1.m1.1.1.1" xref="S3.SS3.SSS3.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS3.p2.1.m1.1.1.3" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.1.1.3.2" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS3.p2.1.m1.1.1.3.3" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.cmml"><msub id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.2" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.2.cmml">K</mi><mi id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.3" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.3.cmml">t</mi></msub><mo id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.2" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.2.cmml">K</mi><mi id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.3" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.3.cmml">p</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.1.m1.1b"><apply id="S3.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1"><in id="S3.SS3.SSS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.1"></in><ci id="S3.SS3.SSS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.2">𝐃</ci><apply id="S3.SS3.SSS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3"><times id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.1"></times><apply id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.2">𝐾</ci><ci id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.2.3">𝑡</ci></apply><apply id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.2">𝐾</ci><ci id="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1.3.3.3.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.1.m1.1c">\mathbf{D}\in\mathbb{R}^{K_{t}\times K_{p}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.1.m1.1d">bold_D ∈ blackboard_R start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT × italic_K start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where each element <math alttext="\mathbf{D}_{ij}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.2.m2.1"><semantics id="S3.SS3.SSS3.p2.2.m2.1a"><msub id="S3.SS3.SSS3.p2.2.m2.1.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.1.1.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.2.cmml">𝐃</mi><mrow id="S3.SS3.SSS3.p2.2.m2.1.1.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.1.1.3.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS3.SSS3.p2.2.m2.1.1.3.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS3.p2.2.m2.1.1.3.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.2.m2.1b"><apply id="S3.SS3.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.2">𝐃</ci><apply id="S3.SS3.SSS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3"><times id="S3.SS3.SSS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.1"></times><ci id="S3.SS3.SSS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.2">𝑖</ci><ci id="S3.SS3.SSS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.2.m2.1c">\mathbf{D}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.2.m2.1d">bold_D start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the distance between the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.3.m3.1"><semantics id="S3.SS3.SSS3.p2.3.m3.1a"><mi id="S3.SS3.SSS3.p2.3.m3.1.1" xref="S3.SS3.SSS3.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.3.m3.1b"><ci id="S3.SS3.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.3.m3.1d">italic_i</annotation></semantics></math>-th target prototype <math alttext="\mathcal{P}^{t}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.4.m4.1"><semantics id="S3.SS3.SSS3.p2.4.m4.1a"><msubsup id="S3.SS3.SSS3.p2.4.m4.1.1" xref="S3.SS3.SSS3.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p2.4.m4.1.1.2.2" xref="S3.SS3.SSS3.p2.4.m4.1.1.2.2.cmml">𝒫</mi><mi id="S3.SS3.SSS3.p2.4.m4.1.1.3" xref="S3.SS3.SSS3.p2.4.m4.1.1.3.cmml">i</mi><mi id="S3.SS3.SSS3.p2.4.m4.1.1.2.3" xref="S3.SS3.SSS3.p2.4.m4.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.4.m4.1b"><apply id="S3.SS3.SSS3.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p2.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.2.2">𝒫</ci><ci id="S3.SS3.SSS3.p2.4.m4.1.1.2.3.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.4.m4.1c">\mathcal{P}^{t}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.4.m4.1d">caligraphic_P start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.5.m5.1"><semantics id="S3.SS3.SSS3.p2.5.m5.1a"><mi id="S3.SS3.SSS3.p2.5.m5.1.1" xref="S3.SS3.SSS3.p2.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.5.m5.1b"><ci id="S3.SS3.SSS3.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.5.m5.1d">italic_j</annotation></semantics></math>-th predicted prototype <math alttext="\mathcal{P}^{p}_{j}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.6.m6.1"><semantics id="S3.SS3.SSS3.p2.6.m6.1a"><msubsup id="S3.SS3.SSS3.p2.6.m6.1.1" xref="S3.SS3.SSS3.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p2.6.m6.1.1.2.2" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.2.cmml">𝒫</mi><mi id="S3.SS3.SSS3.p2.6.m6.1.1.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.cmml">j</mi><mi id="S3.SS3.SSS3.p2.6.m6.1.1.2.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.6.m6.1b"><apply id="S3.SS3.SSS3.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1">subscript</csymbol><apply id="S3.SS3.SSS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.6.m6.1.1.2.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p2.6.m6.1.1.2.2.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.2">𝒫</ci><ci id="S3.SS3.SSS3.p2.6.m6.1.1.2.3.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.3">𝑝</ci></apply><ci id="S3.SS3.SSS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.6.m6.1c">\mathcal{P}^{p}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.6.m6.1d">caligraphic_P start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. Typically, Euclidean distance or cosine similarity is used to compute this distance. Here, we use the latter one as an example to illustrate:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{D}_{ij}=1-\frac{\mathcal{P}^{t}_{i}\cdot\mathcal{P}^{p}_{j}}{\|%
\mathcal{P}^{t}_{i}\|\|\mathcal{P}^{p}_{j}\|}" class="ltx_Math" display="block" id="S3.E6.m1.2"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.3" xref="S3.E6.m1.2.3.cmml"><msub id="S3.E6.m1.2.3.2" xref="S3.E6.m1.2.3.2.cmml"><mi id="S3.E6.m1.2.3.2.2" xref="S3.E6.m1.2.3.2.2.cmml">𝐃</mi><mrow id="S3.E6.m1.2.3.2.3" xref="S3.E6.m1.2.3.2.3.cmml"><mi id="S3.E6.m1.2.3.2.3.2" xref="S3.E6.m1.2.3.2.3.2.cmml">i</mi><mo id="S3.E6.m1.2.3.2.3.1" xref="S3.E6.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.2.3.2.3.3" xref="S3.E6.m1.2.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E6.m1.2.3.1" xref="S3.E6.m1.2.3.1.cmml">=</mo><mrow id="S3.E6.m1.2.3.3" xref="S3.E6.m1.2.3.3.cmml"><mn id="S3.E6.m1.2.3.3.2" xref="S3.E6.m1.2.3.3.2.cmml">1</mn><mo id="S3.E6.m1.2.3.3.1" xref="S3.E6.m1.2.3.3.1.cmml">−</mo><mfrac id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml"><mrow id="S3.E6.m1.2.2.4" xref="S3.E6.m1.2.2.4.cmml"><msubsup id="S3.E6.m1.2.2.4.2" xref="S3.E6.m1.2.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.4.2.2.2" xref="S3.E6.m1.2.2.4.2.2.2.cmml">𝒫</mi><mi id="S3.E6.m1.2.2.4.2.3" xref="S3.E6.m1.2.2.4.2.3.cmml">i</mi><mi id="S3.E6.m1.2.2.4.2.2.3" xref="S3.E6.m1.2.2.4.2.2.3.cmml">t</mi></msubsup><mo id="S3.E6.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.2.2.4.1.cmml">⋅</mo><msubsup id="S3.E6.m1.2.2.4.3" xref="S3.E6.m1.2.2.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.4.3.2.2" xref="S3.E6.m1.2.2.4.3.2.2.cmml">𝒫</mi><mi id="S3.E6.m1.2.2.4.3.3" xref="S3.E6.m1.2.2.4.3.3.cmml">j</mi><mi id="S3.E6.m1.2.2.4.3.2.3" xref="S3.E6.m1.2.2.4.3.2.3.cmml">p</mi></msubsup></mrow><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.cmml">𝒫</mi><mi id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.E6.m1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.E6.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.2.2.1" xref="S3.E6.m1.2.2.2.2.2.cmml"><mo id="S3.E6.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E6.m1.2.2.2.2.2.1.cmml">‖</mo><msubsup id="S3.E6.m1.2.2.2.2.1.1" xref="S3.E6.m1.2.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.2.2.1.1.2.2" xref="S3.E6.m1.2.2.2.2.1.1.2.2.cmml">𝒫</mi><mi id="S3.E6.m1.2.2.2.2.1.1.3" xref="S3.E6.m1.2.2.2.2.1.1.3.cmml">j</mi><mi id="S3.E6.m1.2.2.2.2.1.1.2.3" xref="S3.E6.m1.2.2.2.2.1.1.2.3.cmml">p</mi></msubsup><mo id="S3.E6.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E6.m1.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.3.cmml" xref="S3.E6.m1.2.3"><eq id="S3.E6.m1.2.3.1.cmml" xref="S3.E6.m1.2.3.1"></eq><apply id="S3.E6.m1.2.3.2.cmml" xref="S3.E6.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.3.2.1.cmml" xref="S3.E6.m1.2.3.2">subscript</csymbol><ci id="S3.E6.m1.2.3.2.2.cmml" xref="S3.E6.m1.2.3.2.2">𝐃</ci><apply id="S3.E6.m1.2.3.2.3.cmml" xref="S3.E6.m1.2.3.2.3"><times id="S3.E6.m1.2.3.2.3.1.cmml" xref="S3.E6.m1.2.3.2.3.1"></times><ci id="S3.E6.m1.2.3.2.3.2.cmml" xref="S3.E6.m1.2.3.2.3.2">𝑖</ci><ci id="S3.E6.m1.2.3.2.3.3.cmml" xref="S3.E6.m1.2.3.2.3.3">𝑗</ci></apply></apply><apply id="S3.E6.m1.2.3.3.cmml" xref="S3.E6.m1.2.3.3"><minus id="S3.E6.m1.2.3.3.1.cmml" xref="S3.E6.m1.2.3.3.1"></minus><cn id="S3.E6.m1.2.3.3.2.cmml" type="integer" xref="S3.E6.m1.2.3.3.2">1</cn><apply id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2"><divide id="S3.E6.m1.2.2.3.cmml" xref="S3.E6.m1.2.2"></divide><apply id="S3.E6.m1.2.2.4.cmml" xref="S3.E6.m1.2.2.4"><ci id="S3.E6.m1.2.2.4.1.cmml" xref="S3.E6.m1.2.2.4.1">⋅</ci><apply id="S3.E6.m1.2.2.4.2.cmml" xref="S3.E6.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.4.2.1.cmml" xref="S3.E6.m1.2.2.4.2">subscript</csymbol><apply id="S3.E6.m1.2.2.4.2.2.cmml" xref="S3.E6.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.4.2.2.1.cmml" xref="S3.E6.m1.2.2.4.2">superscript</csymbol><ci id="S3.E6.m1.2.2.4.2.2.2.cmml" xref="S3.E6.m1.2.2.4.2.2.2">𝒫</ci><ci id="S3.E6.m1.2.2.4.2.2.3.cmml" xref="S3.E6.m1.2.2.4.2.2.3">𝑡</ci></apply><ci id="S3.E6.m1.2.2.4.2.3.cmml" xref="S3.E6.m1.2.2.4.2.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.4.3.cmml" xref="S3.E6.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.4.3.1.cmml" xref="S3.E6.m1.2.2.4.3">subscript</csymbol><apply id="S3.E6.m1.2.2.4.3.2.cmml" xref="S3.E6.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.4.3.2.1.cmml" xref="S3.E6.m1.2.2.4.3">superscript</csymbol><ci id="S3.E6.m1.2.2.4.3.2.2.cmml" xref="S3.E6.m1.2.2.4.3.2.2">𝒫</ci><ci id="S3.E6.m1.2.2.4.3.2.3.cmml" xref="S3.E6.m1.2.2.4.3.2.3">𝑝</ci></apply><ci id="S3.E6.m1.2.2.4.3.3.cmml" xref="S3.E6.m1.2.2.4.3.3">𝑗</ci></apply></apply><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><times id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3"></times><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2">𝒫</ci><ci id="S3.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E6.m1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.2.1.2">norm</csymbol><apply id="S3.E6.m1.2.2.2.2.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1">subscript</csymbol><apply id="S3.E6.m1.2.2.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E6.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2.2">𝒫</ci><ci id="S3.E6.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2.3">𝑝</ci></apply><ci id="S3.E6.m1.2.2.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">\mathbf{D}_{ij}=1-\frac{\mathcal{P}^{t}_{i}\cdot\mathcal{P}^{p}_{j}}{\|%
\mathcal{P}^{t}_{i}\|\|\mathcal{P}^{p}_{j}\|}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.2d">bold_D start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = 1 - divide start_ARG caligraphic_P start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ caligraphic_P start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ caligraphic_P start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ ∥ caligraphic_P start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p3">
<p class="ltx_p" id="S3.SS3.SSS3.p3.1">Then the Hungarian algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib65" title=""><span class="ltx_text" style="font-size:90%;">65</span></a>]</cite> is employed to find the optimal matching that minimizes the total distance. This algorithm solves the bipartite matching problem, finding the permutation <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.1.m1.1"><semantics id="S3.SS3.SSS3.p3.1.m1.1a"><mi id="S3.SS3.SSS3.p3.1.m1.1.1" xref="S3.SS3.SSS3.p3.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.1.m1.1b"><ci id="S3.SS3.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.1.m1.1d">italic_π</annotation></semantics></math> that minimizes the total matching loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi^{*}=\arg\min_{\pi\in\Pi}\sum_{i=1}^{K_{t}}\mathbf{D}_{i,\pi(i)}" class="ltx_Math" display="block" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.4" xref="S3.E7.m1.3.4.cmml"><msup id="S3.E7.m1.3.4.2" xref="S3.E7.m1.3.4.2.cmml"><mi id="S3.E7.m1.3.4.2.2" xref="S3.E7.m1.3.4.2.2.cmml">π</mi><mo id="S3.E7.m1.3.4.2.3" xref="S3.E7.m1.3.4.2.3.cmml">∗</mo></msup><mo id="S3.E7.m1.3.4.1" xref="S3.E7.m1.3.4.1.cmml">=</mo><mrow id="S3.E7.m1.3.4.3" xref="S3.E7.m1.3.4.3.cmml"><mrow id="S3.E7.m1.3.4.3.2" xref="S3.E7.m1.3.4.3.2.cmml"><mi id="S3.E7.m1.3.4.3.2.1" xref="S3.E7.m1.3.4.3.2.1.cmml">arg</mi><mo id="S3.E7.m1.3.4.3.2a" lspace="0.167em" xref="S3.E7.m1.3.4.3.2.cmml">⁡</mo><munder id="S3.E7.m1.3.4.3.2.2" xref="S3.E7.m1.3.4.3.2.2.cmml"><mi id="S3.E7.m1.3.4.3.2.2.2" xref="S3.E7.m1.3.4.3.2.2.2.cmml">min</mi><mrow id="S3.E7.m1.3.4.3.2.2.3" xref="S3.E7.m1.3.4.3.2.2.3.cmml"><mi id="S3.E7.m1.3.4.3.2.2.3.2" xref="S3.E7.m1.3.4.3.2.2.3.2.cmml">π</mi><mo id="S3.E7.m1.3.4.3.2.2.3.1" xref="S3.E7.m1.3.4.3.2.2.3.1.cmml">∈</mo><mi id="S3.E7.m1.3.4.3.2.2.3.3" mathvariant="normal" xref="S3.E7.m1.3.4.3.2.2.3.3.cmml">Π</mi></mrow></munder></mrow><mo id="S3.E7.m1.3.4.3.1" xref="S3.E7.m1.3.4.3.1.cmml">⁢</mo><mrow id="S3.E7.m1.3.4.3.3" xref="S3.E7.m1.3.4.3.3.cmml"><munderover id="S3.E7.m1.3.4.3.3.1" xref="S3.E7.m1.3.4.3.3.1.cmml"><mo id="S3.E7.m1.3.4.3.3.1.2.2" movablelimits="false" xref="S3.E7.m1.3.4.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.3.4.3.3.1.2.3" xref="S3.E7.m1.3.4.3.3.1.2.3.cmml"><mi id="S3.E7.m1.3.4.3.3.1.2.3.2" xref="S3.E7.m1.3.4.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E7.m1.3.4.3.3.1.2.3.1" xref="S3.E7.m1.3.4.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E7.m1.3.4.3.3.1.2.3.3" xref="S3.E7.m1.3.4.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E7.m1.3.4.3.3.1.3" xref="S3.E7.m1.3.4.3.3.1.3.cmml"><mi id="S3.E7.m1.3.4.3.3.1.3.2" xref="S3.E7.m1.3.4.3.3.1.3.2.cmml">K</mi><mi id="S3.E7.m1.3.4.3.3.1.3.3" xref="S3.E7.m1.3.4.3.3.1.3.3.cmml">t</mi></msub></munderover><msub id="S3.E7.m1.3.4.3.3.2" xref="S3.E7.m1.3.4.3.3.2.cmml"><mi id="S3.E7.m1.3.4.3.3.2.2" xref="S3.E7.m1.3.4.3.3.2.2.cmml">𝐃</mi><mrow id="S3.E7.m1.3.3.3.3" xref="S3.E7.m1.3.3.3.4.cmml"><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">i</mi><mo id="S3.E7.m1.3.3.3.3.2" xref="S3.E7.m1.3.3.3.4.cmml">,</mo><mrow id="S3.E7.m1.3.3.3.3.1" xref="S3.E7.m1.3.3.3.3.1.cmml"><mi id="S3.E7.m1.3.3.3.3.1.2" xref="S3.E7.m1.3.3.3.3.1.2.cmml">π</mi><mo id="S3.E7.m1.3.3.3.3.1.1" xref="S3.E7.m1.3.3.3.3.1.1.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.3.3.1.3.2" xref="S3.E7.m1.3.3.3.3.1.cmml"><mo id="S3.E7.m1.3.3.3.3.1.3.2.1" stretchy="false" xref="S3.E7.m1.3.3.3.3.1.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m1.3.3.3.3.1.3.2.2" stretchy="false" xref="S3.E7.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.4.cmml" xref="S3.E7.m1.3.4"><eq id="S3.E7.m1.3.4.1.cmml" xref="S3.E7.m1.3.4.1"></eq><apply id="S3.E7.m1.3.4.2.cmml" xref="S3.E7.m1.3.4.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.4.2.1.cmml" xref="S3.E7.m1.3.4.2">superscript</csymbol><ci id="S3.E7.m1.3.4.2.2.cmml" xref="S3.E7.m1.3.4.2.2">𝜋</ci><times id="S3.E7.m1.3.4.2.3.cmml" xref="S3.E7.m1.3.4.2.3"></times></apply><apply id="S3.E7.m1.3.4.3.cmml" xref="S3.E7.m1.3.4.3"><times id="S3.E7.m1.3.4.3.1.cmml" xref="S3.E7.m1.3.4.3.1"></times><apply id="S3.E7.m1.3.4.3.2.cmml" xref="S3.E7.m1.3.4.3.2"><arg id="S3.E7.m1.3.4.3.2.1.cmml" xref="S3.E7.m1.3.4.3.2.1"></arg><apply id="S3.E7.m1.3.4.3.2.2.cmml" xref="S3.E7.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.4.3.2.2.1.cmml" xref="S3.E7.m1.3.4.3.2.2">subscript</csymbol><min id="S3.E7.m1.3.4.3.2.2.2.cmml" xref="S3.E7.m1.3.4.3.2.2.2"></min><apply id="S3.E7.m1.3.4.3.2.2.3.cmml" xref="S3.E7.m1.3.4.3.2.2.3"><in id="S3.E7.m1.3.4.3.2.2.3.1.cmml" xref="S3.E7.m1.3.4.3.2.2.3.1"></in><ci id="S3.E7.m1.3.4.3.2.2.3.2.cmml" xref="S3.E7.m1.3.4.3.2.2.3.2">𝜋</ci><ci id="S3.E7.m1.3.4.3.2.2.3.3.cmml" xref="S3.E7.m1.3.4.3.2.2.3.3">Π</ci></apply></apply></apply><apply id="S3.E7.m1.3.4.3.3.cmml" xref="S3.E7.m1.3.4.3.3"><apply id="S3.E7.m1.3.4.3.3.1.cmml" xref="S3.E7.m1.3.4.3.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.4.3.3.1.1.cmml" xref="S3.E7.m1.3.4.3.3.1">superscript</csymbol><apply id="S3.E7.m1.3.4.3.3.1.2.cmml" xref="S3.E7.m1.3.4.3.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.4.3.3.1.2.1.cmml" xref="S3.E7.m1.3.4.3.3.1">subscript</csymbol><sum id="S3.E7.m1.3.4.3.3.1.2.2.cmml" xref="S3.E7.m1.3.4.3.3.1.2.2"></sum><apply id="S3.E7.m1.3.4.3.3.1.2.3.cmml" xref="S3.E7.m1.3.4.3.3.1.2.3"><eq id="S3.E7.m1.3.4.3.3.1.2.3.1.cmml" xref="S3.E7.m1.3.4.3.3.1.2.3.1"></eq><ci id="S3.E7.m1.3.4.3.3.1.2.3.2.cmml" xref="S3.E7.m1.3.4.3.3.1.2.3.2">𝑖</ci><cn id="S3.E7.m1.3.4.3.3.1.2.3.3.cmml" type="integer" xref="S3.E7.m1.3.4.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E7.m1.3.4.3.3.1.3.cmml" xref="S3.E7.m1.3.4.3.3.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.4.3.3.1.3.1.cmml" xref="S3.E7.m1.3.4.3.3.1.3">subscript</csymbol><ci id="S3.E7.m1.3.4.3.3.1.3.2.cmml" xref="S3.E7.m1.3.4.3.3.1.3.2">𝐾</ci><ci id="S3.E7.m1.3.4.3.3.1.3.3.cmml" xref="S3.E7.m1.3.4.3.3.1.3.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.3.4.3.3.2.cmml" xref="S3.E7.m1.3.4.3.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.4.3.3.2.1.cmml" xref="S3.E7.m1.3.4.3.3.2">subscript</csymbol><ci id="S3.E7.m1.3.4.3.3.2.2.cmml" xref="S3.E7.m1.3.4.3.3.2.2">𝐃</ci><list id="S3.E7.m1.3.3.3.4.cmml" xref="S3.E7.m1.3.3.3.3"><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝑖</ci><apply id="S3.E7.m1.3.3.3.3.1.cmml" xref="S3.E7.m1.3.3.3.3.1"><times id="S3.E7.m1.3.3.3.3.1.1.cmml" xref="S3.E7.m1.3.3.3.3.1.1"></times><ci id="S3.E7.m1.3.3.3.3.1.2.cmml" xref="S3.E7.m1.3.3.3.3.1.2">𝜋</ci><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑖</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\pi^{*}=\arg\min_{\pi\in\Pi}\sum_{i=1}^{K_{t}}\mathbf{D}_{i,\pi(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_π ∈ roman_Π end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT bold_D start_POSTSUBSCRIPT italic_i , italic_π ( italic_i ) end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p3.4">where <math alttext="\Pi" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.2.m1.1"><semantics id="S3.SS3.SSS3.p3.2.m1.1a"><mi id="S3.SS3.SSS3.p3.2.m1.1.1" mathvariant="normal" xref="S3.SS3.SSS3.p3.2.m1.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.2.m1.1b"><ci id="S3.SS3.SSS3.p3.2.m1.1.1.cmml" xref="S3.SS3.SSS3.p3.2.m1.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.2.m1.1c">\Pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.2.m1.1d">roman_Π</annotation></semantics></math> represents the set of all possible matchings, and <math alttext="\pi(i)" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.3.m2.1"><semantics id="S3.SS3.SSS3.p3.3.m2.1a"><mrow id="S3.SS3.SSS3.p3.3.m2.1.2" xref="S3.SS3.SSS3.p3.3.m2.1.2.cmml"><mi id="S3.SS3.SSS3.p3.3.m2.1.2.2" xref="S3.SS3.SSS3.p3.3.m2.1.2.2.cmml">π</mi><mo id="S3.SS3.SSS3.p3.3.m2.1.2.1" xref="S3.SS3.SSS3.p3.3.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p3.3.m2.1.2.3.2" xref="S3.SS3.SSS3.p3.3.m2.1.2.cmml"><mo id="S3.SS3.SSS3.p3.3.m2.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS3.p3.3.m2.1.2.cmml">(</mo><mi id="S3.SS3.SSS3.p3.3.m2.1.1" xref="S3.SS3.SSS3.p3.3.m2.1.1.cmml">i</mi><mo id="S3.SS3.SSS3.p3.3.m2.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS3.p3.3.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.3.m2.1b"><apply id="S3.SS3.SSS3.p3.3.m2.1.2.cmml" xref="S3.SS3.SSS3.p3.3.m2.1.2"><times id="S3.SS3.SSS3.p3.3.m2.1.2.1.cmml" xref="S3.SS3.SSS3.p3.3.m2.1.2.1"></times><ci id="S3.SS3.SSS3.p3.3.m2.1.2.2.cmml" xref="S3.SS3.SSS3.p3.3.m2.1.2.2">𝜋</ci><ci id="S3.SS3.SSS3.p3.3.m2.1.1.cmml" xref="S3.SS3.SSS3.p3.3.m2.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.3.m2.1c">\pi(i)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.3.m2.1d">italic_π ( italic_i )</annotation></semantics></math> is the index of the predicted prototype matched to the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p3.4.m3.1"><semantics id="S3.SS3.SSS3.p3.4.m3.1a"><mi id="S3.SS3.SSS3.p3.4.m3.1.1" xref="S3.SS3.SSS3.p3.4.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p3.4.m3.1b"><ci id="S3.SS3.SSS3.p3.4.m3.1.1.cmml" xref="S3.SS3.SSS3.p3.4.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p3.4.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p3.4.m3.1d">italic_i</annotation></semantics></math>-th target prototype. The final match loss can be expressed as the sum of distances for all matches:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{match}}=\sum_{i=1}^{K_{t}}\mathbf{D}_{i,\pi^{*}(i)}" class="ltx_Math" display="block" id="S3.E8.m1.3"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.4" xref="S3.E8.m1.3.4.cmml"><msub id="S3.E8.m1.3.4.2" xref="S3.E8.m1.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.3.4.2.2" xref="S3.E8.m1.3.4.2.2.cmml">ℒ</mi><mtext id="S3.E8.m1.3.4.2.3" xref="S3.E8.m1.3.4.2.3a.cmml">match</mtext></msub><mo id="S3.E8.m1.3.4.1" rspace="0.111em" xref="S3.E8.m1.3.4.1.cmml">=</mo><mrow id="S3.E8.m1.3.4.3" xref="S3.E8.m1.3.4.3.cmml"><munderover id="S3.E8.m1.3.4.3.1" xref="S3.E8.m1.3.4.3.1.cmml"><mo id="S3.E8.m1.3.4.3.1.2.2" movablelimits="false" xref="S3.E8.m1.3.4.3.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.3.4.3.1.2.3" xref="S3.E8.m1.3.4.3.1.2.3.cmml"><mi id="S3.E8.m1.3.4.3.1.2.3.2" xref="S3.E8.m1.3.4.3.1.2.3.2.cmml">i</mi><mo id="S3.E8.m1.3.4.3.1.2.3.1" xref="S3.E8.m1.3.4.3.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.3.4.3.1.2.3.3" xref="S3.E8.m1.3.4.3.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E8.m1.3.4.3.1.3" xref="S3.E8.m1.3.4.3.1.3.cmml"><mi id="S3.E8.m1.3.4.3.1.3.2" xref="S3.E8.m1.3.4.3.1.3.2.cmml">K</mi><mi id="S3.E8.m1.3.4.3.1.3.3" xref="S3.E8.m1.3.4.3.1.3.3.cmml">t</mi></msub></munderover><msub id="S3.E8.m1.3.4.3.2" xref="S3.E8.m1.3.4.3.2.cmml"><mi id="S3.E8.m1.3.4.3.2.2" xref="S3.E8.m1.3.4.3.2.2.cmml">𝐃</mi><mrow id="S3.E8.m1.3.3.3.3" xref="S3.E8.m1.3.3.3.4.cmml"><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">i</mi><mo id="S3.E8.m1.3.3.3.3.2" xref="S3.E8.m1.3.3.3.4.cmml">,</mo><mrow id="S3.E8.m1.3.3.3.3.1" xref="S3.E8.m1.3.3.3.3.1.cmml"><msup id="S3.E8.m1.3.3.3.3.1.2" xref="S3.E8.m1.3.3.3.3.1.2.cmml"><mi id="S3.E8.m1.3.3.3.3.1.2.2" xref="S3.E8.m1.3.3.3.3.1.2.2.cmml">π</mi><mo id="S3.E8.m1.3.3.3.3.1.2.3" xref="S3.E8.m1.3.3.3.3.1.2.3.cmml">∗</mo></msup><mo id="S3.E8.m1.3.3.3.3.1.1" xref="S3.E8.m1.3.3.3.3.1.1.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.3.3.1.3.2" xref="S3.E8.m1.3.3.3.3.1.cmml"><mo id="S3.E8.m1.3.3.3.3.1.3.2.1" stretchy="false" xref="S3.E8.m1.3.3.3.3.1.cmml">(</mo><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">i</mi><mo id="S3.E8.m1.3.3.3.3.1.3.2.2" stretchy="false" xref="S3.E8.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.4.cmml" xref="S3.E8.m1.3.4"><eq id="S3.E8.m1.3.4.1.cmml" xref="S3.E8.m1.3.4.1"></eq><apply id="S3.E8.m1.3.4.2.cmml" xref="S3.E8.m1.3.4.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.2.1.cmml" xref="S3.E8.m1.3.4.2">subscript</csymbol><ci id="S3.E8.m1.3.4.2.2.cmml" xref="S3.E8.m1.3.4.2.2">ℒ</ci><ci id="S3.E8.m1.3.4.2.3a.cmml" xref="S3.E8.m1.3.4.2.3"><mtext id="S3.E8.m1.3.4.2.3.cmml" mathsize="70%" xref="S3.E8.m1.3.4.2.3">match</mtext></ci></apply><apply id="S3.E8.m1.3.4.3.cmml" xref="S3.E8.m1.3.4.3"><apply id="S3.E8.m1.3.4.3.1.cmml" xref="S3.E8.m1.3.4.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.1.1.cmml" xref="S3.E8.m1.3.4.3.1">superscript</csymbol><apply id="S3.E8.m1.3.4.3.1.2.cmml" xref="S3.E8.m1.3.4.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.1.2.1.cmml" xref="S3.E8.m1.3.4.3.1">subscript</csymbol><sum id="S3.E8.m1.3.4.3.1.2.2.cmml" xref="S3.E8.m1.3.4.3.1.2.2"></sum><apply id="S3.E8.m1.3.4.3.1.2.3.cmml" xref="S3.E8.m1.3.4.3.1.2.3"><eq id="S3.E8.m1.3.4.3.1.2.3.1.cmml" xref="S3.E8.m1.3.4.3.1.2.3.1"></eq><ci id="S3.E8.m1.3.4.3.1.2.3.2.cmml" xref="S3.E8.m1.3.4.3.1.2.3.2">𝑖</ci><cn id="S3.E8.m1.3.4.3.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.3.4.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E8.m1.3.4.3.1.3.cmml" xref="S3.E8.m1.3.4.3.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.1.3.1.cmml" xref="S3.E8.m1.3.4.3.1.3">subscript</csymbol><ci id="S3.E8.m1.3.4.3.1.3.2.cmml" xref="S3.E8.m1.3.4.3.1.3.2">𝐾</ci><ci id="S3.E8.m1.3.4.3.1.3.3.cmml" xref="S3.E8.m1.3.4.3.1.3.3">𝑡</ci></apply></apply><apply id="S3.E8.m1.3.4.3.2.cmml" xref="S3.E8.m1.3.4.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.4.3.2.1.cmml" xref="S3.E8.m1.3.4.3.2">subscript</csymbol><ci id="S3.E8.m1.3.4.3.2.2.cmml" xref="S3.E8.m1.3.4.3.2.2">𝐃</ci><list id="S3.E8.m1.3.3.3.4.cmml" xref="S3.E8.m1.3.3.3.3"><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝑖</ci><apply id="S3.E8.m1.3.3.3.3.1.cmml" xref="S3.E8.m1.3.3.3.3.1"><times id="S3.E8.m1.3.3.3.3.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1"></times><apply id="S3.E8.m1.3.3.3.3.1.2.cmml" xref="S3.E8.m1.3.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.3.3.1.2.1.cmml" xref="S3.E8.m1.3.3.3.3.1.2">superscript</csymbol><ci id="S3.E8.m1.3.3.3.3.1.2.2.cmml" xref="S3.E8.m1.3.3.3.3.1.2.2">𝜋</ci><times id="S3.E8.m1.3.3.3.3.1.2.3.cmml" xref="S3.E8.m1.3.3.3.3.1.2.3"></times></apply><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">\mathcal{L}_{\text{match}}=\sum_{i=1}^{K_{t}}\mathbf{D}_{i,\pi^{*}(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.3d">caligraphic_L start_POSTSUBSCRIPT match end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT bold_D start_POSTSUBSCRIPT italic_i , italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_i ) end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS4.5.1.1">III-D</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS4.6.2">Negative Prompt Calibration</span>
</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">For training SAM, point prompts typically include both positive and negative prompts, which require human annotation. Positive prompts are usually selected from any point in the instance, while negative prompts are more ambiguous. This is because the background often covers a large area, so any point outside the mask can be chosen as a negative prompt. Remote sensing images are characterized by densely packed objects and their high similarity to the background. With point supervision and no boundary constraints, the self-training process may result in a single predicted mask containing multiple foreground objects or extensive background. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S1.F2" title="Figure 2 ‣ I Introduction ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">2</span></a>, introducing negative prompts can effectively separate objects from confusing regions. Inspired by this, we developed a <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.1">Negative Prompt Calibration</span> (NPC) method to dynamically adjust negative prompts during training.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.12">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.F8" title="Figure 8 ‣ IV-D4 Comparison with other feature alignment methods. ‣ IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">8</span></a> illustrates the complete process of NPC. Given a set of initial prompt points <math alttext="\mathcal{P}_{\text{init}}" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><msub id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">𝒫</mi><mtext id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3a.cmml">init</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">𝒫</ci><ci id="S3.SS4.p2.1.m1.1.1.3a.cmml" xref="S3.SS4.p2.1.m1.1.1.3"><mtext id="S3.SS4.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.1.m1.1.1.3">init</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathcal{P}_{\text{init}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">caligraphic_P start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math>, which includes <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1"><semantics id="S3.SS4.p2.2.m2.1a"><mi id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.1d">italic_K</annotation></semantics></math> positive prompts <math alttext="\mathcal{P}^{\text{pos}}_{\text{init}}" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.1"><semantics id="S3.SS4.p2.3.m3.1a"><msubsup id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.3.m3.1.1.2.2" xref="S3.SS4.p2.3.m3.1.1.2.2.cmml">𝒫</mi><mtext id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3a.cmml">init</mtext><mtext id="S3.SS4.p2.3.m3.1.1.2.3" xref="S3.SS4.p2.3.m3.1.1.2.3a.cmml">pos</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">subscript</csymbol><apply id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.2.1.cmml" xref="S3.SS4.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.2.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2.2">𝒫</ci><ci id="S3.SS4.p2.3.m3.1.1.2.3a.cmml" xref="S3.SS4.p2.3.m3.1.1.2.3"><mtext id="S3.SS4.p2.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p2.3.m3.1.1.2.3">pos</mtext></ci></apply><ci id="S3.SS4.p2.3.m3.1.1.3a.cmml" xref="S3.SS4.p2.3.m3.1.1.3"><mtext id="S3.SS4.p2.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.3.m3.1.1.3">init</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">\mathcal{P}^{\text{pos}}_{\text{init}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m3.1d">caligraphic_P start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math> = <math alttext="\{\mathbf{p}^{\text{pos}}_{k}\}_{k=1\cdots K}" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m4.1"><semantics id="S3.SS4.p2.4.m4.1a"><msub id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml"><mrow id="S3.SS4.p2.4.m4.1.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.2.cmml"><mo id="S3.SS4.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS4.p2.4.m4.1.1.1.2.cmml">{</mo><msubsup id="S3.SS4.p2.4.m4.1.1.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.4.m4.1.1.1.1.1.2.2" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2.2.cmml">𝐩</mi><mi id="S3.SS4.p2.4.m4.1.1.1.1.1.3" xref="S3.SS4.p2.4.m4.1.1.1.1.1.3.cmml">k</mi><mtext id="S3.SS4.p2.4.m4.1.1.1.1.1.2.3" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2.3a.cmml">pos</mtext></msubsup><mo id="S3.SS4.p2.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS4.p2.4.m4.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3.cmml"><mi id="S3.SS4.p2.4.m4.1.1.3.2" xref="S3.SS4.p2.4.m4.1.1.3.2.cmml">k</mi><mo id="S3.SS4.p2.4.m4.1.1.3.1" xref="S3.SS4.p2.4.m4.1.1.3.1.cmml">=</mo><mrow id="S3.SS4.p2.4.m4.1.1.3.3" xref="S3.SS4.p2.4.m4.1.1.3.3.cmml"><mn id="S3.SS4.p2.4.m4.1.1.3.3.2" xref="S3.SS4.p2.4.m4.1.1.3.3.2.cmml">1</mn><mo id="S3.SS4.p2.4.m4.1.1.3.3.1" xref="S3.SS4.p2.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS4.p2.4.m4.1.1.3.3.3" mathvariant="normal" xref="S3.SS4.p2.4.m4.1.1.3.3.3.cmml">⋯</mi><mo id="S3.SS4.p2.4.m4.1.1.3.3.1a" xref="S3.SS4.p2.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS4.p2.4.m4.1.1.3.3.4" xref="S3.SS4.p2.4.m4.1.1.3.3.4.cmml">K</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1">subscript</csymbol><set id="S3.SS4.p2.4.m4.1.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1"><apply id="S3.SS4.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1">subscript</csymbol><apply id="S3.SS4.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2.2">𝐩</ci><ci id="S3.SS4.p2.4.m4.1.1.1.1.1.2.3a.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2.3"><mtext id="S3.SS4.p2.4.m4.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2.3">pos</mtext></ci></apply><ci id="S3.SS4.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS4.p2.4.m4.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3"><eq id="S3.SS4.p2.4.m4.1.1.3.1.cmml" xref="S3.SS4.p2.4.m4.1.1.3.1"></eq><ci id="S3.SS4.p2.4.m4.1.1.3.2.cmml" xref="S3.SS4.p2.4.m4.1.1.3.2">𝑘</ci><apply id="S3.SS4.p2.4.m4.1.1.3.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3"><times id="S3.SS4.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3.1"></times><cn id="S3.SS4.p2.4.m4.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p2.4.m4.1.1.3.3.2">1</cn><ci id="S3.SS4.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3.3">⋯</ci><ci id="S3.SS4.p2.4.m4.1.1.3.3.4.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3.4">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">\{\mathbf{p}^{\text{pos}}_{k}\}_{k=1\cdots K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.4.m4.1d">{ bold_p start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 ⋯ italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.p2.5.m5.1"><semantics id="S3.SS4.p2.5.m5.1a"><mi id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><ci id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.5.m5.1d">italic_K</annotation></semantics></math> negative prompts <math alttext="\mathcal{P}^{\text{neg}}_{\text{init}}" class="ltx_Math" display="inline" id="S3.SS4.p2.6.m6.1"><semantics id="S3.SS4.p2.6.m6.1a"><msubsup id="S3.SS4.p2.6.m6.1.1" xref="S3.SS4.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.6.m6.1.1.2.2" xref="S3.SS4.p2.6.m6.1.1.2.2.cmml">𝒫</mi><mtext id="S3.SS4.p2.6.m6.1.1.3" xref="S3.SS4.p2.6.m6.1.1.3a.cmml">init</mtext><mtext id="S3.SS4.p2.6.m6.1.1.2.3" xref="S3.SS4.p2.6.m6.1.1.2.3a.cmml">neg</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m6.1b"><apply id="S3.SS4.p2.6.m6.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.1.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1">subscript</csymbol><apply id="S3.SS4.p2.6.m6.1.1.2.cmml" xref="S3.SS4.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.1.1.2.1.cmml" xref="S3.SS4.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS4.p2.6.m6.1.1.2.2.cmml" xref="S3.SS4.p2.6.m6.1.1.2.2">𝒫</ci><ci id="S3.SS4.p2.6.m6.1.1.2.3a.cmml" xref="S3.SS4.p2.6.m6.1.1.2.3"><mtext id="S3.SS4.p2.6.m6.1.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p2.6.m6.1.1.2.3">neg</mtext></ci></apply><ci id="S3.SS4.p2.6.m6.1.1.3a.cmml" xref="S3.SS4.p2.6.m6.1.1.3"><mtext id="S3.SS4.p2.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.6.m6.1.1.3">init</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m6.1c">\mathcal{P}^{\text{neg}}_{\text{init}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.6.m6.1d">caligraphic_P start_POSTSUPERSCRIPT neg end_POSTSUPERSCRIPT start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math> = <math alttext="\{\mathbf{p}^{\text{neg}}_{k}\}_{k=1\cdots K}" class="ltx_Math" display="inline" id="S3.SS4.p2.7.m7.1"><semantics id="S3.SS4.p2.7.m7.1a"><msub id="S3.SS4.p2.7.m7.1.1" xref="S3.SS4.p2.7.m7.1.1.cmml"><mrow id="S3.SS4.p2.7.m7.1.1.1.1" xref="S3.SS4.p2.7.m7.1.1.1.2.cmml"><mo id="S3.SS4.p2.7.m7.1.1.1.1.2" stretchy="false" xref="S3.SS4.p2.7.m7.1.1.1.2.cmml">{</mo><msubsup id="S3.SS4.p2.7.m7.1.1.1.1.1" xref="S3.SS4.p2.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.7.m7.1.1.1.1.1.2.2" xref="S3.SS4.p2.7.m7.1.1.1.1.1.2.2.cmml">𝐩</mi><mi id="S3.SS4.p2.7.m7.1.1.1.1.1.3" xref="S3.SS4.p2.7.m7.1.1.1.1.1.3.cmml">k</mi><mtext id="S3.SS4.p2.7.m7.1.1.1.1.1.2.3" xref="S3.SS4.p2.7.m7.1.1.1.1.1.2.3a.cmml">neg</mtext></msubsup><mo id="S3.SS4.p2.7.m7.1.1.1.1.3" stretchy="false" xref="S3.SS4.p2.7.m7.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS4.p2.7.m7.1.1.3" xref="S3.SS4.p2.7.m7.1.1.3.cmml"><mi id="S3.SS4.p2.7.m7.1.1.3.2" xref="S3.SS4.p2.7.m7.1.1.3.2.cmml">k</mi><mo id="S3.SS4.p2.7.m7.1.1.3.1" xref="S3.SS4.p2.7.m7.1.1.3.1.cmml">=</mo><mrow id="S3.SS4.p2.7.m7.1.1.3.3" xref="S3.SS4.p2.7.m7.1.1.3.3.cmml"><mn id="S3.SS4.p2.7.m7.1.1.3.3.2" xref="S3.SS4.p2.7.m7.1.1.3.3.2.cmml">1</mn><mo id="S3.SS4.p2.7.m7.1.1.3.3.1" xref="S3.SS4.p2.7.m7.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS4.p2.7.m7.1.1.3.3.3" mathvariant="normal" xref="S3.SS4.p2.7.m7.1.1.3.3.3.cmml">⋯</mi><mo id="S3.SS4.p2.7.m7.1.1.3.3.1a" xref="S3.SS4.p2.7.m7.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS4.p2.7.m7.1.1.3.3.4" xref="S3.SS4.p2.7.m7.1.1.3.3.4.cmml">K</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m7.1b"><apply id="S3.SS4.p2.7.m7.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m7.1.1.2.cmml" xref="S3.SS4.p2.7.m7.1.1">subscript</csymbol><set id="S3.SS4.p2.7.m7.1.1.1.2.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1"><apply id="S3.SS4.p2.7.m7.1.1.1.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1.1">subscript</csymbol><apply id="S3.SS4.p2.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m7.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1.1">superscript</csymbol><ci id="S3.SS4.p2.7.m7.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1.1.2.2">𝐩</ci><ci id="S3.SS4.p2.7.m7.1.1.1.1.1.2.3a.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1.1.2.3"><mtext id="S3.SS4.p2.7.m7.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p2.7.m7.1.1.1.1.1.2.3">neg</mtext></ci></apply><ci id="S3.SS4.p2.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.7.m7.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS4.p2.7.m7.1.1.3.cmml" xref="S3.SS4.p2.7.m7.1.1.3"><eq id="S3.SS4.p2.7.m7.1.1.3.1.cmml" xref="S3.SS4.p2.7.m7.1.1.3.1"></eq><ci id="S3.SS4.p2.7.m7.1.1.3.2.cmml" xref="S3.SS4.p2.7.m7.1.1.3.2">𝑘</ci><apply id="S3.SS4.p2.7.m7.1.1.3.3.cmml" xref="S3.SS4.p2.7.m7.1.1.3.3"><times id="S3.SS4.p2.7.m7.1.1.3.3.1.cmml" xref="S3.SS4.p2.7.m7.1.1.3.3.1"></times><cn id="S3.SS4.p2.7.m7.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p2.7.m7.1.1.3.3.2">1</cn><ci id="S3.SS4.p2.7.m7.1.1.3.3.3.cmml" xref="S3.SS4.p2.7.m7.1.1.3.3.3">⋯</ci><ci id="S3.SS4.p2.7.m7.1.1.3.3.4.cmml" xref="S3.SS4.p2.7.m7.1.1.3.3.4">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m7.1c">\{\mathbf{p}^{\text{neg}}_{k}\}_{k=1\cdots K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.7.m7.1d">{ bold_p start_POSTSUPERSCRIPT neg end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 ⋯ italic_K end_POSTSUBSCRIPT</annotation></semantics></math>. For each <math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.p2.8.m8.1"><semantics id="S3.SS4.p2.8.m8.1a"><mi id="S3.SS4.p2.8.m8.1.1" xref="S3.SS4.p2.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m8.1b"><ci id="S3.SS4.p2.8.m8.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m8.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.8.m8.1d">italic_i</annotation></semantics></math>-th instance, the corresponding initial mask <math alttext="\mathcal{M}^{\text{init}}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p2.9.m9.1"><semantics id="S3.SS4.p2.9.m9.1a"><msubsup id="S3.SS4.p2.9.m9.1.1" xref="S3.SS4.p2.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.9.m9.1.1.2.2" xref="S3.SS4.p2.9.m9.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS4.p2.9.m9.1.1.3" xref="S3.SS4.p2.9.m9.1.1.3.cmml">i</mi><mtext id="S3.SS4.p2.9.m9.1.1.2.3" xref="S3.SS4.p2.9.m9.1.1.2.3a.cmml">init</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.9.m9.1b"><apply id="S3.SS4.p2.9.m9.1.1.cmml" xref="S3.SS4.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.9.m9.1.1.1.cmml" xref="S3.SS4.p2.9.m9.1.1">subscript</csymbol><apply id="S3.SS4.p2.9.m9.1.1.2.cmml" xref="S3.SS4.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.9.m9.1.1.2.1.cmml" xref="S3.SS4.p2.9.m9.1.1">superscript</csymbol><ci id="S3.SS4.p2.9.m9.1.1.2.2.cmml" xref="S3.SS4.p2.9.m9.1.1.2.2">ℳ</ci><ci id="S3.SS4.p2.9.m9.1.1.2.3a.cmml" xref="S3.SS4.p2.9.m9.1.1.2.3"><mtext id="S3.SS4.p2.9.m9.1.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p2.9.m9.1.1.2.3">init</mtext></ci></apply><ci id="S3.SS4.p2.9.m9.1.1.3.cmml" xref="S3.SS4.p2.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.9.m9.1c">\mathcal{M}^{\text{init}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.9.m9.1d">caligraphic_M start_POSTSUPERSCRIPT init end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is obtained by inputting <math alttext="\mathcal{P}_{\text{init}}" class="ltx_Math" display="inline" id="S3.SS4.p2.10.m10.1"><semantics id="S3.SS4.p2.10.m10.1a"><msub id="S3.SS4.p2.10.m10.1.1" xref="S3.SS4.p2.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.10.m10.1.1.2" xref="S3.SS4.p2.10.m10.1.1.2.cmml">𝒫</mi><mtext id="S3.SS4.p2.10.m10.1.1.3" xref="S3.SS4.p2.10.m10.1.1.3a.cmml">init</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.10.m10.1b"><apply id="S3.SS4.p2.10.m10.1.1.cmml" xref="S3.SS4.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m10.1.1.1.cmml" xref="S3.SS4.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS4.p2.10.m10.1.1.2.cmml" xref="S3.SS4.p2.10.m10.1.1.2">𝒫</ci><ci id="S3.SS4.p2.10.m10.1.1.3a.cmml" xref="S3.SS4.p2.10.m10.1.1.3"><mtext id="S3.SS4.p2.10.m10.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.10.m10.1.1.3">init</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.10.m10.1c">\mathcal{P}_{\text{init}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.10.m10.1d">caligraphic_P start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math> and encoder feature into the mask encoder <math alttext="\Phi_{\text{mask}}" class="ltx_Math" display="inline" id="S3.SS4.p2.11.m11.1"><semantics id="S3.SS4.p2.11.m11.1a"><msub id="S3.SS4.p2.11.m11.1.1" xref="S3.SS4.p2.11.m11.1.1.cmml"><mi id="S3.SS4.p2.11.m11.1.1.2" mathvariant="normal" xref="S3.SS4.p2.11.m11.1.1.2.cmml">Φ</mi><mtext id="S3.SS4.p2.11.m11.1.1.3" xref="S3.SS4.p2.11.m11.1.1.3a.cmml">mask</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.11.m11.1b"><apply id="S3.SS4.p2.11.m11.1.1.cmml" xref="S3.SS4.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.11.m11.1.1.1.cmml" xref="S3.SS4.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS4.p2.11.m11.1.1.2.cmml" xref="S3.SS4.p2.11.m11.1.1.2">Φ</ci><ci id="S3.SS4.p2.11.m11.1.1.3a.cmml" xref="S3.SS4.p2.11.m11.1.1.3"><mtext id="S3.SS4.p2.11.m11.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.11.m11.1.1.3">mask</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.11.m11.1c">\Phi_{\text{mask}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.11.m11.1d">roman_Φ start_POSTSUBSCRIPT mask end_POSTSUBSCRIPT</annotation></semantics></math> and prompt encoder <math alttext="\Phi_{\text{prompt}}" class="ltx_Math" display="inline" id="S3.SS4.p2.12.m12.1"><semantics id="S3.SS4.p2.12.m12.1a"><msub id="S3.SS4.p2.12.m12.1.1" xref="S3.SS4.p2.12.m12.1.1.cmml"><mi id="S3.SS4.p2.12.m12.1.1.2" mathvariant="normal" xref="S3.SS4.p2.12.m12.1.1.2.cmml">Φ</mi><mtext id="S3.SS4.p2.12.m12.1.1.3" xref="S3.SS4.p2.12.m12.1.1.3a.cmml">prompt</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.12.m12.1b"><apply id="S3.SS4.p2.12.m12.1.1.cmml" xref="S3.SS4.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.12.m12.1.1.1.cmml" xref="S3.SS4.p2.12.m12.1.1">subscript</csymbol><ci id="S3.SS4.p2.12.m12.1.1.2.cmml" xref="S3.SS4.p2.12.m12.1.1.2">Φ</ci><ci id="S3.SS4.p2.12.m12.1.1.3a.cmml" xref="S3.SS4.p2.12.m12.1.1.3"><mtext id="S3.SS4.p2.12.m12.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.12.m12.1.1.3">prompt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.12.m12.1c">\Phi_{\text{prompt}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.12.m12.1d">roman_Φ start_POSTSUBSCRIPT prompt end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{M}_{\text{init}}=\Phi_{\text{mask}}(\Phi_{\text{prompt}}(\mathcal{P}_%
{\text{init}}))." class="ltx_Math" display="block" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.3.2.cmml">ℳ</mi><mtext id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3a.cmml">init</mtext></msub><mo id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.E9.m1.1.1.1.1.1.3.2.cmml">Φ</mi><mtext id="S3.E9.m1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.3.3a.cmml">mask</mtext></msub><mo id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml">Φ</mi><mtext id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3a.cmml">prompt</mtext></msub><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒫</mi><mtext id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">init</mtext></msub><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m1.1.1.1.2" lspace="0em" xref="S3.E9.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"></eq><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2">ℳ</ci><ci id="S3.E9.m1.1.1.1.1.3.3a.cmml" xref="S3.E9.m1.1.1.1.1.3.3"><mtext id="S3.E9.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E9.m1.1.1.1.1.3.3">init</mtext></ci></apply><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2"></times><apply id="S3.E9.m1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2">Φ</ci><ci id="S3.E9.m1.1.1.1.1.1.3.3a.cmml" xref="S3.E9.m1.1.1.1.1.1.3.3"><mtext id="S3.E9.m1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E9.m1.1.1.1.1.1.3.3">mask</mtext></ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.2">Φ</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3"><mtext id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3">prompt</mtext></ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝒫</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3">init</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\mathcal{M}_{\text{init}}=\Phi_{\text{mask}}(\Phi_{\text{prompt}}(\mathcal{P}_%
{\text{init}})).</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">caligraphic_M start_POSTSUBSCRIPT init end_POSTSUBSCRIPT = roman_Φ start_POSTSUBSCRIPT mask end_POSTSUBSCRIPT ( roman_Φ start_POSTSUBSCRIPT prompt end_POSTSUBSCRIPT ( caligraphic_P start_POSTSUBSCRIPT init end_POSTSUBSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.13">Here, we ignore the feature from the image encoder.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.7">For images containing multiple objects, <math alttext="M_{\text{init}}" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><msub id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.2.cmml">M</mi><mtext id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3a.cmml">init</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2">𝑀</ci><ci id="S3.SS4.p3.1.m1.1.1.3a.cmml" xref="S3.SS4.p3.1.m1.1.1.3"><mtext id="S3.SS4.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p3.1.m1.1.1.3">init</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">M_{\text{init}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_M start_POSTSUBSCRIPT init end_POSTSUBSCRIPT</annotation></semantics></math> will also contain multiple masks. We first compute the Intersection over Union (IoU) between each pair of masks and construct an IoU matrix <math alttext="\mathbf{O}" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><mi id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml">𝐎</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><ci id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">𝐎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\mathbf{O}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">bold_O</annotation></semantics></math>, where each element <math alttext="\mathbf{O}_{ij}" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.1"><semantics id="S3.SS4.p3.3.m3.1a"><msub id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><mi id="S3.SS4.p3.3.m3.1.1.2" xref="S3.SS4.p3.3.m3.1.1.2.cmml">𝐎</mi><mrow id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml"><mi id="S3.SS4.p3.3.m3.1.1.3.2" xref="S3.SS4.p3.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS4.p3.3.m3.1.1.3.1" xref="S3.SS4.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p3.3.m3.1.1.3.3" xref="S3.SS4.p3.3.m3.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2">𝐎</ci><apply id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3"><times id="S3.SS4.p3.3.m3.1.1.3.1.cmml" xref="S3.SS4.p3.3.m3.1.1.3.1"></times><ci id="S3.SS4.p3.3.m3.1.1.3.2.cmml" xref="S3.SS4.p3.3.m3.1.1.3.2">𝑖</ci><ci id="S3.SS4.p3.3.m3.1.1.3.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">\mathbf{O}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m3.1d">bold_O start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the IoU between the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.p3.4.m4.1"><semantics id="S3.SS4.p3.4.m4.1a"><mi id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><ci id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.4.m4.1d">italic_i</annotation></semantics></math>-th mask <math alttext="\mathcal{M}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p3.5.m5.1"><semantics id="S3.SS4.p3.5.m5.1a"><msub id="S3.SS4.p3.5.m5.1.1" xref="S3.SS4.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.5.m5.1.1.2" xref="S3.SS4.p3.5.m5.1.1.2.cmml">ℳ</mi><mi id="S3.SS4.p3.5.m5.1.1.3" xref="S3.SS4.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.1b"><apply id="S3.SS4.p3.5.m5.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.5.m5.1.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p3.5.m5.1.1.2.cmml" xref="S3.SS4.p3.5.m5.1.1.2">ℳ</ci><ci id="S3.SS4.p3.5.m5.1.1.3.cmml" xref="S3.SS4.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.1c">\mathcal{M}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.5.m5.1d">caligraphic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS4.p3.6.m6.1"><semantics id="S3.SS4.p3.6.m6.1a"><mi id="S3.SS4.p3.6.m6.1.1" xref="S3.SS4.p3.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m6.1b"><ci id="S3.SS4.p3.6.m6.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.6.m6.1d">italic_j</annotation></semantics></math>-th mask <math alttext="\mathcal{M}_{j}" class="ltx_Math" display="inline" id="S3.SS4.p3.7.m7.1"><semantics id="S3.SS4.p3.7.m7.1a"><msub id="S3.SS4.p3.7.m7.1.1" xref="S3.SS4.p3.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.7.m7.1.1.2" xref="S3.SS4.p3.7.m7.1.1.2.cmml">ℳ</mi><mi id="S3.SS4.p3.7.m7.1.1.3" xref="S3.SS4.p3.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.7.m7.1b"><apply id="S3.SS4.p3.7.m7.1.1.cmml" xref="S3.SS4.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m7.1.1.1.cmml" xref="S3.SS4.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.p3.7.m7.1.1.2.cmml" xref="S3.SS4.p3.7.m7.1.1.2">ℳ</ci><ci id="S3.SS4.p3.7.m7.1.1.3.cmml" xref="S3.SS4.p3.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.7.m7.1c">\mathcal{M}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.7.m7.1d">caligraphic_M start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. To exclude self-correlation, we set the diagonal elements to 0:</p>
</div>
<div class="ltx_para" id="S3.SS4.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{O}_{ij}=\begin{cases}\frac{\left|\mathcal{M}_{i}\cap\mathcal{M}_{j}%
\right|}{\left|\mathcal{M}_{i}\cup\mathcal{M}_{j}\right|}&amp;\text{if }i\neq j,\\
0&amp;\text{if }i=j.\end{cases}" class="ltx_Math" display="block" id="S3.E10.m1.4"><semantics id="S3.E10.m1.4a"><mrow id="S3.E10.m1.4.5" xref="S3.E10.m1.4.5.cmml"><msub id="S3.E10.m1.4.5.2" xref="S3.E10.m1.4.5.2.cmml"><mi id="S3.E10.m1.4.5.2.2" xref="S3.E10.m1.4.5.2.2.cmml">𝐎</mi><mrow id="S3.E10.m1.4.5.2.3" xref="S3.E10.m1.4.5.2.3.cmml"><mi id="S3.E10.m1.4.5.2.3.2" xref="S3.E10.m1.4.5.2.3.2.cmml">i</mi><mo id="S3.E10.m1.4.5.2.3.1" xref="S3.E10.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.E10.m1.4.5.2.3.3" xref="S3.E10.m1.4.5.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E10.m1.4.5.1" xref="S3.E10.m1.4.5.1.cmml">=</mo><mrow id="S3.E10.m1.4.4" xref="S3.E10.m1.4.5.3.1.cmml"><mo id="S3.E10.m1.4.4.5" xref="S3.E10.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E10.m1.4.4.4" rowspacing="0pt" xref="S3.E10.m1.4.5.3.1.cmml"><mtr id="S3.E10.m1.4.4.4a" xref="S3.E10.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4b" xref="S3.E10.m1.4.5.3.1.cmml"><mstyle displaystyle="false" id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mfrac id="S3.E10.m1.1.1.1.1.1.1a" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">ℳ</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">∩</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ℳ</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E10.m1.1.1.1.1.1.1.2.2.1" xref="S3.E10.m1.1.1.1.1.1.1.2.2.2.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.2.2.1.2" xref="S3.E10.m1.1.1.1.1.1.1.2.2.2.1.cmml">|</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.cmml"><msub id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.2" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.2.cmml">ℳ</mi><mi id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.3" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.1.cmml">∪</mo><msub id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.2.cmml">ℳ</mi><mi id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.E10.m1.1.1.1.1.1.1.2.2.1.3" xref="S3.E10.m1.1.1.1.1.1.1.2.2.2.1.cmml">|</mo></mrow></mfrac></mstyle></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4c" xref="S3.E10.m1.4.5.3.1.cmml"><mrow id="S3.E10.m1.2.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="S3.E10.m1.2.2.2.2.2.1.1.1" xref="S3.E10.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="S3.E10.m1.2.2.2.2.2.1.1.1.2" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2.cmml"><mtext id="S3.E10.m1.2.2.2.2.2.1.1.1.2.2" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2.2a.cmml">if </mtext><mo id="S3.E10.m1.2.2.2.2.2.1.1.1.2.1" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="S3.E10.m1.2.2.2.2.2.1.1.1.2.3" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2.3.cmml">i</mi></mrow><mo id="S3.E10.m1.2.2.2.2.2.1.1.1.1" xref="S3.E10.m1.2.2.2.2.2.1.1.1.1.cmml">≠</mo><mi id="S3.E10.m1.2.2.2.2.2.1.1.1.3" xref="S3.E10.m1.2.2.2.2.2.1.1.1.3.cmml">j</mi></mrow><mo id="S3.E10.m1.2.2.2.2.2.1.1.2" xref="S3.E10.m1.2.2.2.2.2.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E10.m1.4.4.4d" xref="S3.E10.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4e" xref="S3.E10.m1.4.5.3.1.cmml"><mn id="S3.E10.m1.3.3.3.3.1.1" xref="S3.E10.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4f" xref="S3.E10.m1.4.5.3.1.cmml"><mrow id="S3.E10.m1.4.4.4.4.2.1.1" xref="S3.E10.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S3.E10.m1.4.4.4.4.2.1.1.1" xref="S3.E10.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S3.E10.m1.4.4.4.4.2.1.1.1.2" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.cmml"><mtext id="S3.E10.m1.4.4.4.4.2.1.1.1.2.2" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.2a.cmml">if </mtext><mo id="S3.E10.m1.4.4.4.4.2.1.1.1.2.1" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.1.cmml">⁢</mo><mi id="S3.E10.m1.4.4.4.4.2.1.1.1.2.3" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.3.cmml">i</mi></mrow><mo id="S3.E10.m1.4.4.4.4.2.1.1.1.1" xref="S3.E10.m1.4.4.4.4.2.1.1.1.1.cmml">=</mo><mi id="S3.E10.m1.4.4.4.4.2.1.1.1.3" xref="S3.E10.m1.4.4.4.4.2.1.1.1.3.cmml">j</mi></mrow><mo id="S3.E10.m1.4.4.4.4.2.1.1.2" lspace="0em" xref="S3.E10.m1.4.4.4.4.2.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.4b"><apply id="S3.E10.m1.4.5.cmml" xref="S3.E10.m1.4.5"><eq id="S3.E10.m1.4.5.1.cmml" xref="S3.E10.m1.4.5.1"></eq><apply id="S3.E10.m1.4.5.2.cmml" xref="S3.E10.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.5.2.1.cmml" xref="S3.E10.m1.4.5.2">subscript</csymbol><ci id="S3.E10.m1.4.5.2.2.cmml" xref="S3.E10.m1.4.5.2.2">𝐎</ci><apply id="S3.E10.m1.4.5.2.3.cmml" xref="S3.E10.m1.4.5.2.3"><times id="S3.E10.m1.4.5.2.3.1.cmml" xref="S3.E10.m1.4.5.2.3.1"></times><ci id="S3.E10.m1.4.5.2.3.2.cmml" xref="S3.E10.m1.4.5.2.3.2">𝑖</ci><ci id="S3.E10.m1.4.5.2.3.3.cmml" xref="S3.E10.m1.4.5.2.3.3">𝑗</ci></apply></apply><apply id="S3.E10.m1.4.5.3.1.cmml" xref="S3.E10.m1.4.4"><csymbol cd="latexml" id="S3.E10.m1.4.5.3.1.1.cmml" xref="S3.E10.m1.4.4.5">cases</csymbol><apply id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1"><divide id="S3.E10.m1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1"></divide><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1"><abs id="S3.E10.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1"><intersect id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1"></intersect><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.2">ℳ</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.2">ℳ</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E10.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1"><abs id="S3.E10.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.2"></abs><apply id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1"><union id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.1"></union><apply id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.2">ℳ</ci><ci id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.2">ℳ</ci><ci id="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2.2.1.1.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S3.E10.m1.2.2.2.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1"><neq id="S3.E10.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.1"></neq><apply id="S3.E10.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2"><times id="S3.E10.m1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2.1"></times><ci id="S3.E10.m1.2.2.2.2.2.1.1.1.2.2a.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2.2"><mtext id="S3.E10.m1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2.2">if </mtext></ci><ci id="S3.E10.m1.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E10.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.3">𝑗</ci></apply><cn id="S3.E10.m1.3.3.3.3.1.1.cmml" type="integer" xref="S3.E10.m1.3.3.3.3.1.1">0</cn><apply id="S3.E10.m1.4.4.4.4.2.1.1.1.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1"><eq id="S3.E10.m1.4.4.4.4.2.1.1.1.1.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.1"></eq><apply id="S3.E10.m1.4.4.4.4.2.1.1.1.2.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2"><times id="S3.E10.m1.4.4.4.4.2.1.1.1.2.1.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.1"></times><ci id="S3.E10.m1.4.4.4.4.2.1.1.1.2.2a.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.2"><mtext id="S3.E10.m1.4.4.4.4.2.1.1.1.2.2.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.2">if </mtext></ci><ci id="S3.E10.m1.4.4.4.4.2.1.1.1.2.3.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E10.m1.4.4.4.4.2.1.1.1.3.cmml" xref="S3.E10.m1.4.4.4.4.2.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.4c">\mathbf{O}_{ij}=\begin{cases}\frac{\left|\mathcal{M}_{i}\cap\mathcal{M}_{j}%
\right|}{\left|\mathcal{M}_{i}\cup\mathcal{M}_{j}\right|}&amp;\text{if }i\neq j,\\
0&amp;\text{if }i=j.\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.4d">bold_O start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = { start_ROW start_CELL divide start_ARG | caligraphic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∩ caligraphic_M start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | end_ARG start_ARG | caligraphic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∪ caligraphic_M start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | end_ARG end_CELL start_CELL if italic_i ≠ italic_j , end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL if italic_i = italic_j . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p5">
<p class="ltx_p" id="S3.SS4.p5.3">For masks that intersect with a given instance mask, we identify corresponding positive prompts as candidate negative prompts. Specifically, for a given mask <math alttext="\mathcal{M}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p5.1.m1.1"><semantics id="S3.SS4.p5.1.m1.1a"><msub id="S3.SS4.p5.1.m1.1.1" xref="S3.SS4.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.1.m1.1.1.2" xref="S3.SS4.p5.1.m1.1.1.2.cmml">ℳ</mi><mi id="S3.SS4.p5.1.m1.1.1.3" xref="S3.SS4.p5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b"><apply id="S3.SS4.p5.1.m1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.1.m1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p5.1.m1.1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.1.2">ℳ</ci><ci id="S3.SS4.p5.1.m1.1.1.3.cmml" xref="S3.SS4.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">\mathcal{M}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, the set of candidate negative prompts <math alttext="\mathcal{P}_{\text{neg},i}" class="ltx_Math" display="inline" id="S3.SS4.p5.2.m2.2"><semantics id="S3.SS4.p5.2.m2.2a"><msub id="S3.SS4.p5.2.m2.2.3" xref="S3.SS4.p5.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.2.m2.2.3.2" xref="S3.SS4.p5.2.m2.2.3.2.cmml">𝒫</mi><mrow id="S3.SS4.p5.2.m2.2.2.2.4" xref="S3.SS4.p5.2.m2.2.2.2.3.cmml"><mtext id="S3.SS4.p5.2.m2.1.1.1.1" xref="S3.SS4.p5.2.m2.1.1.1.1a.cmml">neg</mtext><mo id="S3.SS4.p5.2.m2.2.2.2.4.1" xref="S3.SS4.p5.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p5.2.m2.2.2.2.2" xref="S3.SS4.p5.2.m2.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.m2.2b"><apply id="S3.SS4.p5.2.m2.2.3.cmml" xref="S3.SS4.p5.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p5.2.m2.2.3.1.cmml" xref="S3.SS4.p5.2.m2.2.3">subscript</csymbol><ci id="S3.SS4.p5.2.m2.2.3.2.cmml" xref="S3.SS4.p5.2.m2.2.3.2">𝒫</ci><list id="S3.SS4.p5.2.m2.2.2.2.3.cmml" xref="S3.SS4.p5.2.m2.2.2.2.4"><ci id="S3.SS4.p5.2.m2.1.1.1.1a.cmml" xref="S3.SS4.p5.2.m2.1.1.1.1"><mtext id="S3.SS4.p5.2.m2.1.1.1.1.cmml" mathsize="70%" xref="S3.SS4.p5.2.m2.1.1.1.1">neg</mtext></ci><ci id="S3.SS4.p5.2.m2.2.2.2.2.cmml" xref="S3.SS4.p5.2.m2.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.2.m2.2c">\mathcal{P}_{\text{neg},i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.2.m2.2d">caligraphic_P start_POSTSUBSCRIPT neg , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is derived from the positive prompts of masks that intersect with <math alttext="\mathcal{M}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p5.3.m3.1"><semantics id="S3.SS4.p5.3.m3.1a"><msub id="S3.SS4.p5.3.m3.1.1" xref="S3.SS4.p5.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p5.3.m3.1.1.2" xref="S3.SS4.p5.3.m3.1.1.2.cmml">ℳ</mi><mi id="S3.SS4.p5.3.m3.1.1.3" xref="S3.SS4.p5.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p5.3.m3.1b"><apply id="S3.SS4.p5.3.m3.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p5.3.m3.1.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p5.3.m3.1.1.2.cmml" xref="S3.SS4.p5.3.m3.1.1.2">ℳ</ci><ci id="S3.SS4.p5.3.m3.1.1.3.cmml" xref="S3.SS4.p5.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p5.3.m3.1c">\mathcal{M}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p5.3.m3.1d">caligraphic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
</div>
<div class="ltx_para" id="S3.SS4.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathcal{P}}^{\text{neg}}=\left\{\mathbf{p}^{\text{pos}}_{j}\mid\mathbf{O%
}_{ij}\geq\tau_{\text{IoU}},\;j\neq i\right\}." class="ltx_Math" display="block" id="S3.E11.m1.1"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml"><msup id="S3.E11.m1.1.1.1.1.4" xref="S3.E11.m1.1.1.1.1.4.cmml"><mover accent="true" id="S3.E11.m1.1.1.1.1.4.2" xref="S3.E11.m1.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.1.1.1.4.2.2" xref="S3.E11.m1.1.1.1.1.4.2.2.cmml">𝒫</mi><mo id="S3.E11.m1.1.1.1.1.4.2.1" xref="S3.E11.m1.1.1.1.1.4.2.1.cmml">^</mo></mover><mtext id="S3.E11.m1.1.1.1.1.4.3" xref="S3.E11.m1.1.1.1.1.4.3a.cmml">neg</mtext></msup><mo id="S3.E11.m1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E11.m1.1.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.2.3.cmml"><mo id="S3.E11.m1.1.1.1.1.2.2.3" xref="S3.E11.m1.1.1.1.1.2.3.1.cmml">{</mo><msubsup id="S3.E11.m1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.1.1.1.2.2.cmml">𝐩</mi><mi id="S3.E11.m1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.3.cmml">j</mi><mtext id="S3.E11.m1.1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.1.1.1.2.3a.cmml">pos</mtext></msubsup><mo fence="true" id="S3.E11.m1.1.1.1.1.2.2.4" lspace="0em" rspace="0em" xref="S3.E11.m1.1.1.1.1.2.3.1.cmml">∣</mo><mrow id="S3.E11.m1.1.1.1.1.2.2.2.2" xref="S3.E11.m1.1.1.1.1.2.2.2.3.cmml"><mrow id="S3.E11.m1.1.1.1.1.2.2.2.1.1" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.cmml"><msub id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.cmml"><mi id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.2" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.2.cmml">𝐎</mi><mrow id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.2" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.2.cmml">i</mi><mo id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.1" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.3" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E11.m1.1.1.1.1.2.2.2.1.1.1" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.1.cmml">≥</mo><msub id="S3.E11.m1.1.1.1.1.2.2.2.1.1.3" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.cmml"><mi id="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.2" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.2.cmml">τ</mi><mtext id="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.3" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.3a.cmml">IoU</mtext></msub></mrow><mo id="S3.E11.m1.1.1.1.1.2.2.2.2.3" rspace="0.447em" xref="S3.E11.m1.1.1.1.1.2.2.2.3a.cmml">,</mo><mrow id="S3.E11.m1.1.1.1.1.2.2.2.2.2" xref="S3.E11.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E11.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E11.m1.1.1.1.1.2.2.2.2.2.2.cmml">j</mi><mo id="S3.E11.m1.1.1.1.1.2.2.2.2.2.1" xref="S3.E11.m1.1.1.1.1.2.2.2.2.2.1.cmml">≠</mo><mi id="S3.E11.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E11.m1.1.1.1.1.2.2.2.2.2.3.cmml">i</mi></mrow></mrow><mo id="S3.E11.m1.1.1.1.1.2.2.5" xref="S3.E11.m1.1.1.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="S3.E11.m1.1.1.1.2" lspace="0em" xref="S3.E11.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1"><eq id="S3.E11.m1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.3"></eq><apply id="S3.E11.m1.1.1.1.1.4.cmml" xref="S3.E11.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.4.1.cmml" xref="S3.E11.m1.1.1.1.1.4">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.4.2.cmml" xref="S3.E11.m1.1.1.1.1.4.2"><ci id="S3.E11.m1.1.1.1.1.4.2.1.cmml" xref="S3.E11.m1.1.1.1.1.4.2.1">^</ci><ci id="S3.E11.m1.1.1.1.1.4.2.2.cmml" xref="S3.E11.m1.1.1.1.1.4.2.2">𝒫</ci></apply><ci id="S3.E11.m1.1.1.1.1.4.3a.cmml" xref="S3.E11.m1.1.1.1.1.4.3"><mtext id="S3.E11.m1.1.1.1.1.4.3.cmml" mathsize="70%" xref="S3.E11.m1.1.1.1.1.4.3">neg</mtext></ci></apply><apply id="S3.E11.m1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2"><csymbol cd="latexml" id="S3.E11.m1.1.1.1.1.2.3.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.3">conditional-set</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.2.2">𝐩</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.2.3"><mtext id="S3.E11.m1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E11.m1.1.1.1.1.1.1.1.2.3">pos</mtext></ci></apply><ci id="S3.E11.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E11.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.2.2.3a.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E11.m1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1"><geq id="S3.E11.m1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.1"></geq><apply id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.2">𝐎</ci><apply id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3"><times id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.1"></times><ci id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.2">𝑖</ci><ci id="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.2">𝜏</ci><ci id="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.3a.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.3"><mtext id="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.3.cmml" mathsize="70%" xref="S3.E11.m1.1.1.1.1.2.2.2.1.1.3.3">IoU</mtext></ci></apply></apply><apply id="S3.E11.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.2"><neq id="S3.E11.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.2.1"></neq><ci id="S3.E11.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.2.2">𝑗</ci><ci id="S3.E11.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E11.m1.1.1.1.1.2.2.2.2.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">\hat{\mathcal{P}}^{\text{neg}}=\left\{\mathbf{p}^{\text{pos}}_{j}\mid\mathbf{O%
}_{ij}\geq\tau_{\text{IoU}},\;j\neq i\right\}.</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.1d">over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT neg end_POSTSUPERSCRIPT = { bold_p start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∣ bold_O start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ≥ italic_τ start_POSTSUBSCRIPT IoU end_POSTSUBSCRIPT , italic_j ≠ italic_i } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p7">
<p class="ltx_p" id="S3.SS4.p7.4">We then randomly select <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.p7.1.m1.1"><semantics id="S3.SS4.p7.1.m1.1a"><mi id="S3.SS4.p7.1.m1.1.1" xref="S3.SS4.p7.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.1.m1.1b"><ci id="S3.SS4.p7.1.m1.1.1.cmml" xref="S3.SS4.p7.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.1.m1.1d">italic_k</annotation></semantics></math> prompts from <math alttext="\hat{\mathcal{P}}^{\text{neg}}" class="ltx_Math" display="inline" id="S3.SS4.p7.2.m2.1"><semantics id="S3.SS4.p7.2.m2.1a"><msup id="S3.SS4.p7.2.m2.1.1" xref="S3.SS4.p7.2.m2.1.1.cmml"><mover accent="true" id="S3.SS4.p7.2.m2.1.1.2" xref="S3.SS4.p7.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p7.2.m2.1.1.2.2" xref="S3.SS4.p7.2.m2.1.1.2.2.cmml">𝒫</mi><mo id="S3.SS4.p7.2.m2.1.1.2.1" xref="S3.SS4.p7.2.m2.1.1.2.1.cmml">^</mo></mover><mtext id="S3.SS4.p7.2.m2.1.1.3" xref="S3.SS4.p7.2.m2.1.1.3a.cmml">neg</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.2.m2.1b"><apply id="S3.SS4.p7.2.m2.1.1.cmml" xref="S3.SS4.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p7.2.m2.1.1.1.cmml" xref="S3.SS4.p7.2.m2.1.1">superscript</csymbol><apply id="S3.SS4.p7.2.m2.1.1.2.cmml" xref="S3.SS4.p7.2.m2.1.1.2"><ci id="S3.SS4.p7.2.m2.1.1.2.1.cmml" xref="S3.SS4.p7.2.m2.1.1.2.1">^</ci><ci id="S3.SS4.p7.2.m2.1.1.2.2.cmml" xref="S3.SS4.p7.2.m2.1.1.2.2">𝒫</ci></apply><ci id="S3.SS4.p7.2.m2.1.1.3a.cmml" xref="S3.SS4.p7.2.m2.1.1.3"><mtext id="S3.SS4.p7.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p7.2.m2.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.2.m2.1c">\hat{\mathcal{P}}^{\text{neg}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.2.m2.1d">over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT neg end_POSTSUPERSCRIPT</annotation></semantics></math> as the new negative prompts <math alttext="\tilde{\mathcal{P}}^{\text{neg}}" class="ltx_Math" display="inline" id="S3.SS4.p7.3.m3.1"><semantics id="S3.SS4.p7.3.m3.1a"><msup id="S3.SS4.p7.3.m3.1.1" xref="S3.SS4.p7.3.m3.1.1.cmml"><mover accent="true" id="S3.SS4.p7.3.m3.1.1.2" xref="S3.SS4.p7.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p7.3.m3.1.1.2.2" xref="S3.SS4.p7.3.m3.1.1.2.2.cmml">𝒫</mi><mo id="S3.SS4.p7.3.m3.1.1.2.1" xref="S3.SS4.p7.3.m3.1.1.2.1.cmml">~</mo></mover><mtext id="S3.SS4.p7.3.m3.1.1.3" xref="S3.SS4.p7.3.m3.1.1.3a.cmml">neg</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.3.m3.1b"><apply id="S3.SS4.p7.3.m3.1.1.cmml" xref="S3.SS4.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p7.3.m3.1.1.1.cmml" xref="S3.SS4.p7.3.m3.1.1">superscript</csymbol><apply id="S3.SS4.p7.3.m3.1.1.2.cmml" xref="S3.SS4.p7.3.m3.1.1.2"><ci id="S3.SS4.p7.3.m3.1.1.2.1.cmml" xref="S3.SS4.p7.3.m3.1.1.2.1">~</ci><ci id="S3.SS4.p7.3.m3.1.1.2.2.cmml" xref="S3.SS4.p7.3.m3.1.1.2.2">𝒫</ci></apply><ci id="S3.SS4.p7.3.m3.1.1.3a.cmml" xref="S3.SS4.p7.3.m3.1.1.3"><mtext id="S3.SS4.p7.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p7.3.m3.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.3.m3.1c">\tilde{\mathcal{P}}^{\text{neg}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.3.m3.1d">over~ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT neg end_POSTSUPERSCRIPT</annotation></semantics></math> for the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.p7.4.m4.1"><semantics id="S3.SS4.p7.4.m4.1a"><mi id="S3.SS4.p7.4.m4.1.1" xref="S3.SS4.p7.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p7.4.m4.1b"><ci id="S3.SS4.p7.4.m4.1.1.cmml" xref="S3.SS4.p7.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p7.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p7.4.m4.1d">italic_i</annotation></semantics></math>-th instance:</p>
</div>
<div class="ltx_para" id="S3.SS4.p8">
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\mathcal{P}}^{\text{neg}}\subset\hat{\mathcal{P}}^{\text{neg}},\quad%
\text{with }|\tilde{\mathcal{P}}^{\text{neg}}|=k." class="ltx_Math" display="block" id="S3.E12.m1.1"><semantics id="S3.E12.m1.1a"><mrow id="S3.E12.m1.1.1.1"><mrow id="S3.E12.m1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.3.cmml"><mrow id="S3.E12.m1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.cmml"><msup id="S3.E12.m1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E12.m1.1.1.1.1.1.1.2.2" xref="S3.E12.m1.1.1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.1.1.1.1.1.1.2.2.2" xref="S3.E12.m1.1.1.1.1.1.1.2.2.2.cmml">𝒫</mi><mo id="S3.E12.m1.1.1.1.1.1.1.2.2.1" xref="S3.E12.m1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mtext id="S3.E12.m1.1.1.1.1.1.1.2.3" xref="S3.E12.m1.1.1.1.1.1.1.2.3a.cmml">neg</mtext></msup><mo id="S3.E12.m1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.cmml">⊂</mo><msup id="S3.E12.m1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E12.m1.1.1.1.1.1.1.3.2" xref="S3.E12.m1.1.1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.1.1.1.1.1.1.3.2.2" xref="S3.E12.m1.1.1.1.1.1.1.3.2.2.cmml">𝒫</mi><mo id="S3.E12.m1.1.1.1.1.1.1.3.2.1" xref="S3.E12.m1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mtext id="S3.E12.m1.1.1.1.1.1.1.3.3" xref="S3.E12.m1.1.1.1.1.1.1.3.3a.cmml">neg</mtext></msup></mrow><mo id="S3.E12.m1.1.1.1.1.2.3" rspace="1.167em" xref="S3.E12.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E12.m1.1.1.1.1.2.2" xref="S3.E12.m1.1.1.1.1.2.2.cmml"><mrow id="S3.E12.m1.1.1.1.1.2.2.1" xref="S3.E12.m1.1.1.1.1.2.2.1.cmml"><mtext id="S3.E12.m1.1.1.1.1.2.2.1.3" xref="S3.E12.m1.1.1.1.1.2.2.1.3a.cmml">with </mtext><mo id="S3.E12.m1.1.1.1.1.2.2.1.2" xref="S3.E12.m1.1.1.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.1.1.1.1.2.2.1.1.1" xref="S3.E12.m1.1.1.1.1.2.2.1.1.2.cmml"><mo id="S3.E12.m1.1.1.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E12.m1.1.1.1.1.2.2.1.1.2.1.cmml">|</mo><msup id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mover accent="true" id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2.2" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml">𝒫</mi><mo id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2.1" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2.1.cmml">~</mo></mover><mtext id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.3a.cmml">neg</mtext></msup><mo id="S3.E12.m1.1.1.1.1.2.2.1.1.1.3" stretchy="false" xref="S3.E12.m1.1.1.1.1.2.2.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S3.E12.m1.1.1.1.1.2.2.2" xref="S3.E12.m1.1.1.1.1.2.2.2.cmml">=</mo><mi id="S3.E12.m1.1.1.1.1.2.2.3" xref="S3.E12.m1.1.1.1.1.2.2.3.cmml">k</mi></mrow></mrow><mo id="S3.E12.m1.1.1.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.3a.cmml" xref="S3.E12.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E12.m1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1"><subset id="S3.E12.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1"></subset><apply id="S3.E12.m1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.2"><ci id="S3.E12.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.2.1">~</ci><ci id="S3.E12.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.2.2">𝒫</ci></apply><ci id="S3.E12.m1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.3"><mtext id="S3.E12.m1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E12.m1.1.1.1.1.1.1.2.3">neg</mtext></ci></apply><apply id="S3.E12.m1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.3.2"><ci id="S3.E12.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E12.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.3.2.2">𝒫</ci></apply><ci id="S3.E12.m1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E12.m1.1.1.1.1.1.1.3.3"><mtext id="S3.E12.m1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E12.m1.1.1.1.1.1.1.3.3">neg</mtext></ci></apply></apply><apply id="S3.E12.m1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.2.2"><eq id="S3.E12.m1.1.1.1.1.2.2.2.cmml" xref="S3.E12.m1.1.1.1.1.2.2.2"></eq><apply id="S3.E12.m1.1.1.1.1.2.2.1.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1"><times id="S3.E12.m1.1.1.1.1.2.2.1.2.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.2"></times><ci id="S3.E12.m1.1.1.1.1.2.2.1.3a.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.3"><mtext id="S3.E12.m1.1.1.1.1.2.2.1.3.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.3">with </mtext></ci><apply id="S3.E12.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1"><abs id="S3.E12.m1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.2"></abs><apply id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2"><ci id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2.1">~</ci><ci id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.2.2">𝒫</ci></apply><ci id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.3a.cmml" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.3"><mtext id="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E12.m1.1.1.1.1.2.2.1.1.1.1.3">neg</mtext></ci></apply></apply></apply><ci id="S3.E12.m1.1.1.1.1.2.2.3.cmml" xref="S3.E12.m1.1.1.1.1.2.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\tilde{\mathcal{P}}^{\text{neg}}\subset\hat{\mathcal{P}}^{\text{neg}},\quad%
\text{with }|\tilde{\mathcal{P}}^{\text{neg}}|=k.</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.1d">over~ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT neg end_POSTSUPERSCRIPT ⊂ over^ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT neg end_POSTSUPERSCRIPT , with | over~ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT neg end_POSTSUPERSCRIPT | = italic_k .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p9">
<p class="ltx_p" id="S3.SS4.p9.1">After obtaining the new negative prompts, we input them along with the initial positive prompts into SAM’s mask prompt to obtain the final refined masks <math alttext="\mathcal{M}^{r}" class="ltx_Math" display="inline" id="S3.SS4.p9.1.m1.1"><semantics id="S3.SS4.p9.1.m1.1a"><msup id="S3.SS4.p9.1.m1.1.1" xref="S3.SS4.p9.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p9.1.m1.1.1.2" xref="S3.SS4.p9.1.m1.1.1.2.cmml">ℳ</mi><mi id="S3.SS4.p9.1.m1.1.1.3" xref="S3.SS4.p9.1.m1.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p9.1.m1.1b"><apply id="S3.SS4.p9.1.m1.1.1.cmml" xref="S3.SS4.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p9.1.m1.1.1.1.cmml" xref="S3.SS4.p9.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p9.1.m1.1.1.2.cmml" xref="S3.SS4.p9.1.m1.1.1.2">ℳ</ci><ci id="S3.SS4.p9.1.m1.1.1.3.cmml" xref="S3.SS4.p9.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p9.1.m1.1c">\mathcal{M}^{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p9.1.m1.1d">caligraphic_M start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
</div>
<div class="ltx_para" id="S3.SS4.p10">
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{M}^{r}=\Phi_{\text{mask}}(\Phi_{\text{prompt}}(\mathcal{P}^{\text{pos%
}},\tilde{\mathcal{P}}^{\text{neg}}))." class="ltx_Math" display="block" id="S3.E13.m1.1"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><msup id="S3.E13.m1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.3.2" xref="S3.E13.m1.1.1.1.1.3.2.cmml">ℳ</mi><mi id="S3.E13.m1.1.1.1.1.3.3" xref="S3.E13.m1.1.1.1.1.3.3.cmml">r</mi></msup><mo id="S3.E13.m1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.cmml"><msub id="S3.E13.m1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.3.cmml"><mi id="S3.E13.m1.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.E13.m1.1.1.1.1.1.3.2.cmml">Φ</mi><mtext id="S3.E13.m1.1.1.1.1.1.3.3" xref="S3.E13.m1.1.1.1.1.1.3.3a.cmml">mask</mtext></msub><mo id="S3.E13.m1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E13.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E13.m1.1.1.1.1.1.1.1.1.4" xref="S3.E13.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E13.m1.1.1.1.1.1.1.1.1.4.2" mathvariant="normal" xref="S3.E13.m1.1.1.1.1.1.1.1.1.4.2.cmml">Φ</mi><mtext id="S3.E13.m1.1.1.1.1.1.1.1.1.4.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.4.3a.cmml">prompt</mtext></msub><mo id="S3.E13.m1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msup id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒫</mi><mtext id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">pos</mtext></msup><mo id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝒫</mi><mo id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2.1" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">~</mo></mover><mtext id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.3a.cmml">neg</mtext></msup><mo id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E13.m1.1.1.1.2" lspace="0em" xref="S3.E13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"><eq id="S3.E13.m1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.2"></eq><apply id="S3.E13.m1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2">ℳ</ci><ci id="S3.E13.m1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3">𝑟</ci></apply><apply id="S3.E13.m1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"><times id="S3.E13.m1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.2"></times><apply id="S3.E13.m1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.1.3.2">Φ</ci><ci id="S3.E13.m1.1.1.1.1.1.3.3a.cmml" xref="S3.E13.m1.1.1.1.1.1.3.3"><mtext id="S3.E13.m1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E13.m1.1.1.1.1.1.3.3">mask</mtext></ci></apply><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1"><times id="S3.E13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.3"></times><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.4.2">Φ</ci><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.4.3a.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.4.3"><mtext id="S3.E13.m1.1.1.1.1.1.1.1.1.4.3.cmml" mathsize="70%" xref="S3.E13.m1.1.1.1.1.1.1.1.1.4.3">prompt</mtext></ci></apply><interval closure="open" id="S3.E13.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝒫</ci><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3">pos</mtext></ci></apply><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2"><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2.1">~</ci><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝒫</ci></apply><ci id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.3a.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.3"><mtext id="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" mathsize="70%" xref="S3.E13.m1.1.1.1.1.1.1.1.1.2.2.2.3">neg</mtext></ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\mathcal{M}^{r}=\Phi_{\text{mask}}(\Phi_{\text{prompt}}(\mathcal{P}^{\text{pos%
}},\tilde{\mathcal{P}}^{\text{neg}})).</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.1d">caligraphic_M start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT = roman_Φ start_POSTSUBSCRIPT mask end_POSTSUBSCRIPT ( roman_Φ start_POSTSUBSCRIPT prompt end_POSTSUBSCRIPT ( caligraphic_P start_POSTSUPERSCRIPT pos end_POSTSUPERSCRIPT , over~ start_ARG caligraphic_P end_ARG start_POSTSUPERSCRIPT neg end_POSTSUPERSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p11">
<p class="ltx_p" id="S3.SS4.p11.2">In this way, the refined mask <math alttext="\mathcal{M}^{r}" class="ltx_Math" display="inline" id="S3.SS4.p11.1.m1.1"><semantics id="S3.SS4.p11.1.m1.1a"><msup id="S3.SS4.p11.1.m1.1.1" xref="S3.SS4.p11.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p11.1.m1.1.1.2" xref="S3.SS4.p11.1.m1.1.1.2.cmml">ℳ</mi><mi id="S3.SS4.p11.1.m1.1.1.3" xref="S3.SS4.p11.1.m1.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p11.1.m1.1b"><apply id="S3.SS4.p11.1.m1.1.1.cmml" xref="S3.SS4.p11.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p11.1.m1.1.1.1.cmml" xref="S3.SS4.p11.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p11.1.m1.1.1.2.cmml" xref="S3.SS4.p11.1.m1.1.1.2">ℳ</ci><ci id="S3.SS4.p11.1.m1.1.1.3.cmml" xref="S3.SS4.p11.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p11.1.m1.1c">\mathcal{M}^{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p11.1.m1.1d">caligraphic_M start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> can be used as a pseudo-label to supervise the mask <math alttext="\mathcal{M}^{s}" class="ltx_Math" display="inline" id="S3.SS4.p11.2.m2.1"><semantics id="S3.SS4.p11.2.m2.1a"><msup id="S3.SS4.p11.2.m2.1.1" xref="S3.SS4.p11.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p11.2.m2.1.1.2" xref="S3.SS4.p11.2.m2.1.1.2.cmml">ℳ</mi><mi id="S3.SS4.p11.2.m2.1.1.3" xref="S3.SS4.p11.2.m2.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p11.2.m2.1b"><apply id="S3.SS4.p11.2.m2.1.1.cmml" xref="S3.SS4.p11.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p11.2.m2.1.1.1.cmml" xref="S3.SS4.p11.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.p11.2.m2.1.1.2.cmml" xref="S3.SS4.p11.2.m2.1.1.2">ℳ</ci><ci id="S3.SS4.p11.2.m2.1.1.3.cmml" xref="S3.SS4.p11.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p11.2.m2.1c">\mathcal{M}^{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p11.2.m2.1d">caligraphic_M start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> predicted by the student. We will introduce the loss function for supervision in the next section.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS5.5.1.1">III-E</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS5.6.2">Total Loss</span>
</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.7">In the original SAM model, there are three loss functions: IoU loss <math alttext="\mathcal{L}_{\text{IoU}}" class="ltx_Math" display="inline" id="S3.SS5.p1.1.m1.1"><semantics id="S3.SS5.p1.1.m1.1a"><msub id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.1.m1.1.1.2" xref="S3.SS5.p1.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS5.p1.1.m1.1.1.3" xref="S3.SS5.p1.1.m1.1.1.3a.cmml">IoU</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><apply id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p1.1.m1.1.1.2.cmml" xref="S3.SS5.p1.1.m1.1.1.2">ℒ</ci><ci id="S3.SS5.p1.1.m1.1.1.3a.cmml" xref="S3.SS5.p1.1.m1.1.1.3"><mtext id="S3.SS5.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p1.1.m1.1.1.3">IoU</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">\mathcal{L}_{\text{IoU}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT IoU end_POSTSUBSCRIPT</annotation></semantics></math>, Dice loss <math alttext="\mathcal{L}_{\text{dice}}" class="ltx_Math" display="inline" id="S3.SS5.p1.2.m2.1"><semantics id="S3.SS5.p1.2.m2.1a"><msub id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.2.m2.1.1.2" xref="S3.SS5.p1.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS5.p1.2.m2.1.1.3" xref="S3.SS5.p1.2.m2.1.1.3a.cmml">dice</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><apply id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.2.m2.1.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.p1.2.m2.1.1.2.cmml" xref="S3.SS5.p1.2.m2.1.1.2">ℒ</ci><ci id="S3.SS5.p1.2.m2.1.1.3a.cmml" xref="S3.SS5.p1.2.m2.1.1.3"><mtext id="S3.SS5.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p1.2.m2.1.1.3">dice</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">\mathcal{L}_{\text{dice}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT dice end_POSTSUBSCRIPT</annotation></semantics></math>, and Focal loss <math alttext="\mathcal{L}_{\text{focal}}" class="ltx_Math" display="inline" id="S3.SS5.p1.3.m3.1"><semantics id="S3.SS5.p1.3.m3.1a"><msub id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.3.m3.1.1.2" xref="S3.SS5.p1.3.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS5.p1.3.m3.1.1.3" xref="S3.SS5.p1.3.m3.1.1.3a.cmml">focal</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.1b"><apply id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m3.1.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS5.p1.3.m3.1.1.2.cmml" xref="S3.SS5.p1.3.m3.1.1.2">ℒ</ci><ci id="S3.SS5.p1.3.m3.1.1.3a.cmml" xref="S3.SS5.p1.3.m3.1.1.3"><mtext id="S3.SS5.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p1.3.m3.1.1.3">focal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">\mathcal{L}_{\text{focal}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT focal end_POSTSUBSCRIPT</annotation></semantics></math>. These losses are applied to the GT masks and predicted masks. However, in our case, since there are no GT masks, we use these three losses to supervise the student model’s predictions <math alttext="\mathcal{M}^{s}" class="ltx_Math" display="inline" id="S3.SS5.p1.4.m4.1"><semantics id="S3.SS5.p1.4.m4.1a"><msup id="S3.SS5.p1.4.m4.1.1" xref="S3.SS5.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.4.m4.1.1.2" xref="S3.SS5.p1.4.m4.1.1.2.cmml">ℳ</mi><mi id="S3.SS5.p1.4.m4.1.1.3" xref="S3.SS5.p1.4.m4.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.1b"><apply id="S3.SS5.p1.4.m4.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS5.p1.4.m4.1.1.2.cmml" xref="S3.SS5.p1.4.m4.1.1.2">ℳ</ci><ci id="S3.SS5.p1.4.m4.1.1.3.cmml" xref="S3.SS5.p1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.1c">\mathcal{M}^{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.4.m4.1d">caligraphic_M start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> with the refined masks <math alttext="\mathcal{M}^{r}" class="ltx_Math" display="inline" id="S3.SS5.p1.5.m5.1"><semantics id="S3.SS5.p1.5.m5.1a"><msup id="S3.SS5.p1.5.m5.1.1" xref="S3.SS5.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.5.m5.1.1.2" xref="S3.SS5.p1.5.m5.1.1.2.cmml">ℳ</mi><mi id="S3.SS5.p1.5.m5.1.1.3" xref="S3.SS5.p1.5.m5.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.5.m5.1b"><apply id="S3.SS5.p1.5.m5.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.5.m5.1.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS5.p1.5.m5.1.1.2.cmml" xref="S3.SS5.p1.5.m5.1.1.2">ℳ</ci><ci id="S3.SS5.p1.5.m5.1.1.3.cmml" xref="S3.SS5.p1.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.5.m5.1c">\mathcal{M}^{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.5.m5.1d">caligraphic_M start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> predicted by the teacher. Additionally, we include the matching loss <math alttext="\mathcal{L}_{\text{match}}" class="ltx_Math" display="inline" id="S3.SS5.p1.6.m6.1"><semantics id="S3.SS5.p1.6.m6.1a"><msub id="S3.SS5.p1.6.m6.1.1" xref="S3.SS5.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.6.m6.1.1.2" xref="S3.SS5.p1.6.m6.1.1.2.cmml">ℒ</mi><mtext id="S3.SS5.p1.6.m6.1.1.3" xref="S3.SS5.p1.6.m6.1.1.3a.cmml">match</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.6.m6.1b"><apply id="S3.SS5.p1.6.m6.1.1.cmml" xref="S3.SS5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.6.m6.1.1.1.cmml" xref="S3.SS5.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS5.p1.6.m6.1.1.2.cmml" xref="S3.SS5.p1.6.m6.1.1.2">ℒ</ci><ci id="S3.SS5.p1.6.m6.1.1.3a.cmml" xref="S3.SS5.p1.6.m6.1.1.3"><mtext id="S3.SS5.p1.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p1.6.m6.1.1.3">match</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.6.m6.1c">\mathcal{L}_{\text{match}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.6.m6.1d">caligraphic_L start_POSTSUBSCRIPT match end_POSTSUBSCRIPT</annotation></semantics></math> to constrain the target and predicted prototypes. The total loss <math alttext="\mathcal{L}_{\text{total}}" class="ltx_Math" display="inline" id="S3.SS5.p1.7.m7.1"><semantics id="S3.SS5.p1.7.m7.1a"><msub id="S3.SS5.p1.7.m7.1.1" xref="S3.SS5.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.7.m7.1.1.2" xref="S3.SS5.p1.7.m7.1.1.2.cmml">ℒ</mi><mtext id="S3.SS5.p1.7.m7.1.1.3" xref="S3.SS5.p1.7.m7.1.1.3a.cmml">total</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.7.m7.1b"><apply id="S3.SS5.p1.7.m7.1.1.cmml" xref="S3.SS5.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.7.m7.1.1.1.cmml" xref="S3.SS5.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS5.p1.7.m7.1.1.2.cmml" xref="S3.SS5.p1.7.m7.1.1.2">ℒ</ci><ci id="S3.SS5.p1.7.m7.1.1.3a.cmml" xref="S3.SS5.p1.7.m7.1.1.3"><mtext id="S3.SS5.p1.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p1.7.m7.1.1.3">total</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.7.m7.1c">\mathcal{L}_{\text{total}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.7.m7.1d">caligraphic_L start_POSTSUBSCRIPT total end_POSTSUBSCRIPT</annotation></semantics></math> is defined as:</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{total}}=\lambda_{\text{focal}}\mathcal{L}_{\text{focal}}+%
\mathcal{L}_{\text{dice}}+\lambda_{\text{match}}\mathcal{L}_{\text{match}}+%
\mathcal{L}_{\text{IoU}}." class="ltx_Math" display="block" id="S3.E14.m1.1"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><msub id="S3.E14.m1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E14.m1.1.1.1.1.2.3" xref="S3.E14.m1.1.1.1.1.2.3a.cmml">total</mtext></msub><mo id="S3.E14.m1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E14.m1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.3.cmml"><mrow id="S3.E14.m1.1.1.1.1.3.2" xref="S3.E14.m1.1.1.1.1.3.2.cmml"><msub id="S3.E14.m1.1.1.1.1.3.2.2" xref="S3.E14.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E14.m1.1.1.1.1.3.2.2.2" xref="S3.E14.m1.1.1.1.1.3.2.2.2.cmml">λ</mi><mtext id="S3.E14.m1.1.1.1.1.3.2.2.3" xref="S3.E14.m1.1.1.1.1.3.2.2.3a.cmml">focal</mtext></msub><mo id="S3.E14.m1.1.1.1.1.3.2.1" xref="S3.E14.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E14.m1.1.1.1.1.3.2.3" xref="S3.E14.m1.1.1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.1.1.3.2.3.2" xref="S3.E14.m1.1.1.1.1.3.2.3.2.cmml">ℒ</mi><mtext id="S3.E14.m1.1.1.1.1.3.2.3.3" xref="S3.E14.m1.1.1.1.1.3.2.3.3a.cmml">focal</mtext></msub></mrow><mo id="S3.E14.m1.1.1.1.1.3.1" xref="S3.E14.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E14.m1.1.1.1.1.3.3" xref="S3.E14.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.1.1.3.3.2" xref="S3.E14.m1.1.1.1.1.3.3.2.cmml">ℒ</mi><mtext id="S3.E14.m1.1.1.1.1.3.3.3" xref="S3.E14.m1.1.1.1.1.3.3.3a.cmml">dice</mtext></msub><mo id="S3.E14.m1.1.1.1.1.3.1a" xref="S3.E14.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E14.m1.1.1.1.1.3.4" xref="S3.E14.m1.1.1.1.1.3.4.cmml"><msub id="S3.E14.m1.1.1.1.1.3.4.2" xref="S3.E14.m1.1.1.1.1.3.4.2.cmml"><mi id="S3.E14.m1.1.1.1.1.3.4.2.2" xref="S3.E14.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mtext id="S3.E14.m1.1.1.1.1.3.4.2.3" xref="S3.E14.m1.1.1.1.1.3.4.2.3a.cmml">match</mtext></msub><mo id="S3.E14.m1.1.1.1.1.3.4.1" xref="S3.E14.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="S3.E14.m1.1.1.1.1.3.4.3" xref="S3.E14.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.1.1.3.4.3.2" xref="S3.E14.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mtext id="S3.E14.m1.1.1.1.1.3.4.3.3" xref="S3.E14.m1.1.1.1.1.3.4.3.3a.cmml">match</mtext></msub></mrow><mo id="S3.E14.m1.1.1.1.1.3.1b" xref="S3.E14.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E14.m1.1.1.1.1.3.5" xref="S3.E14.m1.1.1.1.1.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.1.1.3.5.2" xref="S3.E14.m1.1.1.1.1.3.5.2.cmml">ℒ</mi><mtext id="S3.E14.m1.1.1.1.1.3.5.3" xref="S3.E14.m1.1.1.1.1.3.5.3a.cmml">IoU</mtext></msub></mrow></mrow><mo id="S3.E14.m1.1.1.1.2" lspace="0em" xref="S3.E14.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1"><eq id="S3.E14.m1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1"></eq><apply id="S3.E14.m1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2">ℒ</ci><ci id="S3.E14.m1.1.1.1.1.2.3a.cmml" xref="S3.E14.m1.1.1.1.1.2.3"><mtext id="S3.E14.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E14.m1.1.1.1.1.2.3">total</mtext></ci></apply><apply id="S3.E14.m1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.3"><plus id="S3.E14.m1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.1.1.3.1"></plus><apply id="S3.E14.m1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.3.2"><times id="S3.E14.m1.1.1.1.1.3.2.1.cmml" xref="S3.E14.m1.1.1.1.1.3.2.1"></times><apply id="S3.E14.m1.1.1.1.1.3.2.2.cmml" xref="S3.E14.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E14.m1.1.1.1.1.3.2.2.2">𝜆</ci><ci id="S3.E14.m1.1.1.1.1.3.2.2.3a.cmml" xref="S3.E14.m1.1.1.1.1.3.2.2.3"><mtext id="S3.E14.m1.1.1.1.1.3.2.2.3.cmml" mathsize="70%" xref="S3.E14.m1.1.1.1.1.3.2.2.3">focal</mtext></ci></apply><apply id="S3.E14.m1.1.1.1.1.3.2.3.cmml" xref="S3.E14.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E14.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E14.m1.1.1.1.1.3.2.3.2">ℒ</ci><ci id="S3.E14.m1.1.1.1.1.3.2.3.3a.cmml" xref="S3.E14.m1.1.1.1.1.3.2.3.3"><mtext id="S3.E14.m1.1.1.1.1.3.2.3.3.cmml" mathsize="70%" xref="S3.E14.m1.1.1.1.1.3.2.3.3">focal</mtext></ci></apply></apply><apply id="S3.E14.m1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3.3.1.cmml" xref="S3.E14.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.3.3.2.cmml" xref="S3.E14.m1.1.1.1.1.3.3.2">ℒ</ci><ci id="S3.E14.m1.1.1.1.1.3.3.3a.cmml" xref="S3.E14.m1.1.1.1.1.3.3.3"><mtext id="S3.E14.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E14.m1.1.1.1.1.3.3.3">dice</mtext></ci></apply><apply id="S3.E14.m1.1.1.1.1.3.4.cmml" xref="S3.E14.m1.1.1.1.1.3.4"><times id="S3.E14.m1.1.1.1.1.3.4.1.cmml" xref="S3.E14.m1.1.1.1.1.3.4.1"></times><apply id="S3.E14.m1.1.1.1.1.3.4.2.cmml" xref="S3.E14.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3.4.2.1.cmml" xref="S3.E14.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.3.4.2.2.cmml" xref="S3.E14.m1.1.1.1.1.3.4.2.2">𝜆</ci><ci id="S3.E14.m1.1.1.1.1.3.4.2.3a.cmml" xref="S3.E14.m1.1.1.1.1.3.4.2.3"><mtext id="S3.E14.m1.1.1.1.1.3.4.2.3.cmml" mathsize="70%" xref="S3.E14.m1.1.1.1.1.3.4.2.3">match</mtext></ci></apply><apply id="S3.E14.m1.1.1.1.1.3.4.3.cmml" xref="S3.E14.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E14.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E14.m1.1.1.1.1.3.4.3.2">ℒ</ci><ci id="S3.E14.m1.1.1.1.1.3.4.3.3a.cmml" xref="S3.E14.m1.1.1.1.1.3.4.3.3"><mtext id="S3.E14.m1.1.1.1.1.3.4.3.3.cmml" mathsize="70%" xref="S3.E14.m1.1.1.1.1.3.4.3.3">match</mtext></ci></apply></apply><apply id="S3.E14.m1.1.1.1.1.3.5.cmml" xref="S3.E14.m1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3.5.1.cmml" xref="S3.E14.m1.1.1.1.1.3.5">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.3.5.2.cmml" xref="S3.E14.m1.1.1.1.1.3.5.2">ℒ</ci><ci id="S3.E14.m1.1.1.1.1.3.5.3a.cmml" xref="S3.E14.m1.1.1.1.1.3.5.3"><mtext id="S3.E14.m1.1.1.1.1.3.5.3.cmml" mathsize="70%" xref="S3.E14.m1.1.1.1.1.3.5.3">IoU</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">\mathcal{L}_{\text{total}}=\lambda_{\text{focal}}\mathcal{L}_{\text{focal}}+%
\mathcal{L}_{\text{dice}}+\lambda_{\text{match}}\mathcal{L}_{\text{match}}+%
\mathcal{L}_{\text{IoU}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.1d">caligraphic_L start_POSTSUBSCRIPT total end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT focal end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT focal end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT dice end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT match end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT match end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT IoU end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Experiments</span>
</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS1.5.1.1">IV-A</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS1.6.2">Datasets</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">To comprehensively evaluate the effectiveness of our proposed method, we conducted experiments on three widely used remote sensing instance segmentation datasets: HRSID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib66" title=""><span class="ltx_text" style="font-size:90%;">66</span></a>]</cite>, NWPU VHR-10 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib67" title=""><span class="ltx_text" style="font-size:90%;">67</span></a>]</cite>, and WHU <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib68" title=""><span class="ltx_text" style="font-size:90%;">68</span></a>]</cite>. The details are as follows:</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">NWPU VHR-10</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib67" title=""><span class="ltx_text" style="font-size:90%;">67</span></a>]</cite> is a ten-class geospatial object detection dataset. It comprises 800 VHR optical remote sensing images: 715 color images sourced from Google Earth with spatial resolutions ranging from 0.5 to 2 meters, and 85 pan-sharpened color infrared images from Vaihingen data with a spatial resolution of 0.08 meters. The dataset is divided into two subsets: (a) the positive image set, containing 650 images with at least one target per image, and (b) the negative image set, consisting of 150 images with no targets. For our experiments, we selected 520 images from the positive set for training and 130 images for testing. It is worth noting that since SAM is class-agnostic, we treat all 10 categories as a single class.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">HRSID</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib66" title=""><span class="ltx_text" style="font-size:90%;">66</span></a>]</cite> is used for ship detection, semantic segmentation, and instance segmentation in high-resolution SAR images. It contains 5,604 high-resolution SAR ship images and 16,951 ship instances. Its spatial resolution is 0.5–3 m. It primarily consists of two scenarios: inshore and offshore. Since segmentation in the offshore scenario is relatively straightforward, we focus our experiments on the inshore dataset. Both the training and test sets exclusively use data from the inshore scenario, comprising 459 images for training and 250 images for testing. In the following text, we will refer to this as <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.2">HRSID-inshore</span>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">WHU</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib68" title=""><span class="ltx_text" style="font-size:90%;">68</span></a>]</cite> consists of over 220,000 independent buildings extracted from aerial images with a spatial resolution of 0.075 meters and a coverage area of 450 square kilometers in Christchurch, New Zealand. We use the training set for training and the validation set for testing, with 4,736 and 1,036 images, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS2.5.1.1">IV-B</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS2.6.2">Experiment Details</span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">Encoder Setting:</span> If not otherwise specified, the image encoders used in experiments with SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a>]</cite> and SAM2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite> are ViT-b and Hiera-B+, respectively.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.2.1">Prompt Generation:</span> For each instance mask, we randomly select <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_N</annotation></semantics></math> positive prompts from the corresponding GT mask and <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_N</annotation></semantics></math> negative prompts from outside the GT mask. We use the same method to generate prompts for both training and testing data. This practice guarantees fair evaluation of SAM which requires prompt input for segmentation.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">Competing Methods:</span>
We evaluate multiple source-free domain adaptation approaches and the latest weakly supervised interactive segmentation methods. Specifically, directly testing the pre-trained model (<span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.2">Direct</span>) with fixed prompt inputs is susceptible to distribution shifts and may not perform well on target datasets with significant shifts. <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.3">TENT</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib69" title=""><span class="ltx_text" style="font-size:90%;">69</span></a>]</cite> is a basic test-time adaptation method that adapts to the target domain by optimizing an entropy loss. <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.4">SHOT</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib22" title=""><span class="ltx_text" style="font-size:90%;">22</span></a>]</cite> employs pseudo labels and applies a uniform distribution assumption for source-free domain adaptation. <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.5">Self-Training</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">19</span></a>]</cite> was initially developed for semi-supervised learning. We simply adopt a vanilla teacher-student structure without any tricks. <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.6">Tribe</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite> proposed a strong baseline for test-time adaptation under continual and class-imbalanced domain shifts. We adapt it for domain adaptive segmentation by replacing the training losses. <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.7">DePT</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib70" title=""><span class="ltx_text" style="font-size:90%;">70</span></a>]</cite> inserts visual prompts into a visual Transformer and adjusts these source-initialized prompts solely during the adaptation process without accessing the source data. <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.8">WeSAM</span> incorporates anchor loss and prompt-based contrastive loss into self-training. Finally, we evaluate our own pointly-supervised interactive segmentation method, referred to as <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.9">Ours</span>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Comparison result of different methods on NWPU VHR-10 test set. Colored results represent the <span class="ltx_text" id="S4.T1.3.1" style="color:#FF0000;">best</span> and <span class="ltx_text" id="S4.T1.4.2" style="color:#0000FF;">second-best</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.5">
<tr class="ltx_tr" id="S4.T1.5.1">
<td class="ltx_td ltx_border_tt" id="S4.T1.5.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt" colspan="6" id="S4.T1.5.1.2" style="background-color:#FFE6CC;"><span class="ltx_text" id="S4.T1.5.1.2.1" style="font-size:90%;background-color:#FFE6CC;">SAM-based</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S4.T1.5.1.3" style="background-color:#ADD9E6;"><span class="ltx_text" id="S4.T1.5.1.3.1" style="font-size:90%;background-color:#ADD9E6;">SAM2-based</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.2">
<td class="ltx_td ltx_align_left" id="S4.T1.5.2.1"><span class="ltx_text" id="S4.T1.5.2.1.1" style="font-size:90%;">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.5.2.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T1.5.2.2.1" style="font-size:90%;background-color:#E6E6E6;">1-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.5.2.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T1.5.2.3.1" style="font-size:90%;background-color:#E6E6E6;">2-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" colspan="2" id="S4.T1.5.2.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T1.5.2.4.1" style="font-size:90%;background-color:#E6E6E6;">3-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.5.2.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T1.5.2.5.1" style="font-size:90%;background-color:#E6E6E6;">1-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.5.2.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T1.5.2.6.1" style="font-size:90%;background-color:#E6E6E6;">2-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.5.2.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T1.5.2.7.1" style="font-size:90%;background-color:#E6E6E6;">3-Point</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.3">
<td class="ltx_td" id="S4.T1.5.3.1"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.3.2"><span class="ltx_text" id="S4.T1.5.3.2.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.3.3"><span class="ltx_text" id="S4.T1.5.3.3.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.3.4"><span class="ltx_text" id="S4.T1.5.3.4.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.3.5"><span class="ltx_text" id="S4.T1.5.3.5.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.3.6"><span class="ltx_text" id="S4.T1.5.3.6.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S4.T1.5.3.7"><span class="ltx_text" id="S4.T1.5.3.7.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.3.8"><span class="ltx_text" id="S4.T1.5.3.8.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.3.9"><span class="ltx_text" id="S4.T1.5.3.9.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.3.10"><span class="ltx_text" id="S4.T1.5.3.10.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.3.11"><span class="ltx_text" id="S4.T1.5.3.11.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.3.12"><span class="ltx_text" id="S4.T1.5.3.12.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.3.13"><span class="ltx_text" id="S4.T1.5.3.13.1" style="font-size:90%;">F1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.5.4.1">
<span class="ltx_text" id="S4.T1.5.4.1.1" style="font-size:90%;">Direct test</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.5.4.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a><span class="ltx_text" id="S4.T1.5.4.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.4.2"><span class="ltx_text" id="S4.T1.5.4.2.1" style="font-size:90%;">58.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.4.3"><span class="ltx_text" id="S4.T1.5.4.3.1" style="font-size:90%;">68.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.4.4"><span class="ltx_text" id="S4.T1.5.4.4.1" style="font-size:90%;">63.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.4.5"><span class="ltx_text" id="S4.T1.5.4.5.1" style="font-size:90%;">74.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.4.6"><span class="ltx_text" id="S4.T1.5.4.6.1" style="font-size:90%;">60.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S4.T1.5.4.7"><span class="ltx_text" id="S4.T1.5.4.7.1" style="font-size:90%;">71.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.4.8"><span class="ltx_text" id="S4.T1.5.4.8.1" style="font-size:90%;">58.28</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.4.9"><span class="ltx_text" id="S4.T1.5.4.9.1" style="font-size:90%;">69.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.4.10"><span class="ltx_text" id="S4.T1.5.4.10.1" style="font-size:90%;">62.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.4.11"><span class="ltx_text" id="S4.T1.5.4.11.1" style="font-size:90%;">73.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.4.12"><span class="ltx_text" id="S4.T1.5.4.12.1" style="font-size:90%;">61.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.4.13"><span class="ltx_text" id="S4.T1.5.4.13.1" style="font-size:90%;">73.39</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5">
<td class="ltx_td ltx_align_left" id="S4.T1.5.5.1">
<span class="ltx_text" id="S4.T1.5.5.1.1" style="font-size:90%;">Tent</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.5.5.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib69" title=""><span class="ltx_text" style="font-size:90%;">69</span></a><span class="ltx_text" id="S4.T1.5.5.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.2"><span class="ltx_text" id="S4.T1.5.5.2.1" style="font-size:90%;">59.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.5.3"><span class="ltx_text" id="S4.T1.5.5.3.1" style="font-size:90%;">70.02</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.4"><span class="ltx_text" id="S4.T1.5.5.4.1" style="font-size:90%;">64.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.5.5"><span class="ltx_text" id="S4.T1.5.5.5.1" style="font-size:90%;">75.40</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.6"><span class="ltx_text" id="S4.T1.5.5.6.1" style="font-size:90%;">61.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T1.5.5.7"><span class="ltx_text" id="S4.T1.5.5.7.1" style="font-size:90%;">72.00</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.8"><span class="ltx_text" id="S4.T1.5.5.8.1" style="font-size:90%;">59.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.5.9"><span class="ltx_text" id="S4.T1.5.5.9.1" style="font-size:90%;">70.53</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.10"><span class="ltx_text" id="S4.T1.5.5.10.1" style="font-size:90%;">63.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.5.11"><span class="ltx_text" id="S4.T1.5.5.11.1" style="font-size:90%;">75.14</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.12"><span class="ltx_text" id="S4.T1.5.5.12.1" style="font-size:90%;">62.86</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.13"><span class="ltx_text" id="S4.T1.5.5.13.1" style="font-size:90%;">74.36</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.6">
<td class="ltx_td ltx_align_left" id="S4.T1.5.6.1">
<span class="ltx_text" id="S4.T1.5.6.1.1" style="font-size:90%;">Shot</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.5.6.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib22" title=""><span class="ltx_text" style="font-size:90%;">22</span></a><span class="ltx_text" id="S4.T1.5.6.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.6.2"><span class="ltx_text" id="S4.T1.5.6.2.1" style="font-size:90%;">61.48</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.6.3"><span class="ltx_text" id="S4.T1.5.6.3.1" style="font-size:90%;">72.11</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.6.4"><span class="ltx_text" id="S4.T1.5.6.4.1" style="font-size:90%;">65.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.6.5"><span class="ltx_text" id="S4.T1.5.6.5.1" style="font-size:90%;color:#0000FF;">76.54</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.6.6"><span class="ltx_text" id="S4.T1.5.6.6.1" style="font-size:90%;">62.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T1.5.6.7"><span class="ltx_text" id="S4.T1.5.6.7.1" style="font-size:90%;">73.51</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.6.8"><span class="ltx_text" id="S4.T1.5.6.8.1" style="font-size:90%;">60.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.6.9"><span class="ltx_text" id="S4.T1.5.6.9.1" style="font-size:90%;">71.37</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.6.10"><span class="ltx_text" id="S4.T1.5.6.10.1" style="font-size:90%;">62.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.6.11"><span class="ltx_text" id="S4.T1.5.6.11.1" style="font-size:90%;">74.40</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.6.12"><span class="ltx_text" id="S4.T1.5.6.12.1" style="font-size:90%;">61.98</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.6.13"><span class="ltx_text" id="S4.T1.5.6.13.1" style="font-size:90%;">73.68</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.7">
<td class="ltx_td ltx_align_left" id="S4.T1.5.7.1">
<span class="ltx_text" id="S4.T1.5.7.1.1" style="font-size:90%;">Self-Training</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.5.7.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">48</span></a><span class="ltx_text" id="S4.T1.5.7.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.7.2"><span class="ltx_text" id="S4.T1.5.7.2.1" style="font-size:90%;">63.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.7.3"><span class="ltx_text" id="S4.T1.5.7.3.1" style="font-size:90%;">74.11</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.7.4"><span class="ltx_text" id="S4.T1.5.7.4.1" style="font-size:90%;">65.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.7.5"><span class="ltx_text" id="S4.T1.5.7.5.1" style="font-size:90%;">76.05</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.7.6"><span class="ltx_text" id="S4.T1.5.7.6.1" style="font-size:90%;">60.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T1.5.7.7"><span class="ltx_text" id="S4.T1.5.7.7.1" style="font-size:90%;">71.94</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.7.8"><span class="ltx_text" id="S4.T1.5.7.8.1" style="font-size:90%;">59.62</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.7.9"><span class="ltx_text" id="S4.T1.5.7.9.1" style="font-size:90%;">70.38</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.7.10"><span class="ltx_text" id="S4.T1.5.7.10.1" style="font-size:90%;">63.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.7.11"><span class="ltx_text" id="S4.T1.5.7.11.1" style="font-size:90%;">74.36</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.7.12"><span class="ltx_text" id="S4.T1.5.7.12.1" style="font-size:90%;">61.86</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.7.13"><span class="ltx_text" id="S4.T1.5.7.13.1" style="font-size:90%;">73.27</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.8">
<td class="ltx_td ltx_align_left" id="S4.T1.5.8.1">
<span class="ltx_text" id="S4.T1.5.8.1.1" style="font-size:90%;">DePT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.5.8.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib70" title=""><span class="ltx_text" style="font-size:90%;">70</span></a><span class="ltx_text" id="S4.T1.5.8.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.8.2"><span class="ltx_text" id="S4.T1.5.8.2.1" style="font-size:90%;color:#0000FF;">64.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.8.3"><span class="ltx_text" id="S4.T1.5.8.3.1" style="font-size:90%;">74.47</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.8.4"><span class="ltx_text" id="S4.T1.5.8.4.1" style="font-size:90%;color:#0000FF;">67.13</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.8.5"><span class="ltx_text" id="S4.T1.5.8.5.1" style="font-size:90%;">74.35</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.8.6"><span class="ltx_text" id="S4.T1.5.8.6.1" style="font-size:90%;">64.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T1.5.8.7"><span class="ltx_text" id="S4.T1.5.8.7.1" style="font-size:90%;">75.82</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.8.8"><span class="ltx_text" id="S4.T1.5.8.8.1" style="font-size:90%;color:#0000FF;">58.85</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.8.9"><span class="ltx_text" id="S4.T1.5.8.9.1" style="font-size:90%;color:#0000FF;">69.22</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.8.10"><span class="ltx_text" id="S4.T1.5.8.10.1" style="font-size:90%;">63.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.8.11"><span class="ltx_text" id="S4.T1.5.8.11.1" style="font-size:90%;">75.28</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.8.12"><span class="ltx_text" id="S4.T1.5.8.12.1" style="font-size:90%;">63.62</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.8.13"><span class="ltx_text" id="S4.T1.5.8.13.1" style="font-size:90%;">74.58</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.9">
<td class="ltx_td ltx_align_left" id="S4.T1.5.9.1">
<span class="ltx_text" id="S4.T1.5.9.1.1" style="font-size:90%;">Tribe</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.5.9.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a><span class="ltx_text" id="S4.T1.5.9.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.9.2"><span class="ltx_text" id="S4.T1.5.9.2.1" style="font-size:90%;">64.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.9.3"><span class="ltx_text" id="S4.T1.5.9.3.1" style="font-size:90%;">73.79</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.9.4"><span class="ltx_text" id="S4.T1.5.9.4.1" style="font-size:90%;">64.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.9.5"><span class="ltx_text" id="S4.T1.5.9.5.1" style="font-size:90%;">75.60</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.9.6"><span class="ltx_text" id="S4.T1.5.9.6.1" style="font-size:90%;">60.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T1.5.9.7"><span class="ltx_text" id="S4.T1.5.9.7.1" style="font-size:90%;">71.39</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.9.8"><span class="ltx_text" id="S4.T1.5.9.8.1" style="font-size:90%;">61.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.9.9"><span class="ltx_text" id="S4.T1.5.9.9.1" style="font-size:90%;">71.86</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.9.10"><span class="ltx_text" id="S4.T1.5.9.10.1" style="font-size:90%;">65.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.9.11"><span class="ltx_text" id="S4.T1.5.9.11.1" style="font-size:90%;">76.05</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.9.12"><span class="ltx_text" id="S4.T1.5.9.12.1" style="font-size:90%;">67.02</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.9.13"><span class="ltx_text" id="S4.T1.5.9.13.1" style="font-size:90%;">77.76</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.10">
<td class="ltx_td ltx_align_left" id="S4.T1.5.10.1">
<span class="ltx_text" id="S4.T1.5.10.1.1" style="font-size:90%;">WeSAM</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.5.10.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a><span class="ltx_text" id="S4.T1.5.10.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.10.2"><span class="ltx_text" id="S4.T1.5.10.2.1" style="font-size:90%;">64.85</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.10.3"><span class="ltx_text" id="S4.T1.5.10.3.1" style="font-size:90%;color:#0000FF;">75.28</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.10.4"><span class="ltx_text" id="S4.T1.5.10.4.1" style="font-size:90%;">64.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.10.5"><span class="ltx_text" id="S4.T1.5.10.5.1" style="font-size:90%;">76.00</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.10.6"><span class="ltx_text" id="S4.T1.5.10.6.1" style="font-size:90%;color:#0000FF;">66.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T1.5.10.7"><span class="ltx_text" id="S4.T1.5.10.7.1" style="font-size:90%;color:#0000FF;">76.73</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.10.8"><span class="ltx_text" id="S4.T1.5.10.8.1" style="font-size:90%;">58.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.10.9"><span class="ltx_text" id="S4.T1.5.10.9.1" style="font-size:90%;">70.32</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.10.10"><span class="ltx_text" id="S4.T1.5.10.10.1" style="font-size:90%;color:#0000FF;">69.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.10.11"><span class="ltx_text" id="S4.T1.5.10.11.1" style="font-size:90%;color:#0000FF;">79.83</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.10.12"><span class="ltx_text" id="S4.T1.5.10.12.1" style="font-size:90%;color:#0000FF;">67.24</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.10.13"><span class="ltx_text" id="S4.T1.5.10.13.1" style="font-size:90%;color:#0000FF;">78.35</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.11">
<td class="ltx_td ltx_align_left" id="S4.T1.5.11.1"><span class="ltx_text" id="S4.T1.5.11.1.1" style="font-size:90%;">PointSAM(Ours)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.11.2"><span class="ltx_text" id="S4.T1.5.11.2.1" style="font-size:90%;color:#FF0000;">66.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.11.3"><span class="ltx_text" id="S4.T1.5.11.3.1" style="font-size:90%;color:#FF0000;">76.03</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.11.4"><span class="ltx_text" id="S4.T1.5.11.4.1" style="font-size:90%;color:#FF0000;">67.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.11.5"><span class="ltx_text" id="S4.T1.5.11.5.1" style="font-size:90%;color:#FF0000;">77.42</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.11.6"><span class="ltx_text" id="S4.T1.5.11.6.1" style="font-size:90%;color:#FF0000;">67.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T1.5.11.7"><span class="ltx_text" id="S4.T1.5.11.7.1" style="font-size:90%;color:#FF0000;">78.57</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.11.8"><span class="ltx_text" id="S4.T1.5.11.8.1" style="font-size:90%;color:#FF0000;">62.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.11.9"><span class="ltx_text" id="S4.T1.5.11.9.1" style="font-size:90%;color:#FF0000;">73.66</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.11.10"><span class="ltx_text" id="S4.T1.5.11.10.1" style="font-size:90%;color:#FF0000;">70.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.11.11"><span class="ltx_text" id="S4.T1.5.11.11.1" style="font-size:90%;color:#FF0000;">80.22</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.11.12"><span class="ltx_text" id="S4.T1.5.11.12.1" style="font-size:90%;color:#FF0000;">69.05</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.11.13"><span class="ltx_text" id="S4.T1.5.11.13.1" style="font-size:90%;color:#FF0000;">80.27</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.12">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T1.5.12.1"><span class="ltx_text" id="S4.T1.5.12.1.1" style="font-size:90%;color:#808080;">Supervised</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.5.12.2"><span class="ltx_text" id="S4.T1.5.12.2.1" style="font-size:90%;color:#808080;">78.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.5.12.3"><span class="ltx_text" id="S4.T1.5.12.3.1" style="font-size:90%;color:#808080;">86.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.5.12.4"><span class="ltx_text" id="S4.T1.5.12.4.1" style="font-size:90%;color:#808080;">80.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.5.12.5"><span class="ltx_text" id="S4.T1.5.12.5.1" style="font-size:90%;color:#808080;">88.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.5.12.6"><span class="ltx_text" id="S4.T1.5.12.6.1" style="font-size:90%;color:#808080;">81.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_rr ltx_border_t" id="S4.T1.5.12.7"><span class="ltx_text" id="S4.T1.5.12.7.1" style="font-size:90%;color:#808080;">88.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.5.12.8"><span class="ltx_text" id="S4.T1.5.12.8.1" style="font-size:90%;color:#808080;">81.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.5.12.9"><span class="ltx_text" id="S4.T1.5.12.9.1" style="font-size:90%;color:#808080;">88.48</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.5.12.10"><span class="ltx_text" id="S4.T1.5.12.10.1" style="font-size:90%;color:#808080;">83.14</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.5.12.11"><span class="ltx_text" id="S4.T1.5.12.11.1" style="font-size:90%;color:#808080;">90.11</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.5.12.12"><span class="ltx_text" id="S4.T1.5.12.12.1" style="font-size:90%;color:#808080;">83.41</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.5.12.13"><span class="ltx_text" id="S4.T1.5.12.13.1" style="font-size:90%;color:#808080;">90.32</span></td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p4.1.1">Evaluation Metrics:</span> We report the mIoU as evaluation metrics. For each input prompt, the IoU is calculated between the ground-truth segmentation mask and the predicted mask. The mIoU averages over the IoU of all instances.</p>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.p5.2.1">Implementation Details</span>
We finetune the LoRA module of the image encoder by Adam optimizer for all experiments. We set the batch size to 1 using an RTX3090 GPU and the learning rate to 0.0005 with a weight decay of 0.0001. We set the low rank of the LoRA module for the image encoder to 4. And, the coefficients <math alttext="\lambda_{\text{focal}}" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><msub id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml"><mi id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">λ</mi><mtext id="S4.SS2.p5.1.m1.1.1.3" xref="S4.SS2.p5.1.m1.1.1.3a.cmml">focal</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">𝜆</ci><ci id="S4.SS2.p5.1.m1.1.1.3a.cmml" xref="S4.SS2.p5.1.m1.1.1.3"><mtext id="S4.SS2.p5.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p5.1.m1.1.1.3">focal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">\lambda_{\text{focal}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">italic_λ start_POSTSUBSCRIPT focal end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{\text{match}}" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><msub id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mi id="S4.SS2.p5.2.m2.1.1.2" xref="S4.SS2.p5.2.m2.1.1.2.cmml">λ</mi><mtext id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3a.cmml">match</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2">𝜆</ci><ci id="S4.SS2.p5.2.m2.1.1.3a.cmml" xref="S4.SS2.p5.2.m2.1.1.3"><mtext id="S4.SS2.p5.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p5.2.m2.1.1.3">match</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\lambda_{\text{match}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">italic_λ start_POSTSUBSCRIPT match end_POSTSUBSCRIPT</annotation></semantics></math> in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.E14" title="In III-E Total Loss ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">14</span></a> are set to 20 and 0.1, respectively. We apply strong and weak data augmentations for self-training and choices for augmentation follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite>.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Comparison result of different methods on WHU Building test set. Colored results represent the <span class="ltx_text" id="S4.T2.3.1" style="color:#FF0000;">best</span> and <span class="ltx_text" id="S4.T2.4.2" style="color:#0000FF;">second-best</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T2.5">
<tr class="ltx_tr" id="S4.T2.5.1">
<td class="ltx_td ltx_border_tt" id="S4.T2.5.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt" colspan="6" id="S4.T2.5.1.2" style="background-color:#FFE6CC;"><span class="ltx_text" id="S4.T2.5.1.2.1" style="font-size:90%;background-color:#FFE6CC;">SAM-based</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S4.T2.5.1.3" style="background-color:#ADD9E6;"><span class="ltx_text" id="S4.T2.5.1.3.1" style="font-size:90%;background-color:#ADD9E6;">SAM2-based</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.2">
<td class="ltx_td ltx_align_left" id="S4.T2.5.2.1"><span class="ltx_text" id="S4.T2.5.2.1.1" style="font-size:90%;">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.5.2.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.2.2.1" style="font-size:90%;background-color:#E6E6E6;">1-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.5.2.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.2.3.1" style="font-size:90%;background-color:#E6E6E6;">2-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" colspan="2" id="S4.T2.5.2.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.2.4.1" style="font-size:90%;background-color:#E6E6E6;">3-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.5.2.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.2.5.1" style="font-size:90%;background-color:#E6E6E6;">1-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.5.2.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.2.6.1" style="font-size:90%;background-color:#E6E6E6;">2-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.5.2.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.2.7.1" style="font-size:90%;background-color:#E6E6E6;">3-Point</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.3">
<td class="ltx_td" id="S4.T2.5.3.1"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.2"><span class="ltx_text" id="S4.T2.5.3.2.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.3.3"><span class="ltx_text" id="S4.T2.5.3.3.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.4"><span class="ltx_text" id="S4.T2.5.3.4.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.3.5"><span class="ltx_text" id="S4.T2.5.3.5.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.6"><span class="ltx_text" id="S4.T2.5.3.6.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S4.T2.5.3.7"><span class="ltx_text" id="S4.T2.5.3.7.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.8"><span class="ltx_text" id="S4.T2.5.3.8.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.3.9"><span class="ltx_text" id="S4.T2.5.3.9.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.10"><span class="ltx_text" id="S4.T2.5.3.10.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.3.11"><span class="ltx_text" id="S4.T2.5.3.11.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.12"><span class="ltx_text" id="S4.T2.5.3.12.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.3.13"><span class="ltx_text" id="S4.T2.5.3.13.1" style="font-size:90%;">F1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.5.4.1">
<span class="ltx_text" id="S4.T2.5.4.1.1" style="font-size:90%;">Direct test</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.5.4.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a><span class="ltx_text" id="S4.T2.5.4.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.4.2"><span class="ltx_text" id="S4.T2.5.4.2.1" style="font-size:90%;">61.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.4.3"><span class="ltx_text" id="S4.T2.5.4.3.1" style="font-size:90%;">70.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.4.4"><span class="ltx_text" id="S4.T2.5.4.4.1" style="font-size:90%;">65.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.4.5"><span class="ltx_text" id="S4.T2.5.4.5.1" style="font-size:90%;">74.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.4.6"><span class="ltx_text" id="S4.T2.5.4.6.1" style="font-size:90%;">59.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S4.T2.5.4.7"><span class="ltx_text" id="S4.T2.5.4.7.1" style="font-size:90%;">69.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.4.8"><span class="ltx_text" id="S4.T2.5.4.8.1" style="font-size:90%;">59.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.4.9"><span class="ltx_text" id="S4.T2.5.4.9.1" style="font-size:90%;">70.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.4.10"><span class="ltx_text" id="S4.T2.5.4.10.1" style="font-size:90%;">65.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.4.11"><span class="ltx_text" id="S4.T2.5.4.11.1" style="font-size:90%;">76.31</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.4.12"><span class="ltx_text" id="S4.T2.5.4.12.1" style="font-size:90%;">62.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.4.13"><span class="ltx_text" id="S4.T2.5.4.13.1" style="font-size:90%;">73.01</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.5">
<td class="ltx_td ltx_align_left" id="S4.T2.5.5.1">
<span class="ltx_text" id="S4.T2.5.5.1.1" style="font-size:90%;">Tent</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.5.5.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib69" title=""><span class="ltx_text" style="font-size:90%;">69</span></a><span class="ltx_text" id="S4.T2.5.5.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.2"><span class="ltx_text" id="S4.T2.5.5.2.1" style="font-size:90%;">61.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.5.3"><span class="ltx_text" id="S4.T2.5.5.3.1" style="font-size:90%;">70.87</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.4"><span class="ltx_text" id="S4.T2.5.5.4.1" style="font-size:90%;">65.49</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.5.5"><span class="ltx_text" id="S4.T2.5.5.5.1" style="font-size:90%;">75.17</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.6"><span class="ltx_text" id="S4.T2.5.5.6.1" style="font-size:90%;">59.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T2.5.5.7"><span class="ltx_text" id="S4.T2.5.5.7.1" style="font-size:90%;">69.50</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.8"><span class="ltx_text" id="S4.T2.5.5.8.1" style="font-size:90%;">60.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.5.9"><span class="ltx_text" id="S4.T2.5.5.9.1" style="font-size:90%;">71.25</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.10"><span class="ltx_text" id="S4.T2.5.5.10.1" style="font-size:90%;">65.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.5.11"><span class="ltx_text" id="S4.T2.5.5.11.1" style="font-size:90%;">76.22</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.12"><span class="ltx_text" id="S4.T2.5.5.12.1" style="font-size:90%;">62.74</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.5.13"><span class="ltx_text" id="S4.T2.5.5.13.1" style="font-size:90%;">73.27</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.6">
<td class="ltx_td ltx_align_left" id="S4.T2.5.6.1">
<span class="ltx_text" id="S4.T2.5.6.1.1" style="font-size:90%;">Shot</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.5.6.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib22" title=""><span class="ltx_text" style="font-size:90%;">22</span></a><span class="ltx_text" id="S4.T2.5.6.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.2"><span class="ltx_text" id="S4.T2.5.6.2.1" style="font-size:90%;">61.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.6.3"><span class="ltx_text" id="S4.T2.5.6.3.1" style="font-size:90%;">70.76</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.4"><span class="ltx_text" id="S4.T2.5.6.4.1" style="font-size:90%;">65.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.6.5"><span class="ltx_text" id="S4.T2.5.6.5.1" style="font-size:90%;">75.46</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.6"><span class="ltx_text" id="S4.T2.5.6.6.1" style="font-size:90%;">60.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T2.5.6.7"><span class="ltx_text" id="S4.T2.5.6.7.1" style="font-size:90%;">70.62</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.8"><span class="ltx_text" id="S4.T2.5.6.8.1" style="font-size:90%;">61.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.6.9"><span class="ltx_text" id="S4.T2.5.6.9.1" style="font-size:90%;">70.49</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.10"><span class="ltx_text" id="S4.T2.5.6.10.1" style="font-size:90%;">67.96</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.6.11"><span class="ltx_text" id="S4.T2.5.6.11.1" style="font-size:90%;">77.04</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.12"><span class="ltx_text" id="S4.T2.5.6.12.1" style="font-size:90%;">62.50</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.6.13"><span class="ltx_text" id="S4.T2.5.6.13.1" style="font-size:90%;">73.22</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.7">
<td class="ltx_td ltx_align_left" id="S4.T2.5.7.1">
<span class="ltx_text" id="S4.T2.5.7.1.1" style="font-size:90%;">Self-Training</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.5.7.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">48</span></a><span class="ltx_text" id="S4.T2.5.7.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.2"><span class="ltx_text" id="S4.T2.5.7.2.1" style="font-size:90%;">64.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.7.3"><span class="ltx_text" id="S4.T2.5.7.3.1" style="font-size:90%;">73.99</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.4"><span class="ltx_text" id="S4.T2.5.7.4.1" style="font-size:90%;">68.49</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.7.5"><span class="ltx_text" id="S4.T2.5.7.5.1" style="font-size:90%;">77.57</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.6"><span class="ltx_text" id="S4.T2.5.7.6.1" style="font-size:90%;">59.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T2.5.7.7"><span class="ltx_text" id="S4.T2.5.7.7.1" style="font-size:90%;">69.35</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.8"><span class="ltx_text" id="S4.T2.5.7.8.1" style="font-size:90%;">65.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.7.9"><span class="ltx_text" id="S4.T2.5.7.9.1" style="font-size:90%;">75.38</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.10"><span class="ltx_text" id="S4.T2.5.7.10.1" style="font-size:90%;">68.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.7.11"><span class="ltx_text" id="S4.T2.5.7.11.1" style="font-size:90%;">78.60</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.12"><span class="ltx_text" id="S4.T2.5.7.12.1" style="font-size:90%;">68.74</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.7.13"><span class="ltx_text" id="S4.T2.5.7.13.1" style="font-size:90%;">77.43</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.8">
<td class="ltx_td ltx_align_left" id="S4.T2.5.8.1">
<span class="ltx_text" id="S4.T2.5.8.1.1" style="font-size:90%;">DePT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.5.8.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib70" title=""><span class="ltx_text" style="font-size:90%;">70</span></a><span class="ltx_text" id="S4.T2.5.8.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.2"><span class="ltx_text" id="S4.T2.5.8.2.1" style="font-size:90%;color:#0000FF;">71.31</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.8.3"><span class="ltx_text" id="S4.T2.5.8.3.1" style="font-size:90%;color:#0000FF;">79.41</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.4"><span class="ltx_text" id="S4.T2.5.8.4.1" style="font-size:90%;">73.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.8.5"><span class="ltx_text" id="S4.T2.5.8.5.1" style="font-size:90%;">81.21</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.6"><span class="ltx_text" id="S4.T2.5.8.6.1" style="font-size:90%;color:#0000FF;">73.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T2.5.8.7"><span class="ltx_text" id="S4.T2.5.8.7.1" style="font-size:90%;color:#0000FF;">81.47</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.8"><span class="ltx_text" id="S4.T2.5.8.8.1" style="font-size:90%;color:#0000FF;">69.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.8.9"><span class="ltx_text" id="S4.T2.5.8.9.1" style="font-size:90%;color:#0000FF;">77.86</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.10"><span class="ltx_text" id="S4.T2.5.8.10.1" style="font-size:90%;color:#0000FF;">74.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.8.11"><span class="ltx_text" id="S4.T2.5.8.11.1" style="font-size:90%;color:#0000FF;">82.27</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.12"><span class="ltx_text" id="S4.T2.5.8.12.1" style="font-size:90%;">73.91</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.8.13"><span class="ltx_text" id="S4.T2.5.8.13.1" style="font-size:90%;">81.88</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.9">
<td class="ltx_td ltx_align_left" id="S4.T2.5.9.1">
<span class="ltx_text" id="S4.T2.5.9.1.1" style="font-size:90%;">Tribe</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.5.9.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a><span class="ltx_text" id="S4.T2.5.9.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.2"><span class="ltx_text" id="S4.T2.5.9.2.1" style="font-size:90%;">65.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.9.3"><span class="ltx_text" id="S4.T2.5.9.3.1" style="font-size:90%;">74.61</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.4"><span class="ltx_text" id="S4.T2.5.9.4.1" style="font-size:90%;">71.17</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.9.5"><span class="ltx_text" id="S4.T2.5.9.5.1" style="font-size:90%;">79.56</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.6"><span class="ltx_text" id="S4.T2.5.9.6.1" style="font-size:90%;">69.14</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T2.5.9.7"><span class="ltx_text" id="S4.T2.5.9.7.1" style="font-size:90%;">77.81</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.8"><span class="ltx_text" id="S4.T2.5.9.8.1" style="font-size:90%;">66.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.9.9"><span class="ltx_text" id="S4.T2.5.9.9.1" style="font-size:90%;">76.16</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.10"><span class="ltx_text" id="S4.T2.5.9.10.1" style="font-size:90%;">72.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.9.11"><span class="ltx_text" id="S4.T2.5.9.11.1" style="font-size:90%;">80.81</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.12"><span class="ltx_text" id="S4.T2.5.9.12.1" style="font-size:90%;">72.58</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.9.13"><span class="ltx_text" id="S4.T2.5.9.13.1" style="font-size:90%;">81.53</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.10">
<td class="ltx_td ltx_align_left" id="S4.T2.5.10.1">
<span class="ltx_text" id="S4.T2.5.10.1.1" style="font-size:90%;">WeSAM</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.5.10.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a><span class="ltx_text" id="S4.T2.5.10.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.10.2"><span class="ltx_text" id="S4.T2.5.10.2.1" style="font-size:90%;">66.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.10.3"><span class="ltx_text" id="S4.T2.5.10.3.1" style="font-size:90%;">75.12</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.10.4"><span class="ltx_text" id="S4.T2.5.10.4.1" style="font-size:90%;color:#0000FF;">74.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.10.5"><span class="ltx_text" id="S4.T2.5.10.5.1" style="font-size:90%;color:#0000FF;">82.07</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.10.6"><span class="ltx_text" id="S4.T2.5.10.6.1" style="font-size:90%;">69.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T2.5.10.7"><span class="ltx_text" id="S4.T2.5.10.7.1" style="font-size:90%;">78.45</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.10.8"><span class="ltx_text" id="S4.T2.5.10.8.1" style="font-size:90%;">66.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.10.9"><span class="ltx_text" id="S4.T2.5.10.9.1" style="font-size:90%;">75.86</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.10.10"><span class="ltx_text" id="S4.T2.5.10.10.1" style="font-size:90%;">72.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.10.11"><span class="ltx_text" id="S4.T2.5.10.11.1" style="font-size:90%;">81.08</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.10.12"><span class="ltx_text" id="S4.T2.5.10.12.1" style="font-size:90%;color:#0000FF;">74.23</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.10.13"><span class="ltx_text" id="S4.T2.5.10.13.1" style="font-size:90%;color:#0000FF;">82.79</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.11">
<td class="ltx_td ltx_align_left" id="S4.T2.5.11.1"><span class="ltx_text" id="S4.T2.5.11.1.1" style="font-size:90%;">PointSAM(Ours)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.11.2"><span class="ltx_text" id="S4.T2.5.11.2.1" style="font-size:90%;color:#FF0000;">72.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.11.3"><span class="ltx_text" id="S4.T2.5.11.3.1" style="font-size:90%;color:#FF0000;">80.39</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.11.4"><span class="ltx_text" id="S4.T2.5.11.4.1" style="font-size:90%;color:#FF0000;">76.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.11.5"><span class="ltx_text" id="S4.T2.5.11.5.1" style="font-size:90%;color:#FF0000;">84.10</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.11.6"><span class="ltx_text" id="S4.T2.5.11.6.1" style="font-size:90%;color:#FF0000;">77.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T2.5.11.7"><span class="ltx_text" id="S4.T2.5.11.7.1" style="font-size:90%;color:#FF0000;">85.23</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.11.8"><span class="ltx_text" id="S4.T2.5.11.8.1" style="font-size:90%;color:#FF0000;">73.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.11.9"><span class="ltx_text" id="S4.T2.5.11.9.1" style="font-size:90%;color:#FF0000;">81.21</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.11.10"><span class="ltx_text" id="S4.T2.5.11.10.1" style="font-size:90%;color:#FF0000;">76.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.11.11"><span class="ltx_text" id="S4.T2.5.11.11.1" style="font-size:90%;color:#FF0000;">84.55</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.11.12"><span class="ltx_text" id="S4.T2.5.11.12.1" style="font-size:90%;color:#FF0000;">75.16</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.11.13"><span class="ltx_text" id="S4.T2.5.11.13.1" style="font-size:90%;color:#FF0000;">83.91</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.12">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T2.5.12.1"><span class="ltx_text" id="S4.T2.5.12.1.1" style="font-size:90%;color:#808080;">Supervised</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.12.2"><span class="ltx_text" id="S4.T2.5.12.2.1" style="font-size:90%;color:#808080;">77.15</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.5.12.3"><span class="ltx_text" id="S4.T2.5.12.3.1" style="font-size:90%;color:#808080;">84.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.12.4"><span class="ltx_text" id="S4.T2.5.12.4.1" style="font-size:90%;color:#808080;">79.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.5.12.5"><span class="ltx_text" id="S4.T2.5.12.5.1" style="font-size:90%;color:#808080;">86.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.12.6"><span class="ltx_text" id="S4.T2.5.12.6.1" style="font-size:90%;color:#808080;">80.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_rr ltx_border_t" id="S4.T2.5.12.7"><span class="ltx_text" id="S4.T2.5.12.7.1" style="font-size:90%;color:#808080;">87.49</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.12.8"><span class="ltx_text" id="S4.T2.5.12.8.1" style="font-size:90%;color:#808080;">78.75</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.5.12.9"><span class="ltx_text" id="S4.T2.5.12.9.1" style="font-size:90%;color:#808080;">85.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.12.10"><span class="ltx_text" id="S4.T2.5.12.10.1" style="font-size:90%;color:#808080;">80.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.5.12.11"><span class="ltx_text" id="S4.T2.5.12.11.1" style="font-size:90%;color:#808080;">87.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.12.12"><span class="ltx_text" id="S4.T2.5.12.12.1" style="font-size:90%;color:#808080;">88.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.12.13"><span class="ltx_text" id="S4.T2.5.12.13.1" style="font-size:90%;color:#808080;">88.70</span></td>
</tr>
</table>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Comparison result of different methods on HRSID-inshore test set. Colored results represent the <span class="ltx_text" id="S4.T3.3.1" style="color:#FF0000;">best</span> and <span class="ltx_text" id="S4.T3.4.2" style="color:#0000FF;">second-best</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T3.5">
<tr class="ltx_tr" id="S4.T3.5.1">
<td class="ltx_td ltx_border_tt" id="S4.T3.5.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt" colspan="6" id="S4.T3.5.1.2" style="background-color:#FFE6CC;"><span class="ltx_text" id="S4.T3.5.1.2.1" style="font-size:90%;background-color:#FFE6CC;">SAM-based</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S4.T3.5.1.3" style="background-color:#ADD9E6;"><span class="ltx_text" id="S4.T3.5.1.3.1" style="font-size:90%;background-color:#ADD9E6;">SAM2-based</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.2">
<td class="ltx_td ltx_align_left" id="S4.T3.5.2.1"><span class="ltx_text" id="S4.T3.5.2.1.1" style="font-size:90%;">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.5.2.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.5.2.2.1" style="font-size:90%;background-color:#E6E6E6;">1-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.5.2.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.5.2.3.1" style="font-size:90%;background-color:#E6E6E6;">2-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" colspan="2" id="S4.T3.5.2.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.5.2.4.1" style="font-size:90%;background-color:#E6E6E6;">3-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.5.2.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.5.2.5.1" style="font-size:90%;background-color:#E6E6E6;">1-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.5.2.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.5.2.6.1" style="font-size:90%;background-color:#E6E6E6;">2-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.5.2.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.5.2.7.1" style="font-size:90%;background-color:#E6E6E6;">3-Point</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.3">
<td class="ltx_td" id="S4.T3.5.3.1"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.3.2"><span class="ltx_text" id="S4.T3.5.3.2.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.3.3"><span class="ltx_text" id="S4.T3.5.3.3.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.3.4"><span class="ltx_text" id="S4.T3.5.3.4.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.3.5"><span class="ltx_text" id="S4.T3.5.3.5.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.3.6"><span class="ltx_text" id="S4.T3.5.3.6.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S4.T3.5.3.7"><span class="ltx_text" id="S4.T3.5.3.7.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.3.8"><span class="ltx_text" id="S4.T3.5.3.8.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.3.9"><span class="ltx_text" id="S4.T3.5.3.9.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.3.10"><span class="ltx_text" id="S4.T3.5.3.10.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.3.11"><span class="ltx_text" id="S4.T3.5.3.11.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.3.12"><span class="ltx_text" id="S4.T3.5.3.12.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.3.13"><span class="ltx_text" id="S4.T3.5.3.13.1" style="font-size:90%;">F1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.5.4.1">
<span class="ltx_text" id="S4.T3.5.4.1.1" style="font-size:90%;">Direct test</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T3.5.4.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a><span class="ltx_text" id="S4.T3.5.4.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.4.2"><span class="ltx_text" id="S4.T3.5.4.2.1" style="font-size:90%;">46.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.4.3"><span class="ltx_text" id="S4.T3.5.4.3.1" style="font-size:90%;">57.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.4.4"><span class="ltx_text" id="S4.T3.5.4.4.1" style="font-size:90%;">37.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.4.5"><span class="ltx_text" id="S4.T3.5.4.5.1" style="font-size:90%;">48.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.4.6"><span class="ltx_text" id="S4.T3.5.4.6.1" style="font-size:90%;">28.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" id="S4.T3.5.4.7"><span class="ltx_text" id="S4.T3.5.4.7.1" style="font-size:90%;">37.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.4.8"><span class="ltx_text" id="S4.T3.5.4.8.1" style="font-size:90%;">35.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.4.9"><span class="ltx_text" id="S4.T3.5.4.9.1" style="font-size:90%;">46.14</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.4.10"><span class="ltx_text" id="S4.T3.5.4.10.1" style="font-size:90%;">37.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.4.11"><span class="ltx_text" id="S4.T3.5.4.11.1" style="font-size:90%;">49.07</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.4.12"><span class="ltx_text" id="S4.T3.5.4.12.1" style="font-size:90%;">34.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.4.13"><span class="ltx_text" id="S4.T3.5.4.13.1" style="font-size:90%;">46.75</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.5">
<td class="ltx_td ltx_align_left" id="S4.T3.5.5.1">
<span class="ltx_text" id="S4.T3.5.5.1.1" style="font-size:90%;">Tent</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T3.5.5.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib69" title=""><span class="ltx_text" style="font-size:90%;">69</span></a><span class="ltx_text" id="S4.T3.5.5.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.5.2"><span class="ltx_text" id="S4.T3.5.5.2.1" style="font-size:90%;">46.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.5.3"><span class="ltx_text" id="S4.T3.5.5.3.1" style="font-size:90%;">57.60</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.5.4"><span class="ltx_text" id="S4.T3.5.5.4.1" style="font-size:90%;">38.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.5.5"><span class="ltx_text" id="S4.T3.5.5.5.1" style="font-size:90%;">48.85</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.5.6"><span class="ltx_text" id="S4.T3.5.5.6.1" style="font-size:90%;">29.15</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T3.5.5.7"><span class="ltx_text" id="S4.T3.5.5.7.1" style="font-size:90%;">38.51</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.5.8"><span class="ltx_text" id="S4.T3.5.5.8.1" style="font-size:90%;">36.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.5.9"><span class="ltx_text" id="S4.T3.5.5.9.1" style="font-size:90%;">47.04</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.5.10"><span class="ltx_text" id="S4.T3.5.5.10.1" style="font-size:90%;">38.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.5.11"><span class="ltx_text" id="S4.T3.5.5.11.1" style="font-size:90%;">50.05</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.5.12"><span class="ltx_text" id="S4.T3.5.5.12.1" style="font-size:90%;">35.43</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.5.13"><span class="ltx_text" id="S4.T3.5.5.13.1" style="font-size:90%;">47.23</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.6">
<td class="ltx_td ltx_align_left" id="S4.T3.5.6.1">
<span class="ltx_text" id="S4.T3.5.6.1.1" style="font-size:90%;">Shot</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T3.5.6.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib22" title=""><span class="ltx_text" style="font-size:90%;">22</span></a><span class="ltx_text" id="S4.T3.5.6.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.6.2"><span class="ltx_text" id="S4.T3.5.6.2.1" style="font-size:90%;">47.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.6.3"><span class="ltx_text" id="S4.T3.5.6.3.1" style="font-size:90%;">58.92</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.6.4"><span class="ltx_text" id="S4.T3.5.6.4.1" style="font-size:90%;">40.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.6.5"><span class="ltx_text" id="S4.T3.5.6.5.1" style="font-size:90%;">50.77</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.6.6"><span class="ltx_text" id="S4.T3.5.6.6.1" style="font-size:90%;">28.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T3.5.6.7"><span class="ltx_text" id="S4.T3.5.6.7.1" style="font-size:90%;">37.57</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.6.8"><span class="ltx_text" id="S4.T3.5.6.8.1" style="font-size:90%;">35.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.6.9"><span class="ltx_text" id="S4.T3.5.6.9.1" style="font-size:90%;">46.33</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.6.10"><span class="ltx_text" id="S4.T3.5.6.10.1" style="font-size:90%;">37.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.6.11"><span class="ltx_text" id="S4.T3.5.6.11.1" style="font-size:90%;">48.90</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.6.12"><span class="ltx_text" id="S4.T3.5.6.12.1" style="font-size:90%;">33.72</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.6.13"><span class="ltx_text" id="S4.T3.5.6.13.1" style="font-size:90%;">45.22</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.7">
<td class="ltx_td ltx_align_left" id="S4.T3.5.7.1">
<span class="ltx_text" id="S4.T3.5.7.1.1" style="font-size:90%;">Self-Training</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T3.5.7.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">48</span></a><span class="ltx_text" id="S4.T3.5.7.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.7.2"><span class="ltx_text" id="S4.T3.5.7.2.1" style="font-size:90%;">47.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.7.3"><span class="ltx_text" id="S4.T3.5.7.3.1" style="font-size:90%;">58.74</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.7.4"><span class="ltx_text" id="S4.T3.5.7.4.1" style="font-size:90%;">38.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.7.5"><span class="ltx_text" id="S4.T3.5.7.5.1" style="font-size:90%;">49.99</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.7.6"><span class="ltx_text" id="S4.T3.5.7.6.1" style="font-size:90%;">29.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T3.5.7.7"><span class="ltx_text" id="S4.T3.5.7.7.1" style="font-size:90%;">39.19</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.7.8"><span class="ltx_text" id="S4.T3.5.7.8.1" style="font-size:90%;">37.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.7.9"><span class="ltx_text" id="S4.T3.5.7.9.1" style="font-size:90%;">47.56</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.7.10"><span class="ltx_text" id="S4.T3.5.7.10.1" style="font-size:90%;">44.14</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.7.11"><span class="ltx_text" id="S4.T3.5.7.11.1" style="font-size:90%;">56.42</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.7.12"><span class="ltx_text" id="S4.T3.5.7.12.1" style="font-size:90%;">42.46</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.7.13"><span class="ltx_text" id="S4.T3.5.7.13.1" style="font-size:90%;">54.99</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.8">
<td class="ltx_td ltx_align_left" id="S4.T3.5.8.1">
<span class="ltx_text" id="S4.T3.5.8.1.1" style="font-size:90%;">DePT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T3.5.8.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib70" title=""><span class="ltx_text" style="font-size:90%;">70</span></a><span class="ltx_text" id="S4.T3.5.8.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.8.2"><span class="ltx_text" id="S4.T3.5.8.2.1" style="font-size:90%;">50.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.8.3"><span class="ltx_text" id="S4.T3.5.8.3.1" style="font-size:90%;">61.43</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.8.4"><span class="ltx_text" id="S4.T3.5.8.4.1" style="font-size:90%;color:#0000FF;">43.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.8.5"><span class="ltx_text" id="S4.T3.5.8.5.1" style="font-size:90%;color:#0000FF;">55.58</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.8.6"><span class="ltx_text" id="S4.T3.5.8.6.1" style="font-size:90%;">34.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T3.5.8.7"><span class="ltx_text" id="S4.T3.5.8.7.1" style="font-size:90%;">46.08</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.8.8"><span class="ltx_text" id="S4.T3.5.8.8.1" style="font-size:90%;color:#FF0000;">55.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.8.9"><span class="ltx_text" id="S4.T3.5.8.9.1" style="font-size:90%;color:#FF0000;">67.86</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.8.10"><span class="ltx_text" id="S4.T3.5.8.10.1" style="font-size:90%;color:#0000FF;">54.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.8.11"><span class="ltx_text" id="S4.T3.5.8.11.1" style="font-size:90%;color:#0000FF;">68.04</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.8.12"><span class="ltx_text" id="S4.T3.5.8.12.1" style="font-size:90%;color:#0000FF;">54.13</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.8.13"><span class="ltx_text" id="S4.T3.5.8.13.1" style="font-size:90%;color:#0000FF;">67.17</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.9">
<td class="ltx_td ltx_align_left" id="S4.T3.5.9.1">
<span class="ltx_text" id="S4.T3.5.9.1.1" style="font-size:90%;">Tribe</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T3.5.9.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a><span class="ltx_text" id="S4.T3.5.9.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.9.2"><span class="ltx_text" id="S4.T3.5.9.2.1" style="font-size:90%;color:#0000FF;">51.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.9.3"><span class="ltx_text" id="S4.T3.5.9.3.1" style="font-size:90%;color:#0000FF;">62.53</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.9.4"><span class="ltx_text" id="S4.T3.5.9.4.1" style="font-size:90%;">42.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.9.5"><span class="ltx_text" id="S4.T3.5.9.5.1" style="font-size:90%;">53.39</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.9.6"><span class="ltx_text" id="S4.T3.5.9.6.1" style="font-size:90%;">32.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T3.5.9.7"><span class="ltx_text" id="S4.T3.5.9.7.1" style="font-size:90%;">42.77</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.9.8"><span class="ltx_text" id="S4.T3.5.9.8.1" style="font-size:90%;">42.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.9.9"><span class="ltx_text" id="S4.T3.5.9.9.1" style="font-size:90%;">55.12</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.9.10"><span class="ltx_text" id="S4.T3.5.9.10.1" style="font-size:90%;">46.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.9.11"><span class="ltx_text" id="S4.T3.5.9.11.1" style="font-size:90%;">59.90</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.9.12"><span class="ltx_text" id="S4.T3.5.9.12.1" style="font-size:90%;">39.19</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.9.13"><span class="ltx_text" id="S4.T3.5.9.13.1" style="font-size:90%;">51.11</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.10">
<td class="ltx_td ltx_align_left" id="S4.T3.5.10.1">
<span class="ltx_text" id="S4.T3.5.10.1.1" style="font-size:90%;">WeSAM</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T3.5.10.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a><span class="ltx_text" id="S4.T3.5.10.1.3.2" style="font-size:90%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.10.2"><span class="ltx_text" id="S4.T3.5.10.2.1" style="font-size:90%;">50.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.10.3"><span class="ltx_text" id="S4.T3.5.10.3.1" style="font-size:90%;">62.43</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.10.4"><span class="ltx_text" id="S4.T3.5.10.4.1" style="font-size:90%;">41.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.10.5"><span class="ltx_text" id="S4.T3.5.10.5.1" style="font-size:90%;">53.58</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.10.6"><span class="ltx_text" id="S4.T3.5.10.6.1" style="font-size:90%;color:#0000FF;">35.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T3.5.10.7"><span class="ltx_text" id="S4.T3.5.10.7.1" style="font-size:90%;color:#0000FF;">46.54</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.10.8"><span class="ltx_text" id="S4.T3.5.10.8.1" style="font-size:90%;">47.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.10.9"><span class="ltx_text" id="S4.T3.5.10.9.1" style="font-size:90%;">60.02</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.10.10"><span class="ltx_text" id="S4.T3.5.10.10.1" style="font-size:90%;">47.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.10.11"><span class="ltx_text" id="S4.T3.5.10.11.1" style="font-size:90%;">60.77</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.10.12"><span class="ltx_text" id="S4.T3.5.10.12.1" style="font-size:90%;">45.30</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.10.13"><span class="ltx_text" id="S4.T3.5.10.13.1" style="font-size:90%;">59.06</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.11">
<td class="ltx_td ltx_align_left" id="S4.T3.5.11.1"><span class="ltx_text" id="S4.T3.5.11.1.1" style="font-size:90%;">PointSAM(Ours)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.11.2"><span class="ltx_text" id="S4.T3.5.11.2.1" style="font-size:90%;color:#FF0000;">56.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.11.3"><span class="ltx_text" id="S4.T3.5.11.3.1" style="font-size:90%;color:#FF0000;">68.38</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.11.4"><span class="ltx_text" id="S4.T3.5.11.4.1" style="font-size:90%;color:#FF0000;">57.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.11.5"><span class="ltx_text" id="S4.T3.5.11.5.1" style="font-size:90%;color:#FF0000;">70.50</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.11.6"><span class="ltx_text" id="S4.T3.5.11.6.1" style="font-size:90%;color:#FF0000;">59.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_rr" id="S4.T3.5.11.7"><span class="ltx_text" id="S4.T3.5.11.7.1" style="font-size:90%;color:#FF0000;">72.43</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.11.8"><span class="ltx_text" id="S4.T3.5.11.8.1" style="font-size:90%;color:#0000FF;">52.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.11.9"><span class="ltx_text" id="S4.T3.5.11.9.1" style="font-size:90%;color:#0000FF;">65.11</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.11.10"><span class="ltx_text" id="S4.T3.5.11.10.1" style="font-size:90%;color:#FF0000;">55.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.5.11.11"><span class="ltx_text" id="S4.T3.5.11.11.1" style="font-size:90%;color:#FF0000;">68.82</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.11.12"><span class="ltx_text" id="S4.T3.5.11.12.1" style="font-size:90%;color:#FF0000;">58.83</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.5.11.13"><span class="ltx_text" id="S4.T3.5.11.13.1" style="font-size:90%;color:#FF0000;">71.98</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.12">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T3.5.12.1"><span class="ltx_text" id="S4.T3.5.12.1.1" style="font-size:90%;color:#808080;">Supervised</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.5.12.2"><span class="ltx_text" id="S4.T3.5.12.2.1" style="font-size:90%;color:#808080;">63.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.5.12.3"><span class="ltx_text" id="S4.T3.5.12.3.1" style="font-size:90%;color:#808080;">75.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.5.12.4"><span class="ltx_text" id="S4.T3.5.12.4.1" style="font-size:90%;color:#808080;">65.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.5.12.5"><span class="ltx_text" id="S4.T3.5.12.5.1" style="font-size:90%;color:#808080;">77.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.5.12.6"><span class="ltx_text" id="S4.T3.5.12.6.1" style="font-size:90%;color:#808080;">66.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_rr ltx_border_t" id="S4.T3.5.12.7"><span class="ltx_text" id="S4.T3.5.12.7.1" style="font-size:90%;color:#808080;">78.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.5.12.8"><span class="ltx_text" id="S4.T3.5.12.8.1" style="font-size:90%;color:#808080;">67.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.5.12.9"><span class="ltx_text" id="S4.T3.5.12.9.1" style="font-size:90%;color:#808080;">78.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.5.12.10"><span class="ltx_text" id="S4.T3.5.12.10.1" style="font-size:90%;color:#808080;">70.83</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.5.12.11"><span class="ltx_text" id="S4.T3.5.12.11.1" style="font-size:90%;color:#808080;">81.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.5.12.12"><span class="ltx_text" id="S4.T3.5.12.12.1" style="font-size:90%;color:#808080;">71.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.5.12.13"><span class="ltx_text" id="S4.T3.5.12.13.1" style="font-size:90%;color:#808080;">82.42</span></td>
</tr>
</table>
</figure>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Ablation studies of the proposed PointSAM on the HRSID-inshore dataset. ST, NPC, and PBR refer to self-training, negative prompt calibration, and prototype-based regularization, respectively.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T4.1">
<tr class="ltx_tr" id="S4.T4.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T4.1.1.1.1" style="font-size:90%;">ST</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.2" rowspan="2"><span class="ltx_text" id="S4.T4.1.1.2.1" style="font-size:90%;">PBR</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T4.1.1.3" rowspan="2"><span class="ltx_text" id="S4.T4.1.1.3.1" style="font-size:90%;">NPC</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T4.1.1.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T4.1.1.4.1" style="font-size:90%;background-color:#E6E6E6;">1-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T4.1.1.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T4.1.1.5.1" style="font-size:90%;background-color:#E6E6E6;">2-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T4.1.1.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T4.1.1.6.1" style="font-size:90%;background-color:#E6E6E6;">3-Point</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1"><span class="ltx_text" id="S4.T4.1.2.1.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.2"><span class="ltx_text" id="S4.T4.1.2.2.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.3"><span class="ltx_text" id="S4.T4.1.2.3.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.4"><span class="ltx_text" id="S4.T4.1.2.4.1" style="font-size:90%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.5"><span class="ltx_text" id="S4.T4.1.2.5.1" style="font-size:90%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.6"><span class="ltx_text" id="S4.T4.1.2.6.1" style="font-size:90%;">F1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3">
<td class="ltx_td ltx_border_t" id="S4.T4.1.3.1"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.1.3.2"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T4.1.3.3"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.4"><span class="ltx_text" id="S4.T4.1.3.4.1" style="font-size:90%;">46.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.5"><span class="ltx_text" id="S4.T4.1.3.5.1" style="font-size:90%;">57.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.6"><span class="ltx_text" id="S4.T4.1.3.6.1" style="font-size:90%;">37.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.7"><span class="ltx_text" id="S4.T4.1.3.7.1" style="font-size:90%;">48.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.8"><span class="ltx_text" id="S4.T4.1.3.8.1" style="font-size:90%;">28.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.9"><span class="ltx_text" id="S4.T4.1.3.9.1" style="font-size:90%;">37.57</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.4">
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.1"><span class="ltx_text" id="S4.T4.1.4.1.1" style="font-size:90%;">✔</span></td>
<td class="ltx_td" id="S4.T4.1.4.2"></td>
<td class="ltx_td ltx_border_r" id="S4.T4.1.4.3"></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4">
<span class="ltx_text" id="S4.T4.1.4.4.1" style="font-size:90%;">47.44 </span><span class="ltx_text" id="S4.T4.1.4.4.2" style="font-size:70%;color:#008000;">(+0.88)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.5">
<span class="ltx_text" id="S4.T4.1.4.5.1" style="font-size:90%;">58.74 </span><span class="ltx_text" id="S4.T4.1.4.5.2" style="font-size:70%;color:#008000;">(+1.28)</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.6">
<span class="ltx_text" id="S4.T4.1.4.6.1" style="font-size:90%;">38.90 </span><span class="ltx_text" id="S4.T4.1.4.6.2" style="font-size:70%;color:#008000;">(+1.10)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.7">
<span class="ltx_text" id="S4.T4.1.4.7.1" style="font-size:90%;">49.99 </span><span class="ltx_text" id="S4.T4.1.4.7.2" style="font-size:70%;color:#008000;">(+1.65)</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.8">
<span class="ltx_text" id="S4.T4.1.4.8.1" style="font-size:90%;">29.19 </span><span class="ltx_text" id="S4.T4.1.4.8.2" style="font-size:70%;color:#008000;">(+0.87)</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.9">
<span class="ltx_text" id="S4.T4.1.4.9.1" style="font-size:90%;">39.19 </span><span class="ltx_text" id="S4.T4.1.4.9.2" style="font-size:70%;color:#008000;">(+1.62)</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.5">
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.1"><span class="ltx_text" id="S4.T4.1.5.1.1" style="font-size:90%;">✔</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.2"><span class="ltx_text" id="S4.T4.1.5.2.1" style="font-size:90%;">✔</span></td>
<td class="ltx_td ltx_border_r" id="S4.T4.1.5.3"></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.4">
<span class="ltx_text" id="S4.T4.1.5.4.1" style="font-size:90%;">53.86 </span><span class="ltx_text" id="S4.T4.1.5.4.2" style="font-size:70%;color:#008000;">(+6.30)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.5">
<span class="ltx_text" id="S4.T4.1.5.5.1" style="font-size:90%;">66.40 </span><span class="ltx_text" id="S4.T4.1.5.5.2" style="font-size:70%;color:#008000;">(+8.94)</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.6">
<span class="ltx_text" id="S4.T4.1.5.6.1" style="font-size:90%;">50.30 </span><span class="ltx_text" id="S4.T4.1.5.6.2" style="font-size:70%;color:#008000;">(+12.50)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.7">
<span class="ltx_text" id="S4.T4.1.5.7.1" style="font-size:90%;">62.42 </span><span class="ltx_text" id="S4.T4.1.5.7.2" style="font-size:70%;color:#008000;">(+14.08)</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.8">
<span class="ltx_text" id="S4.T4.1.5.8.1" style="font-size:90%;">48.04 </span><span class="ltx_text" id="S4.T4.1.5.8.2" style="font-size:70%;color:#008000;">(+18.85)</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.9">
<span class="ltx_text" id="S4.T4.1.5.9.1" style="font-size:90%;">61.20 </span><span class="ltx_text" id="S4.T4.1.5.9.2" style="font-size:70%;color:#008000;">(+23.63)</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.6">
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.1"><span class="ltx_text" id="S4.T4.1.6.1.1" style="font-size:90%;">✔</span></td>
<td class="ltx_td" id="S4.T4.1.6.2"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.3"><span class="ltx_text" id="S4.T4.1.6.3.1" style="font-size:90%;">✔</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.4">
<span class="ltx_text" id="S4.T4.1.6.4.1" style="font-size:90%;">52.86 </span><span class="ltx_text" id="S4.T4.1.6.4.2" style="font-size:70%;color:#008000;">(+6.30)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.5">
<span class="ltx_text" id="S4.T4.1.6.5.1" style="font-size:90%;">65.29 </span><span class="ltx_text" id="S4.T4.1.6.5.2" style="font-size:70%;color:#008000;">(+7.83)</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.6">
<span class="ltx_text" id="S4.T4.1.6.6.1" style="font-size:90%;">54.55 </span><span class="ltx_text" id="S4.T4.1.6.6.2" style="font-size:70%;color:#008000;">(+16.75)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.7">
<span class="ltx_text" id="S4.T4.1.6.7.1" style="font-size:90%;">67.06 </span><span class="ltx_text" id="S4.T4.1.6.7.2" style="font-size:70%;color:#008000;">(+18.72)</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.8">
<span class="ltx_text" id="S4.T4.1.6.8.1" style="font-size:90%;">53.34 </span><span class="ltx_text" id="S4.T4.1.6.8.2" style="font-size:70%;color:#008000;">(+25.02)</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.9">
<span class="ltx_text" id="S4.T4.1.6.9.1" style="font-size:90%;">66.77 </span><span class="ltx_text" id="S4.T4.1.6.9.2" style="font-size:70%;color:#008000;">(+29.20)</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.7">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.7.1"><span class="ltx_text" id="S4.T4.1.7.1.1" style="font-size:90%;">✔</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.7.2"><span class="ltx_text" id="S4.T4.1.7.2.1" style="font-size:90%;">✔</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.1.7.3"><span class="ltx_text" id="S4.T4.1.7.3.1" style="font-size:90%;">✔</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.7.4">
<span class="ltx_text" id="S4.T4.1.7.4.1" style="font-size:90%;">56.06 </span><span class="ltx_text" id="S4.T4.1.7.4.2" style="font-size:70%;color:#008000;">(+9.50)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.1.7.5">
<span class="ltx_text" id="S4.T4.1.7.5.1" style="font-size:90%;">68.38 </span><span class="ltx_text" id="S4.T4.1.7.5.2" style="font-size:70%;color:#008000;">(+10.92)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.7.6">
<span class="ltx_text" id="S4.T4.1.7.6.1" style="font-size:90%;">57.79 </span><span class="ltx_text" id="S4.T4.1.7.6.2" style="font-size:70%;color:#008000;">(+19.99)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.1.7.7">
<span class="ltx_text" id="S4.T4.1.7.7.1" style="font-size:90%;">70.50 </span><span class="ltx_text" id="S4.T4.1.7.7.2" style="font-size:70%;color:#008000;">(+22.16)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.7.8">
<span class="ltx_text" id="S4.T4.1.7.8.1" style="font-size:90%;">59.37 </span><span class="ltx_text" id="S4.T4.1.7.8.2" style="font-size:70%;color:#008000;">(+31.05)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.7.9">
<span class="ltx_text" id="S4.T4.1.7.9.1" style="font-size:90%;">72.43 </span><span class="ltx_text" id="S4.T4.1.7.9.2" style="font-size:70%;color:#008000;">(+34.86)</span>
</td>
</tr>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS3.5.1.1">IV-C</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS3.6.2">Quantitative Evaluations</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We conducted quantitative evaluations across three datasets—NWPU VHR-10, WHU, and HRSID-inshore. All comparison methods were reproduced on both SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a>]</cite> and SAM2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite>, and we compared the IoU and F1 scores for different numbers of points, ranging from 1 to 3.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS3.SSS1.5.1.1">IV-C</span>1 </span>NWPU VHR-10</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">We first present the results of adapting various methods to the NWPU VHR-10 test set, as shown in Tab.<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.T1" title="TABLE I ‣ IV-B Experiment Details ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">I</span></a>. Due to the substantial differences in viewing angles between aerial images and natural images, a significant distribution shift occurs, posing challenges for model generalization. As a result, we observe a notable performance gap between the <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.1">Supervised</span> upper bound and the <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.2">Direct test</span> baseline, with IoU differences consistently around 20% across various numbers of prompts. In contrast, <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.3">Ours</span> consistently achieves the highest performance across both IoU and F1 metrics compared to other methods. Although <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.4">Tent</span> and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.5">Shot</span> methods have shown promising results in image-level tasks, segmentation tasks operate at the pixel level, which introduces greater complexity. Self-training-based methods (<span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.6">Tribe</span>, <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.7">DePT</span>, and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.8">WeSAM</span>) each exhibit distinct strengths, and all outperform the original self-training methods. This highlights the crucial role of regularization in network training, especially under weak supervision conditions. We also find that <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.9">SAM2</span> outperforms <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.10">SAM</span> in both direct test and supervised settings, demonstrating its superior generalization capability. However, when SAM2 is integrated into other methods, the performance improvement over SAM varies. This inconsistency arises because, despite incorporating SAM2, we continued to use SAM’s approach in integrating. The unique advantages of SAM2’s memory module were not fully utilized, which presents an opportunity for further exploration in future work.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS3.SSS2.5.1.1">IV-C</span>2 </span>WHU</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">Building extraction is highly practical in remote sensing image processing. The irregular shapes of buildings as captured from overhead views introduce significant challenges for direct testing with SAM. As shown in Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.T2" title="TABLE II ‣ IV-B Experiment Details ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">II</span></a>, <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.1">Direct test</span> with SAM or SAM2 shows a performance gap exceeding 10% compared to the <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.2">supervised</span> method. Our approach effectively narrows this gap to within 5%. This is because, although the shapes of buildings vary, their contours are distinct. <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.3">Ours</span> effectively adapts the source domain to the target domain. It can be observed that the performance of the <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.4">self-training</span> method decreases as the number of points increases. This is because semantically ambiguous points lead to cumulative errors in the training. <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.5">DePT</span> and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.6">WeSAM</span> show significant improvements compared to self-training; however, they are not consistently effective in all cases.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS3.SSS3.5.1.1">IV-C</span>3 </span>HRSID-inshore</h4>
<div class="ltx_para" id="S4.SS3.SSS3.p1">
<p class="ltx_p" id="S4.SS3.SSS3.p1.1">Unlike optical images, SAR images present a larger domain gap. Additionally, imaging conditions can lead to ships appearing hollow or introducing significant noise. As shown in Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.T3" title="TABLE III ‣ IV-B Experiment Details ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">III</span></a>. It can be observed that the <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p1.1.1">Direct test</span> performance differs significantly from the <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p1.1.2">Supervised</span> performance, with a gap of up to 40% in the 3-point setting. Additionally, increasing the number of prompts does not necessarily enhance performance. As the number of points increases, suboptimal positive prompts may have a greater negative impact on performance. For example, most methods that use SAM as the base model experience a decline in performance as the number of prompts increases. Even with the more advanced SAM2, this limitation cannot be fully addressed. In contrast, <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p1.1.3">Ours</span> consistently improves both IoU and F1 scores under the same conditions except for being slightly lower than <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p1.1.4">DePT</span> in the 1-point setting. This is because the proposed NPC strategy adjusts the negative prompts to appropriate positions, allowing the positive prompts to generate more accurate masks.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS4.5.1.1">IV-D</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS4.6.2">Ablation study</span>
</h3>
<section class="ltx_subsubsection" id="S4.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS4.SSS1.5.1.1">IV-D</span>1 </span>Impact of different components</h4>
<div class="ltx_para" id="S4.SS4.SSS1.p1">
<p class="ltx_p" id="S4.SS4.SSS1.p1.1">In this section, we analyze the effectiveness of individual components on the HRSID-inshore dataset. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.T4" title="TABLE IV ‣ IV-B Experiment Details ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">IV</span></a>, the first row represents the <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS1.p1.1.1">baseline</span>, where the vanilla SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a>]</cite> is tested directly. When <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS1.p1.1.2">Self-Training</span> (ST) is introduced, there is only a slight improvement, as the strong and weak data augmentations enhance the network’s robustness but cannot prevent error accumulation. Adding <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS1.p1.1.3">Prototype-Based Regularization</span> (PBR) to self-training results in significant improvements across all metrics, with increases ranging from 10% to 20%. This is because regularization helps alleviate error accumulation in the network. However, when more points are used, the results still decline. This is due to the small size of the targets, where additional points may appear on object boundaries, leading to misclassification of background as foreground. Adding <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS1.p1.1.4">Negative Prompt Calibration</span> (NPC) to self-training effectively addresses this issue. It maintains stable results for each point setting and significantly improves performance over ST. When both NPC and PBR are incorporated, the performance reaches its best across all metrics. Especially in the 3-point setting, performance shows more than a 30% improvement compared to the baseline. This suggests that the two strategies are not mutually exclusive and can complement each other.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS4.SSS2.5.1.1">IV-D</span>2 </span>Alternative Distance Metric in Hungarian Match</h4>
<div class="ltx_para" id="S4.SS4.SSS2.p1">
<p class="ltx_p" id="S4.SS4.SSS2.p1.1">The Tab. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.T5" title="TABLE V ‣ IV-D2 Alternative Distance Metric in Hungarian Match ‣ IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">V</span></a> shows the performance of different distance metrics (Cosine, L1, L2) in Eq.<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.E7" title="In III-C3 Hungarian Matching ‣ III-C Prototype-based Regularization ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">7</span></a> under 1-, 2-, and 3-point settings. The cosine metric performs best in all cases. This is due to it focus on direction similarity rather than absolute magnitude, as well as its advantages in handling sparse and high-dimensional data.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span>The impact of different distance metrics in Hungarian matching on the HRSID-inshore dataset.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T5.1">
<tr class="ltx_tr" id="S4.T5.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T5.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T5.1.1.1.1" style="font-size:80%;">Distance Metric</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T5.1.1.2"><span class="ltx_text" id="S4.T5.1.1.2.1" style="font-size:80%;">1-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T5.1.1.3"><span class="ltx_text" id="S4.T5.1.1.3.1" style="font-size:80%;">2-Point</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T5.1.1.4"><span class="ltx_text" id="S4.T5.1.1.4.1" style="font-size:80%;">3-Point</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1"><span class="ltx_text" id="S4.T5.1.2.1.1" style="font-size:80%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.2.2"><span class="ltx_text" id="S4.T5.1.2.2.1" style="font-size:80%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.3"><span class="ltx_text" id="S4.T5.1.2.3.1" style="font-size:80%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.2.4"><span class="ltx_text" id="S4.T5.1.2.4.1" style="font-size:80%;">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.5"><span class="ltx_text" id="S4.T5.1.2.5.1" style="font-size:80%;">IoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.6"><span class="ltx_text" id="S4.T5.1.2.6.1" style="font-size:80%;">F1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.1"><span class="ltx_text" id="S4.T5.1.3.1.1" style="font-size:80%;">Cosine</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.2.1" style="font-size:80%;">56.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.3.1" style="font-size:80%;">68.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.4.1" style="font-size:80%;">57.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.5.1" style="font-size:80%;">70.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.6.1" style="font-size:80%;">59.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.7"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.7.1" style="font-size:80%;">72.43</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.4.1"><span class="ltx_text" id="S4.T5.1.4.1.1" style="font-size:80%;">L1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.2"><span class="ltx_text" id="S4.T5.1.4.2.1" style="font-size:80%;">54.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.4.3"><span class="ltx_text" id="S4.T5.1.4.3.1" style="font-size:80%;">67.81</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.4"><span class="ltx_text" id="S4.T5.1.4.4.1" style="font-size:80%;">56.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.4.5"><span class="ltx_text" id="S4.T5.1.4.5.1" style="font-size:80%;">69.36</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.6"><span class="ltx_text" id="S4.T5.1.4.6.1" style="font-size:80%;">58.14</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.7"><span class="ltx_text" id="S4.T5.1.4.7.1" style="font-size:80%;">71.10</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T5.1.5.1"><span class="ltx_text" id="S4.T5.1.5.1.1" style="font-size:80%;">L2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.5.2"><span class="ltx_text" id="S4.T5.1.5.2.1" style="font-size:80%;">55.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T5.1.5.3"><span class="ltx_text" id="S4.T5.1.5.3.1" style="font-size:80%;">68.04</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.5.4"><span class="ltx_text" id="S4.T5.1.5.4.1" style="font-size:80%;">56.14</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T5.1.5.5"><span class="ltx_text" id="S4.T5.1.5.5.1" style="font-size:80%;">68.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.5.6"><span class="ltx_text" id="S4.T5.1.5.6.1" style="font-size:80%;">58.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.5.7"><span class="ltx_text" id="S4.T5.1.5.7.1" style="font-size:80%;">71.43</span></td>
</tr>
</table>
</figure>
<figure class="ltx_figure" id="S4.F5">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.F5.1">
<tr class="ltx_tr" id="S4.F5.1.1">
<td class="ltx_td ltx_align_center" id="S4.F5.1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="463" id="S4.F5.1.1.1.g1" src="x1.png" width="747"/></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>
The impact of different thresholds of IoU on the HRSID-inshore dataset with 1-point.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS4.SSS3.5.1.1">IV-D</span>3 </span>Alternative IoU threshold</h4>
<div class="ltx_para" id="S4.SS4.SSS3.p1">
<p class="ltx_p" id="S4.SS4.SSS3.p1.1">As mentioned earlier, NPC utilizes the IoU between masks to determine whether to use them as negative prompts. Hence, we evaluated the impact of different IoU thresholds in Eq.<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S3.E7" title="In III-C3 Hungarian Matching ‣ III-C Prototype-based Regularization ‣ III Methodology ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">7</span></a> on the HRSID-inshore dataset, selecting values from 0 to 0.9 at intervals of 0.1. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.F5" title="Figure 5 ‣ IV-D2 Alternative Distance Metric in Hungarian Match ‣ IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">5</span></a>, the results peak at a threshold of 0.1. When the threshold is set to 0, the performance is slightly lower, likely due to the introduction of noisy prompts. As the IoU threshold increases beyond 0.1, both F1 and IoU metrics exhibit a downward trend. This decline is attributed to the reduced likelihood of negative prompt adjustments at higher thresholds, diminishing the influence of NPC.</p>
</div>
<figure class="ltx_figure" id="S4.F6">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.F6.1">
<tr class="ltx_tr" id="S4.F6.1.1">
<td class="ltx_td ltx_align_center" id="S4.F6.1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="497" id="S4.F6.1.1.1.g1" src="x2.png" width="747"/></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>
The comparison of the different feature clustering and alignment methods on the HRSID-inshore dataset.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS4.SSS4.5.1.1">IV-D</span>4 </span>Comparison with other feature alignment methods.</h4>
<div class="ltx_para" id="S4.SS4.SSS4.p1">
<p class="ltx_p" id="S4.SS4.SSS4.p1.1">We compared different clustering and feature alignment methods, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.F6" title="Figure 6 ‣ IV-D3 Alternative IoU threshold ‣ IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">6</span></a>. <span class="ltx_text ltx_font_bold" id="S4.SS4.SSS4.p1.1.1">KLD</span> constrains the feature mean and variance of the source and target models on the target data using Kullback-Leibler divergence. <span class="ltx_text ltx_font_bold" id="S4.SS4.SSS4.p1.1.2">Kmeans</span> refers to the use of the Kmeans algorithm for feature clustering in PBR, while <span class="ltx_text ltx_font_bold" id="S4.SS4.SSS4.p1.1.3">FINCH</span> is the clustering method used in our work. The results show that FINCH outperforms other methods across various point settings.KLD performs poorly due to insufficient data, leading to inaccurate variance estimation. Kmeans performs slightly worse than FINCH because it requires manually set, fixed clustering centers that are not adaptive to the feature distribution. More importantly, it is more than three times slower than FINCH.</p>
</div>
<figure class="ltx_figure" id="S4.F7">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.F7.1">
<tr class="ltx_tr" id="S4.F7.1.1">
<td class="ltx_td ltx_align_center" id="S4.F7.1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="445" id="S4.F7.1.1.1.g1" src="x3.png" width="747"/></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>
The impact of the number of points on different methods on the NWPU VHR-10 dataset.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F8">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.F8.1">
<tr class="ltx_tr" id="S4.F8.1.1">
<td class="ltx_td ltx_align_center" id="S4.F8.1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="322" id="S4.F8.1.1.1.g1" src="x4.png" width="830"/></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>
Visualization of the results of negative prompt calibration during training. The positive and negative prompts are represented by red points (<span class="ltx_text" id="S4.F8.4.1" style="font-size:120%;color:#FF0000;">•</span>) and green points (<span class="ltx_text" id="S4.F8.5.2" style="font-size:120%;color:#00FF00;">•</span>), respectively. The refined mask is generated from the initial mask after applying negative prompt calibration. This calibration effectively guides the negative prompts to more precise regions, enabling the generation of accurate masks.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS4.SSS5.5.1.1">IV-D</span>5 </span>How about more points?</h4>
<div class="ltx_para" id="S4.SS4.SSS5.p1">
<p class="ltx_p" id="S4.SS4.SSS5.p1.1">We validated the results of different methods under an increased number of point prompts. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.F7" title="Figure 7 ‣ IV-D4 Comparison with other feature alignment methods. ‣ IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">7</span></a>, simply adding more points does not consistently lead to better performance. This is because increasing the number of points also raises the likelihood of including low-quality points. Such noise can negatively affect the segmentation results of other points. For the <span class="ltx_text ltx_font_bold" id="S4.SS4.SSS5.p1.1.1">Supervised</span> method, the results remained relatively unchanged due to the presence of full-mask constraints. <span class="ltx_text ltx_font_bold" id="S4.SS4.SSS5.p1.1.2">Direct test</span> achieved its best results with two points; however, as the number of points increased, the F1 score gradually decreased. Similarly, <span class="ltx_text ltx_font_bold" id="S4.SS4.SSS5.p1.1.3">Self-training</span> showed a decline in results due to the generation of noisy pseudo-labels. In contrast, our proposed <span class="ltx_text ltx_font_bold" id="S4.SS4.SSS5.p1.1.4">PointSAM</span> maintained stable results, approaching the performance of <span class="ltx_text ltx_font_bold" id="S4.SS4.SSS5.p1.1.5">Supervised</span>. This is because negative prompt calibration effectively corrected the prompts and reduced the impact of inaccurate masks caused by too many points.</p>
</div>
<figure class="ltx_figure" id="S4.F9">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.F9.1">
<tr class="ltx_tr" id="S4.F9.1.1">
<td class="ltx_td ltx_align_center" id="S4.F9.1.1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="849" id="S4.F9.1.1.1.g1" src="x5.png" width="830"/></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Comparison of visualization results for different methods. Rows 1-3 show the results on NWPU VHR-10 with 1 to 3 prompts; similarly, rows 4-6 display the results on WHU, and rows 7-9 show the results on HRSID-inshore. White arrows or zoom-ins in images are used to highlight.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS5.5.1.1">IV-E</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS5.6.2">Qualitative Evaluations</span>
</h3>
<section class="ltx_subsubsection" id="S4.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS5.SSS1.5.1.1">IV-E</span>1 </span>Visualization of the NPC Process</h4>
<div class="ltx_para" id="S4.SS5.SSS1.p1">
<p class="ltx_p" id="S4.SS5.SSS1.p1.1">To visually demonstrate the effect of NPC during training, we present the results from the initial mask to the refined mask across three datasets. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.F8" title="Figure 8 ‣ IV-D4 Comparison with other feature alignment methods. ‣ IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">8</span></a>, the red points and green points represent positive prompts and negative prompts, respectively. In the first row for the NWPU VHR-10 dataset, the texture information of the tennis court is quite subtle, causing the initial mask to include an adjacent tennis court. After incorporating NPC, overlapping objects are treated as negative prompts, leading to the removal of excess masks. As the number of positive prompts increases, prompts located at the edges of objects are more likely to cause semantic ambiguity. This ambiguity can be accurately eliminated through NPC. For the buildings (second row) in the WHU dataset, they all have similar colors, which makes the mask indicated by the point prone to interference. Thanks to the large number of buildings in each image, NPC can easily locate nearby ambiguous masks, thus constraining the target mask. For the most challenging HRSID-inshore dataset, due to the SAR imaging mechanism, the color of each ship and the inshore scene appear identical (third row). Moreover, the targets are small and may be hollow. Therefore, if each negative prompt is constrained, a large amount of non-target regions will be designated as the mask. It can be seen that our method effectively suppresses redundant regions, regardless of the number of prompts.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS5.SSS2.5.1.1">IV-E</span>2 </span>Visualization of results from different methods</h4>
<div class="ltx_para" id="S4.SS5.SSS2.p1">
<p class="ltx_p" id="S4.SS5.SSS2.p1.1">We then present the comparative results of different methods across various datasets. In the Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#S4.F9" title="Figure 9 ‣ IV-D5 How about more points? ‣ IV-D Ablation study ‣ IV Experiments ‣ PointSAM: Pointly-Supervised Segment Anything Model for Remote Sensing Images"><span class="ltx_text ltx_ref_tag">9</span></a>, rows 1-3 show the results on NWPU VHR-10 with 1 to 3 prompts; similarly, rows 4-6 display the results on WHU, and rows 7-9 show the results on HRSID-inshore. It can be observed that due to the bird’s-eye view in remote sensing images, there is a significant difference from natural images. Directly using the original SAM leads to an inability to distinguish each target clearly. For example, in the sixth row, the white building on the left and the parking lot on the right are treated as the same object. Even more notably, in the HRSID-inshore dataset, most of the inshore area is wrongly labeled as the target mask. Self-training transfers the source model to the target data, reducing more redundant areas and producing relatively more complete predicted masks compared to direct testing. However, it still fails to mitigate the interference between adjacent objects, such as the tennis court in the second row and the building in the fifth row. DePT, Tribe, and WeSAM are all improvements based on self-training, and they handle mask details better than self-training. However, in more challenging scenarios, they still fail to achieve optimal results. For example, in the third row, the storage tank and its shadow are not separated, and the ships in the inshore scene are not accurately segmented (rows 7-9). In contrast, our method excels at handling objects in dense scenes, achieving performance close to the ground truth.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS6.5.1.1">IV-F</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS6.6.2">PointSAM as a Detection Box Generator</span>
</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">In this section, we serve PointSAM as a point-to-box generator. PointSAM can generate corresponding masks based on points, and by calculating the minimum enclosing rectangle of the mask, we can obtain the corresponding horizontal bounding box (HBB). These HBBs can then be fed into a detector that converts horizontal boxes to rotated boxes, achieving <span class="ltx_text ltx_font_italic" id="S4.SS6.p1.1.1">point-supervised oriented object detection</span>. To validate the effectiveness of this approach, we conducted experiments on the HRSID dataset, which includes both inshore and offshore scenarios. All experiments were conducted with an input size of 800×800, running for 12 epochs, and using ResNet-50 as the backbone. As shown in Table 6, we compared our method with representative algorithms based on OBB supervision, HBB supervision, and point supervision. It can be observed that the H2RBox-v2 and the method proposed by <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Yue et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib71" title=""><span class="ltx_text" style="font-size:90%;">71</span></a>]</cite> based on HBB can achieve performance comparable to OBB supervision. The poor performance of H2RBox may be attributed to the large number of small objects in the HRSID dataset. Therefore, our approach also utilizes H2RBox as the detector for converting HBB to OBB. Compared to vanilla SAM, our method achieves a 15% improvement.
This is because directly using SAM can result in unclear segmentation masks for objects in dense scenes, which in turn leads to inaccuracies in the minimum enclosing rectangles. Similarly, our method slightly outperforms Point2Rbox. Essentially, both Ours and Point2RBox leverage prior knowledge to learn the size information of the targets. There remains a gap of nearly 20% compared to the HBB-supervised methods. Future work could focus on integrating multiple types of priors to bridge this gap.</p>
</div>
<figure class="ltx_table" id="S4.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>Comparisons results of different detectors based on HRSID.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T6.3">
<tr class="ltx_tr" id="S4.T6.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T6.1.1.2"><span class="ltx_text" id="S4.T6.1.1.2.1" style="font-size:80%;">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T6.1.1.3"><span class="ltx_text" id="S4.T6.1.1.3.1" style="font-size:80%;">Backbone</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T6.1.1.4"><span class="ltx_text" id="S4.T6.1.1.4.1" style="font-size:80%;">recall(%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T6.1.1.1">
<span class="ltx_text" id="S4.T6.1.1.1.1" style="font-size:80%;">AP</span><sub class="ltx_sub" id="S4.T6.1.1.1.2"><span class="ltx_text ltx_font_italic" id="S4.T6.1.1.1.2.1" style="font-size:80%;">50</span></sub><span class="ltx_text" id="S4.T6.1.1.1.3" style="font-size:80%;">(%)</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.4">
<td class="ltx_td ltx_align_left ltx_border_t" colspan="4" id="S4.T6.3.4.1"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S4.T6.3.4.1.1" style="font-size:80%;">OBB-supervised</em></td>
</tr>
<tr class="ltx_tr" id="S4.T6.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T6.2.2.1">
<span class="ltx_text" id="S4.T6.2.2.1.1" style="font-size:80%;">FCOS-O</span><sup class="ltx_sup" id="S4.T6.2.2.1.2"><span class="ltx_text" id="S4.T6.2.2.1.2.1" style="font-size:80%;">∗</span></sup><span class="ltx_text" id="S4.T6.2.2.1.3" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T6.2.2.1.4.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib72" title=""><span class="ltx_text" style="font-size:90%;">72</span></a><span class="ltx_text" id="S4.T6.2.2.1.5.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.2.2.2"><span class="ltx_text" id="S4.T6.2.2.2.1" style="font-size:80%;">ResNet-50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.2.2.3"><span class="ltx_text" id="S4.T6.2.2.3.1" style="font-size:80%;">83.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.2.2.4"><span class="ltx_text" id="S4.T6.2.2.4.1" style="font-size:80%;">78.4</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T6.3.3.1">
<span class="ltx_text" id="S4.T6.3.3.1.1" style="font-size:80%;">Faster RCNN-O</span><sup class="ltx_sup" id="S4.T6.3.3.1.2"><span class="ltx_text" id="S4.T6.3.3.1.2.1" style="font-size:80%;">∗</span></sup><span class="ltx_text" id="S4.T6.3.3.1.3" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T6.3.3.1.4.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib73" title=""><span class="ltx_text" style="font-size:90%;">73</span></a><span class="ltx_text" id="S4.T6.3.3.1.5.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.3.2"><span class="ltx_text" id="S4.T6.3.3.2.1" style="font-size:80%;">ResNet-50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.3.3"><span class="ltx_text" id="S4.T6.3.3.3.1" style="font-size:80%;">83.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.3.4"><span class="ltx_text" id="S4.T6.3.3.4.1" style="font-size:80%;">78.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T6.3.5.1">
<span class="ltx_text" id="S4.T6.3.5.1.1" style="font-size:80%;">RetinaNet-O </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T6.3.5.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib74" title=""><span class="ltx_text" style="font-size:90%;">74</span></a><span class="ltx_text" id="S4.T6.3.5.1.3.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.5.2"><span class="ltx_text" id="S4.T6.3.5.2.1" style="font-size:80%;">ResNet-50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.5.3"><span class="ltx_text" id="S4.T6.3.5.3.1" style="font-size:80%;">80.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.5.4"><span class="ltx_text" id="S4.T6.3.5.4.1" style="font-size:80%;">72.3</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T6.3.6.1">
<span class="ltx_text" id="S4.T6.3.6.1.1" style="font-size:80%;">Oriented R-CNN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T6.3.6.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib75" title=""><span class="ltx_text" style="font-size:90%;">75</span></a><span class="ltx_text" id="S4.T6.3.6.1.3.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.6.2"><span class="ltx_text" id="S4.T6.3.6.2.1" style="font-size:80%;">ResNet-50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.6.3"><span class="ltx_text" id="S4.T6.3.6.3.1" style="font-size:80%;">85.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.6.4"><span class="ltx_text" id="S4.T6.3.6.4.1" style="font-size:80%;">79.9</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.7">
<td class="ltx_td ltx_align_left ltx_border_t" colspan="4" id="S4.T6.3.7.1"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S4.T6.3.7.1.1" style="font-size:80%;">HBB-supervised</em></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.8">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T6.3.8.1">
<span class="ltx_text" id="S4.T6.3.8.1.1" style="font-size:80%;">H2RBox </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T6.3.8.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib76" title=""><span class="ltx_text" style="font-size:90%;">76</span></a><span class="ltx_text" id="S4.T6.3.8.1.3.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.3.8.2"><span class="ltx_text" id="S4.T6.3.8.2.1" style="font-size:80%;">ResNet-50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.3.8.3"><span class="ltx_text" id="S4.T6.3.8.3.1" style="font-size:80%;">47.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.8.4"><span class="ltx_text" id="S4.T6.3.8.4.1" style="font-size:80%;">24.3</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T6.3.9.1">
<span class="ltx_text" id="S4.T6.3.9.1.1" style="font-size:80%;">H2RBox-v2 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T6.3.9.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib77" title=""><span class="ltx_text" style="font-size:90%;">77</span></a><span class="ltx_text" id="S4.T6.3.9.1.3.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.9.2"><span class="ltx_text" id="S4.T6.3.9.2.1" style="font-size:80%;">ResNet-50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.9.3"><span class="ltx_text" id="S4.T6.3.9.3.1" style="font-size:80%;">81.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.9.4"><span class="ltx_text" id="S4.T6.3.9.4.1" style="font-size:80%;">76.5</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T6.3.10.1"><cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Yue et al.</span> <span class="ltx_text" id="S4.T6.3.10.1.1.1.1.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib71" title=""><span class="ltx_text" style="font-size:90%;">71</span></a><span class="ltx_text" id="S4.T6.3.10.1.2.2.2.1" style="font-size:80%;">]</span></cite></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.10.2"><span class="ltx_text" id="S4.T6.3.10.2.1" style="font-size:80%;">ResNet-50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.10.3"><span class="ltx_text" id="S4.T6.3.10.3.1" style="font-size:80%;">85.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.10.4"><span class="ltx_text" id="S4.T6.3.10.4.1" style="font-size:80%;">81.5</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.11">
<td class="ltx_td ltx_align_left ltx_border_t" colspan="4" id="S4.T6.3.11.1"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S4.T6.3.11.1.1" style="font-size:80%;">Pointly-supervised</em></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.12">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T6.3.12.1">
<span class="ltx_text" id="S4.T6.3.12.1.1" style="font-size:80%;">Point2RBox </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T6.3.12.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.13401v1#bib.bib38" title=""><span class="ltx_text" style="font-size:90%;">38</span></a><span class="ltx_text" id="S4.T6.3.12.1.3.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.3.12.2"><span class="ltx_text" id="S4.T6.3.12.2.1" style="font-size:80%;">ResNet-50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.3.12.3"><span class="ltx_text" id="S4.T6.3.12.3.1" style="font-size:80%;">64.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.12.4"><span class="ltx_text" id="S4.T6.3.12.4.1" style="font-size:80%;">57.1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.13">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T6.3.13.1"><span class="ltx_text" id="S4.T6.3.13.1.1" style="font-size:80%;">SAM + H2RBox-v2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.13.2"><span class="ltx_text" id="S4.T6.3.13.2.1" style="font-size:80%;">ResNet-50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.13.3"><span class="ltx_text" id="S4.T6.3.13.3.1" style="font-size:80%;">56.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.13.4"><span class="ltx_text" id="S4.T6.3.13.4.1" style="font-size:80%;">44.7</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.14" style="background-color:#E6E6E6;">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T6.3.14.1"><span class="ltx_text" id="S4.T6.3.14.1.1" style="font-size:80%;background-color:#E6E6E6;">PointSAM + H2RBox-v2 (Ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T6.3.14.2"><span class="ltx_text" id="S4.T6.3.14.2.1" style="font-size:80%;background-color:#E6E6E6;">ResNet-50</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T6.3.14.3"><span class="ltx_text" id="S4.T6.3.14.3.1" style="font-size:80%;background-color:#E6E6E6;">68.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.3.14.4"><span class="ltx_text" id="S4.T6.3.14.4.1" style="font-size:80%;background-color:#E6E6E6;">59.5</span></td>
</tr>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Conclusion</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we propose PointSAM, which adapts vanilla SAM to remote-sensing images using only point labels. Our method is based on a self-training framework. The proposed prototype-based regularization overcomes the issue of error accumulation in self-training by aligning prototypes predicted by the source and target models using the Hungarian matching algorithm. Negative prompt calibration effectively addresses the problem of densely distributed objects in RSIs by leveraging the spatial adjacency relationships of instances. Our method outperforms comparison algorithms on three widely used RSI datasets, NWPU VHR-10, HRSID, and WHU, and approaches the performance of supervised methods. Additionally, we also utilize the proposed PointSAM as a point-to-box generator to train a rotated box detector, achieving promising results. However, our method still has some issues to be improved. On the one hand, the self-training-based approach uses a dual-branch structure, which can result in slower training speeds. On the other hand, negative prompt calibration does not work well for objects with sparse distributions. Therefore, further consideration could be given to integrating information between images to effectively distinguish between foreground and background.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib1.5.5.1" style="font-size:90%;">Devlin et al. [2018]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.7.1" style="font-size:90%;">
J. Devlin, M.-W. Chang, K. Lee, and K. Toutanova, “Bert: Pre-training of deep bidirectional transformers for language understanding,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib1.8.2" style="font-size:90%;">arXiv preprint arXiv:1810.04805</em><span class="ltx_text" id="bib.bib1.9.3" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib2.5.5.1" style="font-size:90%;">Brown et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.7.1" style="font-size:90%;">
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal, A. Neelakantan, P. Shyam, G. Sastry, A. Askell </span><em class="ltx_emph ltx_font_italic" id="bib.bib2.8.2" style="font-size:90%;">et al.</em><span class="ltx_text" id="bib.bib2.9.3" style="font-size:90%;">, “Language models are few-shot learners,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib2.10.4" style="font-size:90%;">Advances in neural information processing systems</em><span class="ltx_text" id="bib.bib2.11.5" style="font-size:90%;">, vol. 33, pp. 1877–1901, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib3.5.5.1" style="font-size:90%;">Radford et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.7.1" style="font-size:90%;">
A. Radford, J. W. Kim, C. Hallacy, A. Ramesh, G. Goh, S. Agarwal, G. Sastry, A. Askell, P. Mishkin, J. Clark </span><em class="ltx_emph ltx_font_italic" id="bib.bib3.8.2" style="font-size:90%;">et al.</em><span class="ltx_text" id="bib.bib3.9.3" style="font-size:90%;">, “Learning transferable visual models from natural language supervision,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib3.10.4" style="font-size:90%;">International conference on machine learning</em><span class="ltx_text" id="bib.bib3.11.5" style="font-size:90%;">.   PMLR, 2021, pp. 8748–8763.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib4.5.5.1" style="font-size:90%;">Jia et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.7.1" style="font-size:90%;">
C. Jia, Y. Yang, Y. Xia, Y.-T. Chen, Z. Parekh, H. Pham, Q. Le, Y.-H. Sung, Z. Li, and T. Duerig, “Scaling up visual and vision-language representation learning with noisy text supervision,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib4.8.2" style="font-size:90%;">International conference on machine learning</em><span class="ltx_text" id="bib.bib4.9.3" style="font-size:90%;">.   PMLR, 2021, pp. 4904–4916.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib5.5.5.1" style="font-size:90%;">Kirillov et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.7.1" style="font-size:90%;">
A. Kirillov, E. Mintun, N. Ravi, H. Mao, C. Rolland, L. Gustafson, T. Xiao, S. Whitehead, A. C. Berg, W.-Y. Lo </span><em class="ltx_emph ltx_font_italic" id="bib.bib5.8.2" style="font-size:90%;">et al.</em><span class="ltx_text" id="bib.bib5.9.3" style="font-size:90%;">, “Segment anything,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib5.10.4" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</em><span class="ltx_text" id="bib.bib5.11.5" style="font-size:90%;">, 2023, pp. 4015–4026.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib6.5.5.1" style="font-size:90%;">Ravi et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.7.1" style="font-size:90%;">
N. Ravi, V. Gabeur, Y.-T. Hu, R. Hu, C. Ryali, T. Ma, H. Khedr, R. Rädle, C. Rolland, L. Gustafson, E. Mintun, J. Pan, K. V. Alwala, N. Carion, C.-Y. Wu, R. Girshick, P. Dollár, and C. Feichtenhofer, “Sam 2: Segment anything in images and videos,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib6.8.2" style="font-size:90%;">arXiv preprint arXiv:2408.00714</em><span class="ltx_text" id="bib.bib6.9.3" style="font-size:90%;">, 2024. [Online]. Available: </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2408.00714" style="font-size:90%;" title="">https://arxiv.org/abs/2408.00714</a><span class="ltx_text" id="bib.bib6.10.4" style="font-size:90%;">
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib7.5.5.1" style="font-size:90%;">Ma et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.7.1" style="font-size:90%;">
J. Ma, Y. He, F. Li, L. Han, C. You, and B. Wang, “Segment anything in medical images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib7.8.2" style="font-size:90%;">Nature Communications</em><span class="ltx_text" id="bib.bib7.9.3" style="font-size:90%;">, vol. 15, no. 1, p. 654, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib8.5.5.1" style="font-size:90%;">Huang et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.7.1" style="font-size:90%;">
Y. Huang, X. Yang, L. Liu, H. Zhou, A. Chang, X. Zhou, R. Chen, J. Yu, J. Chen, C. Chen </span><em class="ltx_emph ltx_font_italic" id="bib.bib8.8.2" style="font-size:90%;">et al.</em><span class="ltx_text" id="bib.bib8.9.3" style="font-size:90%;">, “Segment anything model for medical images?” </span><em class="ltx_emph ltx_font_italic" id="bib.bib8.10.4" style="font-size:90%;">Medical Image Analysis</em><span class="ltx_text" id="bib.bib8.11.5" style="font-size:90%;">, vol. 92, p. 103061, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib9.4.4.1" style="font-size:90%;">Shan and Zhang [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.6.1" style="font-size:90%;">
X. Shan and C. Zhang, “Robustness of segment anything model (sam) for autonomous driving in adverse weather conditions,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib9.7.2" style="font-size:90%;">arXiv preprint arXiv:2306.13290</em><span class="ltx_text" id="bib.bib9.8.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib10.5.5.1" style="font-size:90%;">Chen et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.7.1" style="font-size:90%;">
K. Chen, C. Liu, H. Chen, H. Zhang, W. Li, Z. Zou, and Z. Shi, “Rsprompter: Learning to prompt for remote sensing instance segmentation based on visual foundation model,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib10.8.2" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</em><span class="ltx_text" id="bib.bib10.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib11.5.5.1" style="font-size:90%;">Wang et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.7.1" style="font-size:90%;">
D. Wang, J. Zhang, B. Du, M. Xu, L. Liu, D. Tao, and L. Zhang, “Samrs: Scaling-up remote sensing segmentation dataset with segment anything model,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib11.8.2" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span class="ltx_text" id="bib.bib11.9.3" style="font-size:90%;">, vol. 36, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib12.5.5.1" style="font-size:90%;">Xue et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.7.1" style="font-size:90%;">
B. Xue, H. Cheng, Q. Yang, Y. Wang, and X. He, “Adapting segment anything model to aerial land cover classification with low-rank adaptation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib12.8.2" style="font-size:90%;">IEEE Geoscience and Remote Sensing Letters</em><span class="ltx_text" id="bib.bib12.9.3" style="font-size:90%;">, vol. 21, pp. 1–5, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib13.5.5.1" style="font-size:90%;">Ding et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.7.1" style="font-size:90%;">
L. Ding, K. Zhu, D. Peng, H. Tang, K. Yang, and L. Bruzzone, “Adapting segment anything model for change detection in vhr remote sensing images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib13.8.2" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</em><span class="ltx_text" id="bib.bib13.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib14.5.5.1" style="font-size:90%;">Yan et al. [2023a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.7.1" style="font-size:90%;">
Z. Yan, J. Li, X. Li, R. Zhou, W. Zhang, Y. Feng, W. Diao, K. Fu, and X. Sun, “Ringmo-sam: A foundation model for segment anything in multimodal remote-sensing images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib14.8.2" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</em><span class="ltx_text" id="bib.bib14.9.3" style="font-size:90%;">, vol. 61, pp. 1–16, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib15.5.5.1" style="font-size:90%;">Pu et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.7.1" style="font-size:90%;">
X. Pu, H. Jia, L. Zheng, F. Wang, and F. Xu, “Classwise-sam-adapter: Parameter efficient fine-tuning adapts segment anything to sar domain for semantic segmentation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib15.8.2" style="font-size:90%;">arXiv preprint arXiv:2401.02326</em><span class="ltx_text" id="bib.bib15.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib16.5.5.1" style="font-size:90%;">Zhang et al. [2023a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.7.1" style="font-size:90%;">
H. Zhang, Y. Su, X. Xu, and K. Jia, “Improving the generalization of segmentation foundation model under distribution shift via weakly supervised adaptation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib16.8.2" style="font-size:90%;">arXiv preprint arXiv:2312.03502</em><span class="ltx_text" id="bib.bib16.9.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib17.5.5.1" style="font-size:90%;">Xiao et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.7.1" style="font-size:90%;">
A. Xiao, W. Xuan, H. Qi, Y. Xing, R. Ren, X. Zhang, and S. Lu, “Cat-sam: Conditional tuning network for few-shot adaptation of segmentation anything model,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib17.8.2" style="font-size:90%;">arXiv preprint arXiv:2402.03631</em><span class="ltx_text" id="bib.bib17.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib18.5.5.1" style="font-size:90%;">Tang et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.7.1" style="font-size:90%;">
L. Tang, Y. Yuan, C. Chen, K. Huang, X. Ding, and Y. Huang, “Bootstrap segmentation foundation model under distribution shift via object-centric learning,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib18.8.2" style="font-size:90%;">arXiv preprint arXiv:2408.16310</em><span class="ltx_text" id="bib.bib18.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib19.5.5.1" style="font-size:90%;">Xu et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.7.1" style="font-size:90%;">
M. Xu, Z. Zhang, H. Hu, J. Wang, L. Wang, F. Wei, X. Bai, and Z. Liu, “End-to-end semi-supervised object detection with soft teacher,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib19.8.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</em><span class="ltx_text" id="bib.bib19.9.3" style="font-size:90%;">, 2021, pp. 3060–3069.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib20.5.5.1" style="font-size:90%;">VS et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.7.1" style="font-size:90%;">
V. VS, P. Oza, and V. M. Patel, “Instance relation graph guided source-free domain adaptive object detection,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib20.8.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span class="ltx_text" id="bib.bib20.9.3" style="font-size:90%;">, 2023, pp. 3520–3530.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib21.5.5.1" style="font-size:90%;">Liu et al. [2024a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.7.1" style="font-size:90%;">
N. Liu, X. Xu, Y. Su, C. Liu, P. Gong, and H.-C. Li, “Clip-guided source-free object detection in aerial images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib21.8.2" style="font-size:90%;">arXiv preprint arXiv:2401.05168</em><span class="ltx_text" id="bib.bib21.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib22.5.5.1" style="font-size:90%;">Liang et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.7.1" style="font-size:90%;">
J. Liang, D. Hu, and J. Feng, “Do we really need to access the source data? source hypothesis transfer for unsupervised domain adaptation,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib22.8.2" style="font-size:90%;">Proc. Int. Conf. Mach. Learn.</em><span class="ltx_text" id="bib.bib22.9.3" style="font-size:90%;">   PMLR, 2020, pp. 6028–6039.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib23.5.5.1" style="font-size:90%;">Chen et al. [2023a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.7.1" style="font-size:90%;">
Y. Chen, X. Xu, Y. Su, and K. Jia, “Stfar: Improving object detection robustness at test-time by self-training with feature alignment regularization,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib23.8.2" style="font-size:90%;">arXiv preprint arXiv:2303.17937</em><span class="ltx_text" id="bib.bib23.9.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib24.5.5.1" style="font-size:90%;">Mirza et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.7.1" style="font-size:90%;">
M. J. Mirza, P. J. Soneira, W. Lin, M. Kozinski, H. Possegger, and H. Bischof, “Actmad: Activation matching to align distributions for test-time-training,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib24.8.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span class="ltx_text" id="bib.bib24.9.3" style="font-size:90%;">, 2023, pp. 24 152–24 161.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib25.5.5.1" style="font-size:90%;">Yoo et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.7.1" style="font-size:90%;">
J. Yoo, D. Lee, I. Chung, D. Kim, and N. Kwak, “What how and when should object detectors update in continually changing test domains?” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib25.8.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span class="ltx_text" id="bib.bib25.9.3" style="font-size:90%;">, 2024, pp. 23 354–23 363.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib26.5.5.1" style="font-size:90%;">Su et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.7.1" style="font-size:90%;">
Y. Su, X. Xu, and K. Jia, “Towards real-world test-time adaptation: Tri-net self-training with balanced normalization,” 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib27.5.5.1" style="font-size:90%;">Sarfraz et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.7.1" style="font-size:90%;">
M. S. Sarfraz, V. Sharma, and R. Stiefelhagen, “Efficient parameter-free clustering using first neighbor relations,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib27.8.2" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em><span class="ltx_text" id="bib.bib27.9.3" style="font-size:90%;">, 2019, pp. 8934–8943.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib28.5.5.1" style="font-size:90%;">Zhang et al. [2023b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.7.1" style="font-size:90%;">
C. Zhang, D. Han, Y. Qiao, J. U. Kim, S.-H. Bae, S. Lee, and C. S. Hong, “Faster segment anything: Towards lightweight sam for mobile applications,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib28.8.2" style="font-size:90%;">arXiv preprint arXiv:2306.14289</em><span class="ltx_text" id="bib.bib28.9.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib29.5.5.1" style="font-size:90%;">Xiong et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.7.1" style="font-size:90%;">
Y. Xiong, B. Varadarajan, L. Wu, X. Xiang, F. Xiao, C. Zhu, X. Dai, D. Wang, F. Sun, F. Iandola </span><em class="ltx_emph ltx_font_italic" id="bib.bib29.8.2" style="font-size:90%;">et al.</em><span class="ltx_text" id="bib.bib29.9.3" style="font-size:90%;">, “Efficientsam: Leveraged masked image pretraining for efficient segment anything,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib29.10.4" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span class="ltx_text" id="bib.bib29.11.5" style="font-size:90%;">, 2024, pp. 16 111–16 121.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib30.5.5.1" style="font-size:90%;">Ke et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.7.1" style="font-size:90%;">
L. Ke, M. Ye, M. Danelljan, Y. Liu, Y.-W. Tai, C.-K. Tang, and F. Yu, “Segment anything in high quality,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib30.8.2" style="font-size:90%;">NeurIPS</em><span class="ltx_text" id="bib.bib30.9.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib31.5.5.1" style="font-size:90%;">Yuan et al. [2024a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.7.1" style="font-size:90%;">
H. Yuan, X. Li, C. Zhou, Y. Li, K. Chen, and C. C. Loy, “Open-vocabulary sam: Segment and recognize twenty-thousand classes interactively,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib31.8.2" style="font-size:90%;">arXiv preprint arXiv:2401.02955</em><span class="ltx_text" id="bib.bib31.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib32.5.5.1" style="font-size:90%;">Ren et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.7.1" style="font-size:90%;">
T. Ren, S. Liu, A. Zeng, J. Lin, K. Li, H. Cao, J. Chen, X. Huang, Y. Chen, F. Yan, Z. Zeng, H. Zhang, F. Li, J. Yang, H. Li, Q. Jiang, and L. Zhang, “Grounded sam: Assembling open-world models for diverse visual tasks,” 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib33.5.5.1" style="font-size:90%;">Osco et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.7.1" style="font-size:90%;">
L. P. Osco, Q. Wu, E. L. de Lemos, W. N. Gonçalves, A. P. M. Ramos, J. Li, and J. M. Junior, “The segment anything model (sam) for remote sensing applications: From zero to one shot,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib33.8.2" style="font-size:90%;">International Journal of Applied Earth Observation and Geoinformation</em><span class="ltx_text" id="bib.bib33.9.3" style="font-size:90%;">, vol. 124, p. 103540, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib34.5.5.1" style="font-size:90%;">Yan et al. [2023b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.7.1" style="font-size:90%;">
Z. Yan, J. Li, X. Li, R. Zhou, W. Zhang, Y. Feng, W. Diao, K. Fu, and X. Sun, “Ringmo-sam: A foundation model for segment anything in multimodal remote-sensing images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib34.8.2" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</em><span class="ltx_text" id="bib.bib34.9.3" style="font-size:90%;">, vol. 61, pp. 1–16, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib35.5.5.1" style="font-size:90%;">Moghimi et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.7.1" style="font-size:90%;">
A. Moghimi, M. Welzel, T. Celik, and T. Schlurmann, “A comparative performance analysis of popular deep learning models and segment anything model (sam) for river water segmentation in close-range remote sensing imagery,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib35.8.2" style="font-size:90%;">IEEE Access</em><span class="ltx_text" id="bib.bib35.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib36.5.5.1" style="font-size:90%;">Hu et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.7.1" style="font-size:90%;">
E. J. Hu, Y. Shen, P. Wallis, Z. Allen-Zhu, Y. Li, S. Wang, L. Wang, and W. Chen, “Lora: Low-rank adaptation of large language models,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib36.8.2" style="font-size:90%;">arXiv preprint arXiv:2106.09685</em><span class="ltx_text" id="bib.bib36.9.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib37.5.5.1" style="font-size:90%;">Chen et al. [2023b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.7.1" style="font-size:90%;">
K. Chen, C. Liu, W. Li, Z. Liu, H. Chen, H. Zhang, Z. Zou, and Z. Shi, “Time travelling pixels: Bitemporal features integration with foundation model for remote sensing image change detection,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib37.8.2" style="font-size:90%;">arXiv preprint arXiv:2312.16202</em><span class="ltx_text" id="bib.bib37.9.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib38.5.5.1" style="font-size:90%;">Yu et al. [2024a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.7.1" style="font-size:90%;">
Y. Yu, X. Yang, Q. Li, F. Da, J. Dai, Y. Qiao, and J. Yan, “Point2rbox: Combine knowledge from synthetic visual patterns for end-to-end oriented object detection with single point supervision,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib38.8.2" style="font-size:90%;">IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span class="ltx_text" id="bib.bib38.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib39.5.5.1" style="font-size:90%;">Chen et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.7.1" style="font-size:90%;">
P. Chen, X. Yu, X. Han, N. Hassan, K. Wang, J. Li, J. Zhao, H. Shi, Z. Han, and Q. Ye, “Point-to-box network for accurate object detection via single point supervision,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib39.8.2" style="font-size:90%;">European Conference on Computer Vision</em><span class="ltx_text" id="bib.bib39.9.3" style="font-size:90%;">.   Springer, 2022, pp. 51–67.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib40.5.5.1" style="font-size:90%;">Luo et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.7.1" style="font-size:90%;">
J. Luo, X. Yang, Y. Yu, Q. Li, J. Yan, and Y. Li, “Pointobb: Learning oriented object detection via single point supervision,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib40.8.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span class="ltx_text" id="bib.bib40.9.3" style="font-size:90%;">, 2024, pp. 16 730–16 740.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib41.5.5.1" style="font-size:90%;">Zhang et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.7.1" style="font-size:90%;">
S. Zhang, J. Long, Y. Xu, and S. Mei, “Pmho: Point-supervised oriented object detection based on segmentation-driven proposal generation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib41.8.2" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</em><span class="ltx_text" id="bib.bib41.9.3" style="font-size:90%;">, pp. 1–1, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib42.5.5.1" style="font-size:90%;">Cao et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.7.1" style="font-size:90%;">
G. Cao, X. Yu, W. Yu, X. Han, X. Yang, G. Li, J. Jiao, and Z. Han, “P2rbox: A single point is all you need for oriented object detection,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib42.8.2" style="font-size:90%;">arXiv preprint arXiv:2311.13128</em><span class="ltx_text" id="bib.bib42.9.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib43.5.5.1" style="font-size:90%;">Fan et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.7.1" style="font-size:90%;">
J. Fan, Z. Zhang, and T. Tan, “Pointly-supervised panoptic segmentation,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib43.8.2" style="font-size:90%;">European Conference on Computer Vision</em><span class="ltx_text" id="bib.bib43.9.3" style="font-size:90%;">.   Springer, 2022, pp. 319–336.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib44.5.5.1" style="font-size:90%;">Li et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.7.1" style="font-size:90%;">
W. Li, Y. Yuan, S. Wang, J. Zhu, J. Li, J. Liu, and L. Zhang, “Point2mask: Point-supervised panoptic segmentation via optimal transport,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib44.8.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</em><span class="ltx_text" id="bib.bib44.9.3" style="font-size:90%;">, 2023, pp. 572–581.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib45.5.5.1" style="font-size:90%;">Bearman et al. [2016]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.7.1" style="font-size:90%;">
A. Bearman, O. Russakovsky, V. Ferrari, and L. Fei-Fei, “What’s the point: Semantic segmentation with point supervision,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib45.8.2" style="font-size:90%;">European conference on computer vision</em><span class="ltx_text" id="bib.bib45.9.3" style="font-size:90%;">.   Springer, 2016, pp. 549–565.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib46.5.5.1" style="font-size:90%;">Cheng et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.7.1" style="font-size:90%;">
B. Cheng, O. Parkhi, and A. Kirillov, “Pointly-supervised instance segmentation,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib46.8.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span class="ltx_text" id="bib.bib46.9.3" style="font-size:90%;">, 2022, pp. 2617–2626.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib47.5.5.1" style="font-size:90%;">Yuan et al. [2024b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.7.1" style="font-size:90%;">
S. Yuan, H. Qin, R. Kou, X. Yan, Z. Li, C. Peng, and A.-K. Seghouane, “Beyond full label: Single-point prompt for infrared small target label generation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib47.8.2" style="font-size:90%;">arXiv preprint arXiv:2408.08191</em><span class="ltx_text" id="bib.bib47.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib48.5.5.1" style="font-size:90%;">Liu et al. [2021a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.7.1" style="font-size:90%;">
Y.-C. Liu, C.-Y. Ma, Z. He, C.-W. Kuo, K. Chen, P. Zhang, B. Wu, Z. Kira, and P. Vajda, “Unbiased teacher for semi-supervised object detection,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib48.8.2" style="font-size:90%;">Proc. Int. Conf. Learn. Represent.</em><span class="ltx_text" id="bib.bib48.9.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib49.5.5.1" style="font-size:90%;">Liu et al. [2024b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.7.1" style="font-size:90%;">
N. Liu, X. Xu, Y. Gao, Y. Zhao, and H.-C. Li, “Semi-supervised object detection with uncurated unlabeled data for remote sensing images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib49.8.2" style="font-size:90%;">International Journal of Applied Earth Observation and Geoinformation</em><span class="ltx_text" id="bib.bib49.9.3" style="font-size:90%;">, vol. 129, p. 103814, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib50.5.5.1" style="font-size:90%;">Su et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.7.1" style="font-size:90%;">
Y. Su, X. Xu, T. Li, and K. Jia, “Revisiting realistic test-time training: Sequential inference and adaptation by anchored clustering regularized self-training,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib50.8.2" style="font-size:90%;">IEEE Transactions on Pattern Analysis and Machine Intelligence</em><span class="ltx_text" id="bib.bib50.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib51.5.5.1" style="font-size:90%;">Liu et al. [2024c]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.7.1" style="font-size:90%;">
N. Liu, X. Xu, Y. Su, C. Liu, P. Gong, and H.-C. Li, “Clip-guided source-free object detection in aerial images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib51.8.2" style="font-size:90%;">arXiv preprint arXiv:2401.05168</em><span class="ltx_text" id="bib.bib51.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib52.5.5.1" style="font-size:90%;">Arazo et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.7.1" style="font-size:90%;">
E. Arazo, D. Ortego, P. Albert, N. E. O’Connor, and K. McGuinness, “Pseudo-labeling and confirmation bias in deep semi-supervised learning,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib52.8.2" style="font-size:90%;">2020 International joint conference on neural networks (IJCNN)</em><span class="ltx_text" id="bib.bib52.9.3" style="font-size:90%;">.   IEEE, 2020, pp. 1–8.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib53.5.5.1" style="font-size:90%;">Zhao et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.7.1" style="font-size:90%;">
Y. Zhao, T. Celik, N. Liu, and H.-C. Li, “A comparative analysis of gan-based methods for sar-to-optical image translation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib53.8.2" style="font-size:90%;">IEEE Geoscience and Remote Sensing Letters</em><span class="ltx_text" id="bib.bib53.9.3" style="font-size:90%;">, vol. 19, pp. 1–5, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib54.5.5.1" style="font-size:90%;">Zhao et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.7.1" style="font-size:90%;">
Y. Zhao, T. Celik, N. Liu, F. Gao, and H.-C. Li, “Sslchange: A self-supervised change detection framework based on domain adaptation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib54.8.2" style="font-size:90%;">arXiv preprint arXiv:2405.18224</em><span class="ltx_text" id="bib.bib54.9.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib55.5.5.1" style="font-size:90%;">Li et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.7.1" style="font-size:90%;">
Y.-C. Li, S. Lei, N. Liu, H.-C. Li, and Q. Du, “Ida-siamnet: Interactive- and dynamic-aware siamese network for building change detection,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib55.8.2" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</em><span class="ltx_text" id="bib.bib55.9.3" style="font-size:90%;">, vol. 62, pp. 1–13, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib56.5.5.1" style="font-size:90%;">Guo et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.7.1" style="font-size:90%;">
P. Guo, T. Celik, N. Liu, and H.-C. Li, “Break through the border restriction of horizontal bounding box for arbitrary-oriented ship detection in sar images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib56.8.2" style="font-size:90%;">IEEE Geoscience and Remote Sensing Letters</em><span class="ltx_text" id="bib.bib56.9.3" style="font-size:90%;">, vol. 20, pp. 1–5, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib57.5.5.1" style="font-size:90%;">Zhang et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.7.1" style="font-size:90%;">
G. Zhang, S. Lu, and W. Zhang, “Cad-net: A context-aware detection network for objects in remote sensing imagery,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib57.8.2" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</em><span class="ltx_text" id="bib.bib57.9.3" style="font-size:90%;">, vol. 57, no. 12, pp. 10 015–10 024, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib58.5.5.1" style="font-size:90%;">Gao et al. [2022a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.7.1" style="font-size:90%;">
G. Gao, Q. Liu, Z. Hu, L. Li, Q. Wen, and Y. Wang, “Psgcnet: A pyramidal scale and global context guided network for dense object counting in remote-sensing images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib58.8.2" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</em><span class="ltx_text" id="bib.bib58.9.3" style="font-size:90%;">, vol. 60, pp. 1–12, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib59.5.5.1" style="font-size:90%;">Liu et al. [2021b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.7.1" style="font-size:90%;">
N. Liu, T. Celik, T. Zhao, C. Zhang, and H.-C. Li, “Afdet: Toward more accurate and faster object detection in remote sensing images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib59.8.2" style="font-size:90%;">IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing</em><span class="ltx_text" id="bib.bib59.9.3" style="font-size:90%;">, vol. 14, pp. 12 557–12 568, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib60.4.4.1" style="font-size:90%;">Yang and Yan [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.6.1" style="font-size:90%;">
X. Yang and J. Yan, “Arbitrary-oriented object detection with circular smooth label,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib60.7.2" style="font-size:90%;">Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part VIII 16</em><span class="ltx_text" id="bib.bib60.8.3" style="font-size:90%;">.   Springer, 2020, pp. 677–694.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib61.5.5.1" style="font-size:90%;">Fu et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib61.7.1" style="font-size:90%;">
B. Fu, W. Li, Y. Sun, G. Chen, L. Zhang, and W. Wei, “Correlated nms: Establishing correlations between dense predictions of remote sensing images,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib61.8.2" style="font-size:90%;">IGARSS 2023 - 2023 IEEE International Geoscience and Remote Sensing Symposium</em><span class="ltx_text" id="bib.bib61.9.3" style="font-size:90%;">, 2023, pp. 6153–6156.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib62.5.5.1" style="font-size:90%;">Guo et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib62.7.1" style="font-size:90%;">
W. Guo, W. Li, W. Gong, and C. Chen, “Region-attentioned network with location scoring dynamic-threshold nms for object detection in remote sensing images,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib62.8.2" style="font-size:90%;">Proceedings of the 2020 4th International Conference on Vision, Image and Signal Processing</em><span class="ltx_text" id="bib.bib62.9.3" style="font-size:90%;">, ser. ICVISP 2020.   New York, NY, USA: Association for Computing Machinery, 2021. [Online]. Available: </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3448823.3448824" style="font-size:90%;" title="">https://doi.org/10.1145/3448823.3448824</a><span class="ltx_text" id="bib.bib62.10.4" style="font-size:90%;">
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib63.4.4.1" style="font-size:90%;">Dosovitskiy [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.6.1" style="font-size:90%;">
A. Dosovitskiy, “An image is worth 16x16 words: Transformers for image recognition at scale,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib63.7.2" style="font-size:90%;">arXiv preprint arXiv:2010.11929</em><span class="ltx_text" id="bib.bib63.8.3" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib64.5.5.1" style="font-size:90%;">Carion et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib64.7.1" style="font-size:90%;">
N. Carion, F. Massa, G. Synnaeve, N. Usunier, A. Kirillov, and S. Zagoruyko, “End-to-end object detection with transformers,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib64.8.2" style="font-size:90%;">European conference on computer vision</em><span class="ltx_text" id="bib.bib64.9.3" style="font-size:90%;">.   Springer, 2020, pp. 213–229.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib65.5.5.1" style="font-size:90%;">Stewart et al. [2016]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib65.7.1" style="font-size:90%;">
R. Stewart, M. Andriluka, and A. Y. Ng, “End-to-end people detection in crowded scenes,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib65.8.2" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em><span class="ltx_text" id="bib.bib65.9.3" style="font-size:90%;">, June 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib66.5.5.1" style="font-size:90%;">Wei et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib66.7.1" style="font-size:90%;">
S. Wei, X. Zeng, Q. Qu, M. Wang, H. Su, and J. Shi, “Hrsid: A high-resolution sar images dataset for ship detection and instance segmentation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib66.8.2" style="font-size:90%;">Ieee Access</em><span class="ltx_text" id="bib.bib66.9.3" style="font-size:90%;">, vol. 8, pp. 120 234–120 254, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib67.5.5.1" style="font-size:90%;">Cheng et al. [2016]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.7.1" style="font-size:90%;">
G. Cheng, P. Zhou, and J. Han, “Learning rotation-invariant convolutional neural networks for object detection in vhr optical remote sensing images,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib67.8.2" style="font-size:90%;">IEEE transactions on geoscience and remote sensing</em><span class="ltx_text" id="bib.bib67.9.3" style="font-size:90%;">, vol. 54, no. 12, pp. 7405–7415, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib68.5.5.1" style="font-size:90%;">Ji et al. [2018]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib68.7.1" style="font-size:90%;">
S. Ji, S. Wei, and M. Lu, “Fully convolutional networks for multisource building extraction from an open aerial and satellite imagery data set,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib68.8.2" style="font-size:90%;">IEEE Transactions on geoscience and remote sensing</em><span class="ltx_text" id="bib.bib68.9.3" style="font-size:90%;">, vol. 57, no. 1, pp. 574–586, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib69.5.5.1" style="font-size:90%;">Wang et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib69.7.1" style="font-size:90%;">
D. Wang, E. Shelhamer, S. Liu, B. Olshausen, and T. Darrell, “Tent: Fully test-time adaptation by entropy minimization,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib69.8.2" style="font-size:90%;">Proc. Int. Conf. Learn. Represent.</em><span class="ltx_text" id="bib.bib69.9.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib70.5.5.1" style="font-size:90%;">Gao et al. [2022b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.7.1" style="font-size:90%;">
Y. Gao, X. Shi, Y. Zhu, H. Wang, Z. Tang, X. Zhou, M. Li, and D. N. Metaxas, “Visual prompt tuning for test-time domain adaptation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib70.8.2" style="font-size:90%;">arXiv preprint arXiv:2210.04831</em><span class="ltx_text" id="bib.bib70.9.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib71.5.5.1" style="font-size:90%;">Yue et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib71.7.1" style="font-size:90%;">
T. Yue, Y. Zhang, J. Wang, Y. Xu, and P. Liu, “A weak supervision learning paradigm for oriented ship detection in sar image,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib71.8.2" style="font-size:90%;">IEEE Transactions on Geoscience and Remote Sensing</em><span class="ltx_text" id="bib.bib71.9.3" style="font-size:90%;">, vol. 62, pp. 1–12, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib72.5.5.1" style="font-size:90%;">Tian et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib72.7.1" style="font-size:90%;">
Z. Tian, C. Shen, H. Chen, and T. He, “Fcos: Fully convolutional one-stage object detection,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib72.8.2" style="font-size:90%;">2019 IEEE/CVF International Conference on Computer Vision (ICCV)</em><span class="ltx_text" id="bib.bib72.9.3" style="font-size:90%;">, 2019, pp. 9626–9635.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib73.5.5.1" style="font-size:90%;">Ren et al. [2015]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib73.7.1" style="font-size:90%;">
S. Ren, K. He, R. Girshick, and J. Sun, “Faster R-CNN: Towards real-time object detection with region proposal networks,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib73.8.2" style="font-size:90%;">Advances in Neural Information Processing Systems (NIPS)</em><span class="ltx_text" id="bib.bib73.9.3" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib74.5.5.1" style="font-size:90%;">Yang et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib74.7.1" style="font-size:90%;">
X. Yang, X. Yang, J. Yang, Q. Ming, W. Wang, Q. Tian, and J. Yan, “Learning high-precision bounding box for rotated object detection via kullback-leibler divergence,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib74.8.2" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span class="ltx_text" id="bib.bib74.9.3" style="font-size:90%;">, vol. 34, pp. 18 381–18 394, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib75.5.5.1" style="font-size:90%;">Xie et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib75.7.1" style="font-size:90%;">
X. Xie, G. Cheng, J. Wang, K. Li, X. Yao, and J. Han, “Oriented r-cnn and beyond,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib75.8.2" style="font-size:90%;">International Journal of Computer Vision</em><span class="ltx_text" id="bib.bib75.9.3" style="font-size:90%;">, pp. 1–23, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib76.5.5.1" style="font-size:90%;">Yang et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib76.7.1" style="font-size:90%;">
X. Yang, G. Zhang, W. Li, X. Wang, Y. Zhou, and J. Yan, “H2rbox: Horizontal box annotation is all you need for oriented object detection,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib76.8.2" style="font-size:90%;">arXiv preprint arXiv:2210.06742</em><span class="ltx_text" id="bib.bib76.9.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib77.5.5.1" style="font-size:90%;">Yu et al. [2024b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib77.7.1" style="font-size:90%;">
Y. Yu, X. Yang, Q. Li, Y. Zhou, F. Da, and J. Yan, “H2rbox-v2: Incorporating symmetry for boosting horizontal box supervised oriented object detection,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib77.8.2" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span class="ltx_text" id="bib.bib77.9.3" style="font-size:90%;">, vol. 36, 2024.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Sep 20 11:04:21 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
